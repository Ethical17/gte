$PBExportHeader$w_csvexport.srw
forward
global type w_csvexport from window
end type
type rb_117 from radiobutton within w_csvexport
end type
type dw_2 from datawindow within w_csvexport
end type
type rb_116 from radiobutton within w_csvexport
end type
type rb_115 from radiobutton within w_csvexport
end type
type rb_114 from radiobutton within w_csvexport
end type
type rb_113 from radiobutton within w_csvexport
end type
type rb_112 from radiobutton within w_csvexport
end type
type rb_111 from radiobutton within w_csvexport
end type
type rb_110 from radiobutton within w_csvexport
end type
type rb_109 from radiobutton within w_csvexport
end type
type rb_108 from radiobutton within w_csvexport
end type
type rb_107 from radiobutton within w_csvexport
end type
type rb_106 from radiobutton within w_csvexport
end type
type rb_105 from radiobutton within w_csvexport
end type
type rb_80 from radiobutton within w_csvexport
end type
type rb_70 from radiobutton within w_csvexport
end type
type rb_46 from radiobutton within w_csvexport
end type
type rb_33 from radiobutton within w_csvexport
end type
type rb_45 from radiobutton within w_csvexport
end type
type cb_4 from commandbutton within w_csvexport
end type
type rb_104 from radiobutton within w_csvexport
end type
type cb_1 from commandbutton within w_csvexport
end type
type rb_103 from radiobutton within w_csvexport
end type
type rb_102 from radiobutton within w_csvexport
end type
type rb_101 from radiobutton within w_csvexport
end type
type rb_100 from radiobutton within w_csvexport
end type
type rb_99 from radiobutton within w_csvexport
end type
type rb_98 from radiobutton within w_csvexport
end type
type rb_97 from radiobutton within w_csvexport
end type
type rb_96 from radiobutton within w_csvexport
end type
type rb_95 from radiobutton within w_csvexport
end type
type rb_94 from radiobutton within w_csvexport
end type
type rb_93 from radiobutton within w_csvexport
end type
type rb_92 from radiobutton within w_csvexport
end type
type rb_91 from radiobutton within w_csvexport
end type
type rb_90 from radiobutton within w_csvexport
end type
type rb_89 from radiobutton within w_csvexport
end type
type rb_88 from radiobutton within w_csvexport
end type
type rb_87 from radiobutton within w_csvexport
end type
type rb_86 from radiobutton within w_csvexport
end type
type rb_85 from radiobutton within w_csvexport
end type
type rb_84 from radiobutton within w_csvexport
end type
type rb_83 from radiobutton within w_csvexport
end type
type rb_82 from radiobutton within w_csvexport
end type
type rb_81 from radiobutton within w_csvexport
end type
type rb_79 from radiobutton within w_csvexport
end type
type rb_78 from radiobutton within w_csvexport
end type
type rb_77 from radiobutton within w_csvexport
end type
type rb_76 from radiobutton within w_csvexport
end type
type rb_75 from radiobutton within w_csvexport
end type
type rb_69 from radiobutton within w_csvexport
end type
type rb_68 from radiobutton within w_csvexport
end type
type rb_67 from radiobutton within w_csvexport
end type
type rb_42 from radiobutton within w_csvexport
end type
type rb_40 from radiobutton within w_csvexport
end type
type rb_38 from radiobutton within w_csvexport
end type
type rb_36 from radiobutton within w_csvexport
end type
type rb_34 from radiobutton within w_csvexport
end type
type rb_32 from radiobutton within w_csvexport
end type
type rb_31 from radiobutton within w_csvexport
end type
type rb_30 from radiobutton within w_csvexport
end type
type rb_21 from radiobutton within w_csvexport
end type
type rb_48 from radiobutton within w_csvexport
end type
type rb_53 from radiobutton within w_csvexport
end type
type rb_51 from radiobutton within w_csvexport
end type
type rb_52 from radiobutton within w_csvexport
end type
type rb_57 from radiobutton within w_csvexport
end type
type rb_29 from radiobutton within w_csvexport
end type
type rb_28 from radiobutton within w_csvexport
end type
type rb_27 from radiobutton within w_csvexport
end type
type rb_26 from radiobutton within w_csvexport
end type
type rb_20 from radiobutton within w_csvexport
end type
type rb_19 from radiobutton within w_csvexport
end type
type rb_16 from radiobutton within w_csvexport
end type
type rb_14 from radiobutton within w_csvexport
end type
type rb_11 from radiobutton within w_csvexport
end type
type rb_9 from radiobutton within w_csvexport
end type
type rb_7 from radiobutton within w_csvexport
end type
type rb_35 from radiobutton within w_csvexport
end type
type rb_37 from radiobutton within w_csvexport
end type
type rb_39 from radiobutton within w_csvexport
end type
type rb_41 from radiobutton within w_csvexport
end type
type rb_43 from radiobutton within w_csvexport
end type
type rb_25 from radiobutton within w_csvexport
end type
type rb_24 from radiobutton within w_csvexport
end type
type rb_23 from radiobutton within w_csvexport
end type
type rb_22 from radiobutton within w_csvexport
end type
type rb_8 from radiobutton within w_csvexport
end type
type rb_10 from radiobutton within w_csvexport
end type
type rb_12 from radiobutton within w_csvexport
end type
type rb_13 from radiobutton within w_csvexport
end type
type rb_15 from radiobutton within w_csvexport
end type
type rb_44 from radiobutton within w_csvexport
end type
type rb_17 from radiobutton within w_csvexport
end type
type rb_18 from radiobutton within w_csvexport
end type
type rb_47 from radiobutton within w_csvexport
end type
type rb_74 from radiobutton within w_csvexport
end type
type rb_73 from radiobutton within w_csvexport
end type
type rb_72 from radiobutton within w_csvexport
end type
type rb_71 from radiobutton within w_csvexport
end type
type rb_66 from radiobutton within w_csvexport
end type
type rb_65 from radiobutton within w_csvexport
end type
type rb_64 from radiobutton within w_csvexport
end type
type rb_63 from radiobutton within w_csvexport
end type
type rb_62 from radiobutton within w_csvexport
end type
type rb_61 from radiobutton within w_csvexport
end type
type rb_60 from radiobutton within w_csvexport
end type
type rb_59 from radiobutton within w_csvexport
end type
type rb_58 from radiobutton within w_csvexport
end type
type rb_50 from radiobutton within w_csvexport
end type
type rb_54 from radiobutton within w_csvexport
end type
type rb_55 from radiobutton within w_csvexport
end type
type rb_56 from radiobutton within w_csvexport
end type
type rb_49 from radiobutton within w_csvexport
end type
type dw_1 from datawindow within w_csvexport
end type
type rb_4 from radiobutton within w_csvexport
end type
type rb_1 from radiobutton within w_csvexport
end type
type rb_6 from radiobutton within w_csvexport
end type
type rb_5 from radiobutton within w_csvexport
end type
type rb_3 from radiobutton within w_csvexport
end type
type rb_2 from radiobutton within w_csvexport
end type
type gb_2 from groupbox within w_csvexport
end type
type gb_6 from groupbox within w_csvexport
end type
type gb_1 from groupbox within w_csvexport
end type
type gb_3 from groupbox within w_csvexport
end type
type gb_5 from groupbox within w_csvexport
end type
type gb_4 from groupbox within w_csvexport
end type
type gb_9 from groupbox within w_csvexport
end type
type gb_8 from groupbox within w_csvexport
end type
type gb_7 from groupbox within w_csvexport
end type
end forward

global type w_csvexport from window
integer width = 5152
integer height = 3024
boolean titlebar = true
string title = "Export Tables"
boolean controlmenu = true
boolean minbox = true
boolean maxbox = true
boolean resizable = true
windowstate windowstate = maximized!
long backcolor = 67108864
rb_117 rb_117
dw_2 dw_2
rb_116 rb_116
rb_115 rb_115
rb_114 rb_114
rb_113 rb_113
rb_112 rb_112
rb_111 rb_111
rb_110 rb_110
rb_109 rb_109
rb_108 rb_108
rb_107 rb_107
rb_106 rb_106
rb_105 rb_105
rb_80 rb_80
rb_70 rb_70
rb_46 rb_46
rb_33 rb_33
rb_45 rb_45
cb_4 cb_4
rb_104 rb_104
cb_1 cb_1
rb_103 rb_103
rb_102 rb_102
rb_101 rb_101
rb_100 rb_100
rb_99 rb_99
rb_98 rb_98
rb_97 rb_97
rb_96 rb_96
rb_95 rb_95
rb_94 rb_94
rb_93 rb_93
rb_92 rb_92
rb_91 rb_91
rb_90 rb_90
rb_89 rb_89
rb_88 rb_88
rb_87 rb_87
rb_86 rb_86
rb_85 rb_85
rb_84 rb_84
rb_83 rb_83
rb_82 rb_82
rb_81 rb_81
rb_79 rb_79
rb_78 rb_78
rb_77 rb_77
rb_76 rb_76
rb_75 rb_75
rb_69 rb_69
rb_68 rb_68
rb_67 rb_67
rb_42 rb_42
rb_40 rb_40
rb_38 rb_38
rb_36 rb_36
rb_34 rb_34
rb_32 rb_32
rb_31 rb_31
rb_30 rb_30
rb_21 rb_21
rb_48 rb_48
rb_53 rb_53
rb_51 rb_51
rb_52 rb_52
rb_57 rb_57
rb_29 rb_29
rb_28 rb_28
rb_27 rb_27
rb_26 rb_26
rb_20 rb_20
rb_19 rb_19
rb_16 rb_16
rb_14 rb_14
rb_11 rb_11
rb_9 rb_9
rb_7 rb_7
rb_35 rb_35
rb_37 rb_37
rb_39 rb_39
rb_41 rb_41
rb_43 rb_43
rb_25 rb_25
rb_24 rb_24
rb_23 rb_23
rb_22 rb_22
rb_8 rb_8
rb_10 rb_10
rb_12 rb_12
rb_13 rb_13
rb_15 rb_15
rb_44 rb_44
rb_17 rb_17
rb_18 rb_18
rb_47 rb_47
rb_74 rb_74
rb_73 rb_73
rb_72 rb_72
rb_71 rb_71
rb_66 rb_66
rb_65 rb_65
rb_64 rb_64
rb_63 rb_63
rb_62 rb_62
rb_61 rb_61
rb_60 rb_60
rb_59 rb_59
rb_58 rb_58
rb_50 rb_50
rb_54 rb_54
rb_55 rb_55
rb_56 rb_56
rb_49 rb_49
dw_1 dw_1
rb_4 rb_4
rb_1 rb_1
rb_6 rb_6
rb_5 rb_5
rb_3 rb_3
rb_2 rb_2
gb_2 gb_2
gb_6 gb_6
gb_1 gb_1
gb_3 gb_3
gb_5 gb_5
gb_4 gb_4
gb_9 gb_9
gb_8 gb_8
gb_7 gb_7
end type
global w_csvexport w_csvexport

type variables
string ls_sql,ls_path,ls_destination, ls_file, ls_file2
string ls_sender,ls_mail,ls_recipient,ls_cc,ls_bcc,ls_subject,ls_ack_ind,ls_message,ls_addattachment,ls_dt, ls_addattachment2, ls_body_text, ls_signature
boolean lb_flag
end variables

forward prototypes
public function integer wf_csv (string fs_sql, string fs_csv_name)
end prototypes

public function integer wf_csv (string fs_sql, string fs_csv_name);string ls_style,ls_err,ls_syntax
ls_style = "style(type=tabular)"
ls_syntax = fs_sql
ls_err = ""
ls_syntax = SyntaxFromSQL(sqlca, ls_syntax, ls_style, ls_err)
If ls_err <> "" Then
  MessageBox("Sorry!", ls_err)
  Return -1
End If
dw_1.reset()
 dw_1.Create(ls_syntax)

dw_1.SetTransObject(sqlca)
dw_1.Retrieve( )


ChangeDirectory("c:\")
if DirectoryExists("reports") = false then
	CreateDirectory ("reports")
end if
	ChangeDirectory("reports")

if DirectoryExists("csv"+string(today(),'dd-mm-yyyy')) = false then
	CreateDirectory ("csv"+string(today(),'dd-mm-yyyy'))
end if
ChangeDirectory("csv"+string(today(),'dd-mm-yyyy'))
ls_path = getcurrentdirectory()+"\"

dw_1.saveas(ls_path+"\"+fs_csv_name+".csv" ,CSV!, FALSE)

return 1
end function

on w_csvexport.create
this.rb_117=create rb_117
this.dw_2=create dw_2
this.rb_116=create rb_116
this.rb_115=create rb_115
this.rb_114=create rb_114
this.rb_113=create rb_113
this.rb_112=create rb_112
this.rb_111=create rb_111
this.rb_110=create rb_110
this.rb_109=create rb_109
this.rb_108=create rb_108
this.rb_107=create rb_107
this.rb_106=create rb_106
this.rb_105=create rb_105
this.rb_80=create rb_80
this.rb_70=create rb_70
this.rb_46=create rb_46
this.rb_33=create rb_33
this.rb_45=create rb_45
this.cb_4=create cb_4
this.rb_104=create rb_104
this.cb_1=create cb_1
this.rb_103=create rb_103
this.rb_102=create rb_102
this.rb_101=create rb_101
this.rb_100=create rb_100
this.rb_99=create rb_99
this.rb_98=create rb_98
this.rb_97=create rb_97
this.rb_96=create rb_96
this.rb_95=create rb_95
this.rb_94=create rb_94
this.rb_93=create rb_93
this.rb_92=create rb_92
this.rb_91=create rb_91
this.rb_90=create rb_90
this.rb_89=create rb_89
this.rb_88=create rb_88
this.rb_87=create rb_87
this.rb_86=create rb_86
this.rb_85=create rb_85
this.rb_84=create rb_84
this.rb_83=create rb_83
this.rb_82=create rb_82
this.rb_81=create rb_81
this.rb_79=create rb_79
this.rb_78=create rb_78
this.rb_77=create rb_77
this.rb_76=create rb_76
this.rb_75=create rb_75
this.rb_69=create rb_69
this.rb_68=create rb_68
this.rb_67=create rb_67
this.rb_42=create rb_42
this.rb_40=create rb_40
this.rb_38=create rb_38
this.rb_36=create rb_36
this.rb_34=create rb_34
this.rb_32=create rb_32
this.rb_31=create rb_31
this.rb_30=create rb_30
this.rb_21=create rb_21
this.rb_48=create rb_48
this.rb_53=create rb_53
this.rb_51=create rb_51
this.rb_52=create rb_52
this.rb_57=create rb_57
this.rb_29=create rb_29
this.rb_28=create rb_28
this.rb_27=create rb_27
this.rb_26=create rb_26
this.rb_20=create rb_20
this.rb_19=create rb_19
this.rb_16=create rb_16
this.rb_14=create rb_14
this.rb_11=create rb_11
this.rb_9=create rb_9
this.rb_7=create rb_7
this.rb_35=create rb_35
this.rb_37=create rb_37
this.rb_39=create rb_39
this.rb_41=create rb_41
this.rb_43=create rb_43
this.rb_25=create rb_25
this.rb_24=create rb_24
this.rb_23=create rb_23
this.rb_22=create rb_22
this.rb_8=create rb_8
this.rb_10=create rb_10
this.rb_12=create rb_12
this.rb_13=create rb_13
this.rb_15=create rb_15
this.rb_44=create rb_44
this.rb_17=create rb_17
this.rb_18=create rb_18
this.rb_47=create rb_47
this.rb_74=create rb_74
this.rb_73=create rb_73
this.rb_72=create rb_72
this.rb_71=create rb_71
this.rb_66=create rb_66
this.rb_65=create rb_65
this.rb_64=create rb_64
this.rb_63=create rb_63
this.rb_62=create rb_62
this.rb_61=create rb_61
this.rb_60=create rb_60
this.rb_59=create rb_59
this.rb_58=create rb_58
this.rb_50=create rb_50
this.rb_54=create rb_54
this.rb_55=create rb_55
this.rb_56=create rb_56
this.rb_49=create rb_49
this.dw_1=create dw_1
this.rb_4=create rb_4
this.rb_1=create rb_1
this.rb_6=create rb_6
this.rb_5=create rb_5
this.rb_3=create rb_3
this.rb_2=create rb_2
this.gb_2=create gb_2
this.gb_6=create gb_6
this.gb_1=create gb_1
this.gb_3=create gb_3
this.gb_5=create gb_5
this.gb_4=create gb_4
this.gb_9=create gb_9
this.gb_8=create gb_8
this.gb_7=create gb_7
this.Control[]={this.rb_117,&
this.dw_2,&
this.rb_116,&
this.rb_115,&
this.rb_114,&
this.rb_113,&
this.rb_112,&
this.rb_111,&
this.rb_110,&
this.rb_109,&
this.rb_108,&
this.rb_107,&
this.rb_106,&
this.rb_105,&
this.rb_80,&
this.rb_70,&
this.rb_46,&
this.rb_33,&
this.rb_45,&
this.cb_4,&
this.rb_104,&
this.cb_1,&
this.rb_103,&
this.rb_102,&
this.rb_101,&
this.rb_100,&
this.rb_99,&
this.rb_98,&
this.rb_97,&
this.rb_96,&
this.rb_95,&
this.rb_94,&
this.rb_93,&
this.rb_92,&
this.rb_91,&
this.rb_90,&
this.rb_89,&
this.rb_88,&
this.rb_87,&
this.rb_86,&
this.rb_85,&
this.rb_84,&
this.rb_83,&
this.rb_82,&
this.rb_81,&
this.rb_79,&
this.rb_78,&
this.rb_77,&
this.rb_76,&
this.rb_75,&
this.rb_69,&
this.rb_68,&
this.rb_67,&
this.rb_42,&
this.rb_40,&
this.rb_38,&
this.rb_36,&
this.rb_34,&
this.rb_32,&
this.rb_31,&
this.rb_30,&
this.rb_21,&
this.rb_48,&
this.rb_53,&
this.rb_51,&
this.rb_52,&
this.rb_57,&
this.rb_29,&
this.rb_28,&
this.rb_27,&
this.rb_26,&
this.rb_20,&
this.rb_19,&
this.rb_16,&
this.rb_14,&
this.rb_11,&
this.rb_9,&
this.rb_7,&
this.rb_35,&
this.rb_37,&
this.rb_39,&
this.rb_41,&
this.rb_43,&
this.rb_25,&
this.rb_24,&
this.rb_23,&
this.rb_22,&
this.rb_8,&
this.rb_10,&
this.rb_12,&
this.rb_13,&
this.rb_15,&
this.rb_44,&
this.rb_17,&
this.rb_18,&
this.rb_47,&
this.rb_74,&
this.rb_73,&
this.rb_72,&
this.rb_71,&
this.rb_66,&
this.rb_65,&
this.rb_64,&
this.rb_63,&
this.rb_62,&
this.rb_61,&
this.rb_60,&
this.rb_59,&
this.rb_58,&
this.rb_50,&
this.rb_54,&
this.rb_55,&
this.rb_56,&
this.rb_49,&
this.dw_1,&
this.rb_4,&
this.rb_1,&
this.rb_6,&
this.rb_5,&
this.rb_3,&
this.rb_2,&
this.gb_2,&
this.gb_6,&
this.gb_1,&
this.gb_3,&
this.gb_5,&
this.gb_4,&
this.gb_9,&
this.gb_8,&
this.gb_7}
end on

on w_csvexport.destroy
destroy(this.rb_117)
destroy(this.dw_2)
destroy(this.rb_116)
destroy(this.rb_115)
destroy(this.rb_114)
destroy(this.rb_113)
destroy(this.rb_112)
destroy(this.rb_111)
destroy(this.rb_110)
destroy(this.rb_109)
destroy(this.rb_108)
destroy(this.rb_107)
destroy(this.rb_106)
destroy(this.rb_105)
destroy(this.rb_80)
destroy(this.rb_70)
destroy(this.rb_46)
destroy(this.rb_33)
destroy(this.rb_45)
destroy(this.cb_4)
destroy(this.rb_104)
destroy(this.cb_1)
destroy(this.rb_103)
destroy(this.rb_102)
destroy(this.rb_101)
destroy(this.rb_100)
destroy(this.rb_99)
destroy(this.rb_98)
destroy(this.rb_97)
destroy(this.rb_96)
destroy(this.rb_95)
destroy(this.rb_94)
destroy(this.rb_93)
destroy(this.rb_92)
destroy(this.rb_91)
destroy(this.rb_90)
destroy(this.rb_89)
destroy(this.rb_88)
destroy(this.rb_87)
destroy(this.rb_86)
destroy(this.rb_85)
destroy(this.rb_84)
destroy(this.rb_83)
destroy(this.rb_82)
destroy(this.rb_81)
destroy(this.rb_79)
destroy(this.rb_78)
destroy(this.rb_77)
destroy(this.rb_76)
destroy(this.rb_75)
destroy(this.rb_69)
destroy(this.rb_68)
destroy(this.rb_67)
destroy(this.rb_42)
destroy(this.rb_40)
destroy(this.rb_38)
destroy(this.rb_36)
destroy(this.rb_34)
destroy(this.rb_32)
destroy(this.rb_31)
destroy(this.rb_30)
destroy(this.rb_21)
destroy(this.rb_48)
destroy(this.rb_53)
destroy(this.rb_51)
destroy(this.rb_52)
destroy(this.rb_57)
destroy(this.rb_29)
destroy(this.rb_28)
destroy(this.rb_27)
destroy(this.rb_26)
destroy(this.rb_20)
destroy(this.rb_19)
destroy(this.rb_16)
destroy(this.rb_14)
destroy(this.rb_11)
destroy(this.rb_9)
destroy(this.rb_7)
destroy(this.rb_35)
destroy(this.rb_37)
destroy(this.rb_39)
destroy(this.rb_41)
destroy(this.rb_43)
destroy(this.rb_25)
destroy(this.rb_24)
destroy(this.rb_23)
destroy(this.rb_22)
destroy(this.rb_8)
destroy(this.rb_10)
destroy(this.rb_12)
destroy(this.rb_13)
destroy(this.rb_15)
destroy(this.rb_44)
destroy(this.rb_17)
destroy(this.rb_18)
destroy(this.rb_47)
destroy(this.rb_74)
destroy(this.rb_73)
destroy(this.rb_72)
destroy(this.rb_71)
destroy(this.rb_66)
destroy(this.rb_65)
destroy(this.rb_64)
destroy(this.rb_63)
destroy(this.rb_62)
destroy(this.rb_61)
destroy(this.rb_60)
destroy(this.rb_59)
destroy(this.rb_58)
destroy(this.rb_50)
destroy(this.rb_54)
destroy(this.rb_55)
destroy(this.rb_56)
destroy(this.rb_49)
destroy(this.dw_1)
destroy(this.rb_4)
destroy(this.rb_1)
destroy(this.rb_6)
destroy(this.rb_5)
destroy(this.rb_3)
destroy(this.rb_2)
destroy(this.gb_2)
destroy(this.gb_6)
destroy(this.gb_1)
destroy(this.gb_3)
destroy(this.gb_5)
destroy(this.gb_4)
destroy(this.gb_9)
destroy(this.gb_8)
destroy(this.gb_7)
end on

event open;if gs_garden_snm = 'MK' then
	rb_116.visible =true
	rb_104.enabled = true
else
	rb_116.visible =false
	rb_104.enabled = true
end if

dw_2.modify("t_co.text = '"+upper(gs_co_name)+"'")
dw_2.modify("t_gnm.text = '"+gs_garden_nameadd+"'")

if gs_garden_snm = 'MK' then
	dw_2.modify("p_1.visible = 0")
	dw_2.modify("p_2.visible = 1")
else 
	dw_2.modify("p_1.visible = 1")
	dw_2.modify("p_2.visible = 0")
end if
end event

type rb_117 from radiobutton within w_csvexport
integer x = 3186
integer y = 2096
integer width = 553
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Sales Invoice Post"
end type

event clicked;long ll_temp 

setpointer(Hourglass!)



integer li_temp
dw_2.settransobject(sqlca)
dw_2.retrieve()

ls_file2 = "c:\temp\"+gs_garden_snm+"_saleinvoicepdf"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".pdf"
li_temp = dw_2.saveas(ls_file2,pdf!,true)


select fn_upload_tea_despatch(:gs_user) into :ll_temp  from dual;
if  sqlca.sqlcode = -1 then
	messagebox('Error During fn_upload_tea_despatch',sqlca.sqlerrtext)	
	return 1
end if


select MD_SEND_BY, MD_TO, MD_CC, MD_BCC, MD_SUBJECT, MD_DETAIL, MD_SIGNATURE into :ls_sender, :ls_recipient, :ls_cc, :ls_bcc, :ls_subject, :ls_body_text, :ls_signature from FB_MAIL_MESSAGE_DETAIL where nvl(MD_EMAIL_IND,'N') = 'Y' and MD_MESS_ID = 1 ;
if sqlca.sqlcode = -1 then
	messagebox('Error','Error occured while fetching mail parameters - '+sqlca.sqlerrtext)
	return 1
elseif sqlca.sqlcode = 100 then
	messagebox('Warning','No parameters found for mail')
	return 1
end if

if isnull(ls_sender)	then
	messagebox('Warning','Sender Email is blank')
	return 1
end if

if isnull(ls_recipient)	then
	messagebox('Warning','Sender Email is blank')
	return 1
end if

if isnull(ls_cc) then ls_cc = ""

if isnull(ls_bcc) then ls_bcc = ""

if isnull(ls_subject) then ls_subject = ""

if isnull(ls_body_text) then ls_body_text = ""

if isnull(ls_signature) then ls_signature = ""
	

if(len(gs_garden_mail)<>0) then
	ls_cc += gs_garden_mail
end if
	

ls_addattachment2 = ls_file2

ls_subject 	 = ls_subject + string(today(),'dd/mm/yyyy')+" "+ gs_garden_nm

ls_message	= "Dear Sir/Madam, "+gs_lfcr+gs_lfcr+ls_body_text+gs_lfcr+gs_lfcr
ls_message	 = ls_message +gs_lfcr+"Your kind attention is required."+gs_lfcr

ls_message	 = ls_message +gs_lfcr+"Administrator"+gs_lfcr

ls_message	 = ls_message +gs_lfcr+gs_lfcr+gs_garden_nm+gs_lfcr+gs_garden_add+gs_lfcr+gs_lfcr

ls_message += ls_signature

n_web_mail lnvo_mail
	
lnvo_mail = Create n_web_mail

lb_flag = lnvo_mail.of_send_webmail_single(ls_sender,ls_recipient,ls_cc,ls_subject,ls_message,ls_bcc,ls_addattachment2) 



setpointer(Arrow!)
messagebox('Success','Data Has been Posted to HO')


end event

type dw_2 from datawindow within w_csvexport
boolean visible = false
integer x = 4256
integer y = 188
integer width = 251
integer height = 1828
integer taborder = 20
string title = "none"
string dataobject = "dw_salepdfexport"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type rb_116 from radiobutton within w_csvexport
boolean visible = false
integer x = 2569
integer y = 2456
integer width = 603
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Invoices For Website"
end type

event clicked;string ls_rec_ty,ls_sicn, ls_sicndt, ls_type, ls_tranid, ls_wareid, ls_custid,ls_advid, ls_sidesc, ls_brokid, ls_siid,ls_rec, ls_gsn
string ls_lotno,ls_tmpid
long ll_stno,ll_endno, ll_season, ll_noofbag
double ld_indwt,  ld_RATE
integer li_filenum, li_rec, li_ctr 
li_ctr=0;
setpointer(hourglass!) 

setnull(ls_sicn);setnull(ls_sicndt);ll_season = 0; setnull(ls_lotno); setnull(ls_tmpid); ll_stno = 0; ll_endno = 0; ll_noofbag = 0;  ld_indwt= 0; ld_RATE = 0;setnull(ls_siid);

If not DirectoryExists ("c:\temp") Then
	CreateDirectory ("c:\temp")
End If


if fileexists("c:\temp\invoiceforweb"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv") = true then
	filedelete("c:\temp\invoiceforweb"+string(today(),"-ddmmyy_")+string(now(),"hhmmss")+".csv")
end if

li_filenum =  fileopen("c:\temp\invoiceforweb"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv",linemode!,write!,lockreadwrite!,replace!)

DECLARE c1 CURSOR FOR
select distinct SI_CN CN_NO, to_char(SI_CNDATE,'mm/dd/yyyy') CN_DT, DTP_SEASON SEASON, DTP_LOTNO INVOICE_NO, e.TMP_ID GRADE_ID, DTPD_SRNOSTART , DTPD_SRNOEND  ,((DTPD_SRNOEND - DTPD_SRNOSTART)+1)NO_OF_BAG,
DTPD_INDWT NET_WEIGHT, NVL(SID_RATE,0) RATE,a.si_id
from fb_saleinvoice a, fb_sidetails b, fb_teamadeproduct c, fb_dailyteapacked d, fb_dtpdetails e, fb_gardenmaster f
where a.si_id = b.si_id and b.dtpd_id  = e.dtpd_id and d.dtp_id = e.dtp_id and e.tmp_id = c.tmp_id and UNIT_ACTIVE_IND = 'Y' and si_rosend_dt is null order by a.si_id;
			
 open c1;
 if sqlca.sqlcode = -1 then
	messagebox('Sql Error During Opening Cursor !',sqlca.sqlerrtext)
	return 1
 elseif sqlca.sqlcode = 0 then
   fetch c1 into :ls_sicn, :ls_sicndt, :ll_season, :ls_lotno, :ls_tmpid, :ll_stno, :ll_endno, :ll_noofbag, :ld_indwt, :ld_RATE, :ls_siid;

	do while sqlca.sqlcode <> 100
		
		if isnull(ls_sicn) then; ls_sicn=""; end if;		
   		if isnull(ls_sicndt) then; ls_sicndt=""; end if;
		if isnull(ll_season) then; ll_season = 0; end if;
		if isnull(ls_lotno) then; ls_lotno=""; end if;
		if isnull(ls_tmpid) then; ls_tmpid=""; end if;	
		if isnull(ll_stno) then; ll_season = 0; end if;
		if isnull(ll_endno) then; ll_season = 0; end if;
		if isnull(ll_noofbag) then; ll_season = 0; end if;
		if isnull(ld_indwt) then; ll_season = 0; end if;
		if isnull(ld_RATE) then; ll_season = 0; end if;
		if isnull(ls_siid) then; ls_siid=""; end if;	
		
		
		if pos(ls_sicn,",") > 0 then
			do while pos(ls_sidesc,",") > 0
				 ls_sidesc = replace(ls_sidesc,pos(ls_sidesc,","),1," "); 
			loop
		end if;
		
		if pos(ls_lotno,",") > 0 then
			do while pos(ls_sidesc,",") > 0
				 ls_sidesc = replace(ls_sidesc,pos(ls_sidesc,","),1," "); 
			loop
		end if;
		

		
		ls_rec = ls_sicn +","
		if ls_sicndt="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_sicndt + ","
		ls_rec = ls_rec + string(ll_season) +","
		ls_rec = ls_rec + ls_lotno +","+ ls_tmpid +","+ string(ll_stno) +","+ string(ll_endno) +","
		ls_rec = ls_rec +string(ll_noofbag) +","+string(ld_indwt) +"," +string(ld_RATE)
		
		
		filewrite(li_filenum,ls_rec)
		
		if gs_garden_snm = 'MK' then
			update fb_saleinvoice set SI_ROSEND_DT = sysdate where si_id= :ls_siid;
		
			 if sqlca.sqlcode = -1 then
				messagebox('Error: During Update Send Date',sqlca.sqlerrtext)
				rollback using sqlca;
				return -1
			end if	
		end if
		
		li_rec++
		li_ctr++
		
		setnull(ls_sicn);setnull(ls_sicndt);ll_season = 0; setnull(ls_lotno); setnull(ls_tmpid); ll_stno = 0; ll_endno = 0; ll_noofbag = 0;  ld_indwt= 0; ld_RATE = 0;setnull(ls_siid);
	
    fetch c1 into :ls_sicn, :ls_sicndt, :ll_season, :ls_lotno, :ls_tmpid, :ll_stno, :ll_endno, :ll_noofbag, :ld_indwt, :ld_RATE, :ls_siid;

   
   loop
	close c1;
else
	messagebox('Error: During Opening of Cursor',sqlca.sqlerrtext)
	return -1
end if

	fileclose(li_filenum) 

setpointer(arrow!) 
messagebox('Confirmation','Total No Of Records : '+string(li_ctr))
return 1
end event

type rb_115 from radiobutton within w_csvexport
integer x = 3186
integer y = 2180
integer width = 471
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Misc. Sales Inv."
end type

event clicked;string ls_rec_ty, ls_sidate, ls_sicn, ls_sicndt, ls_type, ls_tranid, ls_wareid, ls_custid, ls_sidesc, ls_brokid, ls_siid,ls_rec, ls_gsn
string ls_item_id,ls_tmpid, ls_unitid
double ld_insval, ld_exciseduty, ld_sicess, ld_sieducess,ld_hecess,ld_quantity
long ll_stno,ll_endno, ll_season
double ld_chestwt, ld_indwt
double ld_CGST_PER, ld_CGST_AMT, ld_SGST_PER, ld_SGST_AMT, ld_IGST_PER, ld_IGST_AMT, ld_RATE
string ls_ISS_LOCN, ls_REC_LOCN, ls_PONO, ls_PODT, ls_DCNO, ls_DCDT, ls_PROMPTDT, ls_SUPPLY_DT, ls_SUPPLY_PLACE, ls_TAXINVNO, ls_DELVCHNO, ls_SHIP_TO_ADD, ls_REV_CHRG
integer li_filenum, li_rec, li_ctr 
li_ctr=0;
setpointer(hourglass!) 

setnull(ls_rec_ty);setnull(ls_sidate);setnull(ls_sicn);setnull(ls_sicndt);setnull(ls_type);setnull(ls_destination);setnull(ls_tranid);setnull(ls_wareid);setnull(ls_custid);
setnull(ls_sidesc);setnull(ls_brokid);setnull(ls_siid);
setnull(ls_ISS_LOCN); setnull(ls_REC_LOCN); setnull(ls_PONO); setnull(ls_PODT); setnull(ls_DCNO); setnull(ls_DCDT); setnull(ls_PROMPTDT); setnull(ls_SUPPLY_DT); setnull(ls_SUPPLY_PLACE);setnull(ls_TAXINVNO); setnull(ls_DELVCHNO); setnull(ls_SHIP_TO_ADD); setnull(ls_REV_CHRG);
ld_insval = 0; ld_exciseduty = 0; ld_sicess = 0; ld_sieducess = 0; ld_hecess=0; setnull(ls_gsn); setnull(ls_unitid);
ld_CGST_PER = 0; ld_CGST_AMT = 0; ld_SGST_PER = 0; ld_SGST_AMT = 0; ld_IGST_PER = 0; ld_IGST_AMT = 0; ld_RATE = 0;

If not DirectoryExists ("c:\temp") Then
	CreateDirectory ("c:\temp")
End If


if fileexists("c:\temp\miscsaleinvoice"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv") = true then
	filedelete("c:\temp\miscsaleinvoice"+string(today(),"-ddmmyy_")+string(now(),"hhmmss")+".csv")
end if

li_filenum =  fileopen("c:\temp\miscsaleinvoice"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv",linemode!,write!,lockreadwrite!,replace!)
//select 'SH', to_char(SI_DATE,'dd/mm/yyyy'),SI_CN,to_char(SI_CNDATE,'dd/mm/yyyy'),
// 		 decode(SI_TYPE,'AUCTION','AUC','PRICONS','CON','PRILOCAL','LOC','TRANSFREE','TFR','TRANSPRI','TPR',null),
//		 decode(SI_TYPE,'AUCTION',b.CITY_ID,'PRICONS',c.CITY_ID,null) destination,
//		 TRANSP_ID,a.WARE_ID,a.CUS_ID,substr(ADVICE_ID,1,16),SI_DESC,SI_INSURANCEVALUE,BROK_ID,SI_EXCISEDUTY,SI_CESS,SI_EDUCATIONALCESS,
//		 SI_CENTRALEXCISENO,SI_ID,SI_HSECESS,:gs_garden_snm,:gs_unit,SI_WAYBILLNO
//from fb_saleinvoice a, (select WARE_ID, CITY_ID from fb_warehouse) b, (select CUS_ID, CITY_ID from fb_customer) c
//where a.WARE_ID = b.WARE_ID(+) and a.CUS_ID = c.CUS_ID(+) and SI_ROSEND_DT is null order by 2;

DECLARE c1 CURSOR FOR
select distinct 'SH', min(to_char(SI_DATE,'dd/mm/yyyy')),SI_CN,min(to_char(SI_CNDATE,'dd/mm/yyyy')),
          SI_TYPE,c.city_id destination,
         TRANSP_ID,a.WARE_ID,a.CUS_ID,min(SI_DESC),sum(nvl(SI_INSURANCEVALUE,0)) SI_INSURANCEVALUE,min(BROK_ID),
         sum(nvl(SI_EXCISEDUTY,0)) SI_EXCISEDUTY, sum(nvl(SI_CESS,0)) SI_CESS,sum(nvl(SI_EDUCATIONALCESS,0)) SI_EDUCATIONALCESS, 
         min(SI_ID) SI_ID,sum(nvl(SI_HSECESS,0)) SI_HSECESS,:gs_garden_snm,:gs_unit,
		SI_ISS_LOCN, SI_REC_LOCN, SI_PONO, min(to_char(SI_PODT,'dd/mm/yyyy')), SI_DCNO, min(to_char(SI_DCDT,'dd/mm/yyyy')), min(to_char(SI_PROMPTDT,'dd/mm/yyyy')), 
		min(to_char(SI_SUPPLY_DT,'dd/mm/yyyy')), SI_SUPPLY_PLACE, SI_TAXINVNO, SI_DELVCHNO, SI_SHIP_TO_ADD, SI_REV_CHRG
from fb_misc_saleinvoice a,  (select CUS_ID, CITY_ID from fb_customer) c
where a.CUS_ID = c.CUS_ID(+) and SI_ROSEND_DT is null  and (SI_CN is not null and SI_CN <> '0') 
group by SI_CN,SI_TYPE,
         	c.city_id,TRANSP_ID,a.WARE_ID,a.CUS_ID,
			SI_ISS_LOCN, SI_REC_LOCN, SI_PONO,  SI_DCNO, SI_SUPPLY_PLACE, SI_TAXINVNO, SI_DELVCHNO, SI_SHIP_TO_ADD, SI_REV_CHRG
order by 2; 
			
 open c1;
 if sqlca.sqlcode = -1 then
	messagebox('Sql Error During Opening Cursor !',sqlca.sqlerrtext)
	return 1
 elseif sqlca.sqlcode = 0 then
   fetch c1 into :ls_rec_ty, :ls_sidate, :ls_sicn, :ls_sicndt, :ls_type, :ls_destination, :ls_tranid, :ls_wareid, :ls_custid, :ls_sidesc, :ld_insval, :ls_brokid, :ld_exciseduty, :ld_sicess, :ld_sieducess, :ls_siid, :ld_hecess, :ls_gsn, :ls_unitid,:ls_ISS_LOCN, :ls_REC_LOCN, :ls_PONO, :ls_PODT, :ls_DCNO, :ls_DCDT, :ls_PROMPTDT, :ls_SUPPLY_DT, :ls_SUPPLY_PLACE, :ls_TAXINVNO, :ls_DELVCHNO, :ls_SHIP_TO_ADD, :ls_REV_CHRG;

	do while sqlca.sqlcode <> 100
		
		
		if isnull(ls_rec_ty) then; ls_rec_ty=""; end if;
		if isnull(ls_sidate) then; ls_sidate=""; end if;
		if isnull(ls_sicn) then; ls_sicn=""; end if;		
   		if isnull(ls_sicndt) then; ls_sicndt=""; end if;
   		if isnull(ls_type) then; ls_type=""; end if;
		if isnull(ls_destination) then; ls_destination=""; end if;
		if isnull(ls_tranid) then; ls_tranid=""; end if;
		if isnull(ls_wareid) then; ls_wareid=""; end if;
   		if isnull(ls_custid) then; ls_custid=""; end if;
		if isnull(ls_sidesc) then; ls_sidesc=""; end if;
		if isnull(ld_insval) then; ld_insval = 0; end if;
		if isnull(ls_brokid) then; ls_brokid=""; end if;											                                                          																																									                                     
		if isnull(ld_exciseduty) then; ld_exciseduty = 0; end if;
		if isnull(ld_sicess) then; ld_sicess = 0; end if;
		if isnull(ld_sieducess) then; ld_sieducess = 0; end if;
		if isnull(ls_siid) then; ls_siid=""; end if;
		if isnull(ls_gsn) then; ls_gsn=""; end if;
		if isnull(ls_unitid) then; ls_unitid=""; end if;
		
		
		if isnull(ls_ISS_LOCN) then; ls_ISS_LOCN = ""; end if;
		if isnull(ls_REC_LOCN) then; ls_REC_LOCN = ""; end if;
		if isnull(ls_PONO) then; ls_PONO = ""; end if;
		if isnull(ls_PODT) then; ls_PODT = ""; end if;
		if isnull(ls_DCNO) then; ls_DCNO = ""; end if;
		if isnull(ls_DCDT) then; ls_DCDT = ""; end if;
		if isnull(ls_PROMPTDT) then; ls_PROMPTDT = ""; end if;
		if isnull(ls_SUPPLY_DT) then; ls_SUPPLY_DT = ""; end if;
		if isnull(ls_SUPPLY_PLACE) then; ls_SUPPLY_PLACE = ""; end if;
		if isnull(ls_TAXINVNO) then; ls_TAXINVNO = ""; end if;
		if isnull(ls_DELVCHNO) then; ls_DELVCHNO = ""; end if;
		if isnull(ls_SHIP_TO_ADD) then; ls_SHIP_TO_ADD = ""; end if;
		if isnull(ls_REV_CHRG) then; ls_REV_CHRG = ""; end if;
		
		if pos(ls_sidesc,"'") > 0 then; ls_sidesc = replace(ls_sidesc,pos(ls_sidesc,"'"),1,"`"); end if;
		
		if pos(ls_sidesc,",") > 0 then
			do while pos(ls_sidesc,",") > 0
				 ls_sidesc = replace(ls_sidesc,pos(ls_sidesc,","),1," "); 
			loop
		end if;
		
		if pos(ls_destination,"'") > 0 then; ls_destination = replace(ls_destination,pos(ls_destination,"'"),1,"`"); end if;
		
		if pos(ls_destination,",") > 0 then
			do while pos(ls_destination,",") > 0
				 ls_destination = replace(ls_destination,pos(ls_destination,","),1," "); 
			loop
		end if;
		
		if pos(ls_PONO,"'") > 0 then; ls_PONO = replace(ls_PONO,pos(ls_PONO,"'"),1,"`"); end if;		
		
		if pos(ls_PONO,",") > 0 then
			do while pos(ls_PONO,",") > 0
				 ls_PONO = replace(ls_PONO,pos(ls_PONO,","),1," "); 
			loop
		end if;	
		
		if pos(ls_DCNO,"'") > 0 then; ls_DCNO = replace(ls_DCNO,pos(ls_DCNO,"'"),1,"`"); end if;		
		
		if pos(ls_DCNO,",") > 0 then
			do while pos(ls_DCNO,",") > 0
				 ls_DCNO = replace(ls_DCNO,pos(ls_DCNO,","),1," "); 
			loop
		end if;
		
		if pos(ls_SUPPLY_PLACE,"'") > 0 then; ls_SUPPLY_PLACE = replace(ls_SUPPLY_PLACE,pos(ls_SUPPLY_PLACE,"'"),1,"`"); end if;		
		
		if pos(ls_SUPPLY_PLACE,",") > 0 then
			do while pos(ls_SUPPLY_PLACE,",") > 0
				 ls_SUPPLY_PLACE = replace(ls_SUPPLY_PLACE,pos(ls_SUPPLY_PLACE,","),1," "); 
			loop
		end if;		
		
	
		if pos(ls_SHIP_TO_ADD,"'") > 0 then; ls_SHIP_TO_ADD = replace(ls_SHIP_TO_ADD,pos(ls_SHIP_TO_ADD,"'"),1,"`"); end if;		
		
		if pos(ls_SHIP_TO_ADD,",") > 0 then
			do while pos(ls_SHIP_TO_ADD,",") > 0
				 ls_SHIP_TO_ADD = replace(ls_SHIP_TO_ADD,pos(ls_SHIP_TO_ADD,","),1," "); 
			loop
		end if;
		
		ls_rec = ls_rec_ty +","
		if ls_sidate="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_sidate + ","
		ls_rec = ls_rec + ls_sicn +","
		if ls_sicndt = "" then ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_sicndt + ","
		ls_rec = ls_rec + ls_type +","+ ls_tranid +","+ ls_wareid +","+ ls_custid +","
		ls_rec = ls_rec +","+ trim(ls_sidesc) +"," 
		ls_rec = ls_rec + string(ld_insval)+","+ls_brokid +"," + string(ld_exciseduty)+","+string(ld_sicess)+ "," + string(ld_sieducess) + "," + ls_siid + "," + string(ld_hecess) + "," + ls_gsn + "," + ls_unitid + "," + ls_destination +"," 
		ls_rec = ls_rec + string(ls_ISS_LOCN) +","+string(ls_REC_LOCN) +"," + ls_PONO+","
		if ls_PODT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_PODT + "," 
		ls_rec = ls_rec + trim(ls_DCNO) +","
		if ls_DCDT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_DCDT + "," 
		if ls_PROMPTDT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_PROMPTDT + "," 
		if ls_SUPPLY_DT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_SUPPLY_DT + "," 
		ls_rec = ls_rec + ls_SUPPLY_PLACE+","+ls_TAXINVNO +"," + ls_DELVCHNO+","+ls_SHIP_TO_ADD+ ","+ ls_REV_CHRG
		
		
		filewrite(li_filenum,ls_rec)
		
		setnull(ls_rec);setnull(ls_item_id); ld_quantity = 0;	ld_CGST_PER = 0; ld_CGST_AMT = 0; ld_SGST_PER = 0; ld_SGST_AMT = 0; ld_IGST_PER = 0; ld_IGST_AMT = 0; ld_RATE = 0;

//		select 'SL', dtp_lotno,SID_SRNOSTART, SID_SRNOEND,tmp_id,dtpd_chestwt,dtpd_indwt,sid_season,SID_CGST_PER, SID_CGST_AMT, SID_SGST_PER, SID_SGST_AMT, SID_IGST_PER, SID_IGST_AMT, SID_RATE
//		from fb_dailyteapacked a, fb_dtpdetails b, fb_saleinvoice c,fb_sidetails d
//		where a.dtp_id= b.dtp_id and c.SI_ID = d.SI_ID and c.si_cn = :ls_sicn and b.DTPD_ID = d.DTPD_ID and SID_SRNOSTART = dtpd_srnostart and 
//				SID_SRNOEND = dtpd_srnoend and SI_ROSEND_DT is null;

		DECLARE c2 CURSOR FOR
		select 'SL', d.ITEM_ID, SID_QUANTITY, SID_CGST_PER, SID_CGST_AMT, SID_SGST_PER, SID_SGST_AMT, SID_IGST_PER, SID_IGST_AMT, SID_RATE
		from  fb_misc_saleinvoice c,fb_misc_sidetails d, fb_misc_item e
		where c.SI_ID = d.SI_ID and c.si_cn = :ls_sicn and d.item_id = e.item_ID and SI_ROSEND_DT is null;
		 open c2;
		
		 if sqlca.sqlcode = 0 then
			fetch c2 into :ls_rec_ty,:ls_item_id,:ld_quantity,:ld_CGST_PER, :ld_CGST_AMT, :ld_SGST_PER, :ld_SGST_AMT, :ld_IGST_PER, :ld_IGST_AMT, :ld_RATE;
		
			do while sqlca.sqlcode <> 100
		
		//		for li_rec = 1 to 10
		//			if pos(ls_reason,"'") > 0 then; ls_reason = replace(ls_reason,pos(ls_reason,"'"),1,"`"); end if;
		//		next 
				
					if isnull(ls_rec_ty) then; ls_rec_ty=""; end if;	
					if isnull(ls_item_id) then; ls_item_id=""; end if;
					if isnull(ld_quantity) then; ld_quantity = 0; end if;
					if isnull(ld_CGST_PER) then; ld_CGST_per = 0; end if;
					if isnull(ld_CGST_AMT) then; ld_CGST_AMT = 0; end if;
					if isnull(ld_SGST_PER) then; ld_SGST_per = 0; end if; 
					if isnull(ld_SGST_AMT) then; ld_SGST_AMT = 0; end if;
					if isnull(ld_IGST_PER) then; ld_IGST_per = 0; end if; 
					if isnull(ld_IGST_AMT) then; ld_IGST_AMT = 0; end if;
					if isnull(ld_RATE) then; ld_RATE = 0; end if;
		
			//		if pos(ls_ref_ordno,"'") > 0 then; ls_ref_ordno = replace(ls_ref_ordno,pos(ls_ref_ordno,"'"),1,"`"); end if;
					
				ls_rec = ls_rec_ty +","+ ls_item_id +","
				ls_rec = ls_rec + string(ld_quantity) +","+string(ld_CGST_PER)+","+string(ld_CGST_AMT)+","+string(ld_SGST_PER)+","+string(ld_SGST_AMT)+","+string(ld_IGST_PER)+","+string(ld_IGST_AMT)+","+string(ld_RATE)
				
				filewrite(li_filenum,ls_rec)
				//li_rec++
				
				setnull(ls_rec);setnull(ls_item_id); ld_quantity = 0;	ld_CGST_PER = 0; ld_CGST_AMT = 0; ld_SGST_PER = 0; ld_SGST_AMT = 0; ld_IGST_PER = 0; ld_IGST_AMT = 0; ld_RATE = 0;
				
			fetch c2 into :ls_rec_ty,:ls_item_id,:ld_quantity,:ld_CGST_PER, :ld_CGST_AMT, :ld_SGST_PER, :ld_SGST_AMT, :ld_IGST_PER, :ld_IGST_AMT, :ld_RATE;
			
			loop
			close c2;
		else
			messagebox('Error: During Opening of Cursor c2',sqlca.sqlerrtext)
			return -1
		end if
		
		update fb_misc_saleinvoice set SI_ROSEND_DT = sysdate where si_cn = :ls_sicn;
		
		 if sqlca.sqlcode = -1 then
			messagebox('Error: During Update Send Date',sqlca.sqlerrtext)
			rollback using sqlca;
			return -1
		end if
		
		li_rec++
		li_ctr++
		
		setnull(ls_rec_ty);setnull(ls_sidate);setnull(ls_sicn);setnull(ls_sicndt);setnull(ls_type);setnull(ls_destination);setnull(ls_tranid);setnull(ls_wareid);setnull(ls_custid);
		setnull(ls_sidesc);setnull(ls_brokid);setnull(ls_siid);
		ld_insval = 0; ld_exciseduty = 0; ld_sicess = 0; ld_sieducess = 0; ld_hecess=0; setnull(ls_gsn); setnull(ls_unitid);
		setnull(ls_ISS_LOCN); setnull(ls_REC_LOCN); setnull(ls_PONO); setnull(ls_PODT); setnull(ls_DCNO); setnull(ls_DCDT); setnull(ls_PROMPTDT); setnull(ls_SUPPLY_DT); 
		setnull(ls_SUPPLY_PLACE);setnull(ls_TAXINVNO); setnull(ls_DELVCHNO); setnull(ls_SHIP_TO_ADD); setnull(ls_REV_CHRG);
	
  fetch c1 into :ls_rec_ty, :ls_sidate, :ls_sicn, :ls_sicndt, :ls_type, :ls_destination, :ls_tranid, :ls_wareid, :ls_custid, :ls_sidesc, :ld_insval, :ls_brokid, :ld_exciseduty, :ld_sicess, :ld_sieducess, :ls_siid, :ld_hecess, :ls_gsn, :ls_unitid,:ls_ISS_LOCN, :ls_REC_LOCN, :ls_PONO, :ls_PODT, :ls_DCNO, :ls_DCDT, :ls_PROMPTDT, :ls_SUPPLY_DT, :ls_SUPPLY_PLACE, :ls_TAXINVNO, :ls_DELVCHNO, :ls_SHIP_TO_ADD, :ls_REV_CHRG;
   
   loop
	close c1;
else
	messagebox('Error: During Opening of Cursor',sqlca.sqlerrtext)
	return -1
end if

	fileclose(li_filenum) 

setpointer(arrow!) 
messagebox('Confirmation','Total No Of Records : '+string(li_ctr))
return 1
end event

type rb_114 from radiobutton within w_csvexport
integer x = 3186
integer y = 2348
integer width = 421
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "MIS Teamade"
end type

event clicked;string ls_rec,  ls_gsn, ls_ind, ls_recind, ls_desc, ls_entry_by, ls_entry_dt
double ld_glqty, ld_teamade, ld_amt
integer li_filenum, li_rec, li_ctr 
li_ctr=0;
setpointer(hourglass!) 

setnull(ls_rec);setnull(ls_dt);setnull(ls_gsn);setnull(ls_ind);setnull(ls_recind);setnull(ls_desc);setnull(ls_entry_by);setnull(ls_entry_dt);
ld_glqty = 0; ld_teamade = 0; ld_amt = 0;

If not DirectoryExists ("c:\temp") Then
	CreateDirectory ("c:\temp")
End If

if fileexists("c:\temp\misteamade.csv") = true then
	filedelete("c:\temp\misteamade.csv")
end if

li_filenum =  fileopen("c:\temp\misteamade.csv",linemode!,write!,lockreadwrite!,replace!)
//select 'SH', to_char(SI_DATE,'dd/mm/yyyy'),SI_CN,to_char(SI_CNDATE,'dd/mm/yyyy'),
// 		 decode(SI_TYPE,'AUCTION','AUC','PRICONS','CON','PRILOCAL','LOC','TRANSFREE','TFR','TRANSPRI','TPR',null),
//		 decode(SI_TYPE,'AUCTION',b.CITY_ID,'PRICONS',c.CITY_ID,null) destination,
//		 TRANSP_ID,a.WARE_ID,a.CUS_ID,substr(ADVICE_ID,1,16),SI_DESC,SI_INSURANCEVALUE,BROK_ID,SI_EXCISEDUTY,SI_CESS,SI_EDUCATIONALCESS,
//		 SI_CENTRALEXCISENO,SI_ID,SI_HSECESS,:gs_garden_snm,:gs_unit,SI_WAYBILLNO
//from fb_saleinvoice a, (select WARE_ID, CITY_ID from fb_warehouse) b, (select CUS_ID, CITY_ID from fb_customer) c
//where a.WARE_ID = b.WARE_ID(+) and a.CUS_ID = c.CUS_ID(+) and SI_ROSEND_DT is null order by 2;

DECLARE c1 CURSOR FOR
select to_char(decode(sign(to_number(to_char(GT_DATE,'dd'))-16),-1,to_date('15/'||to_char(GT_DATE,'mm/yyyy'),'dd/mm/yyyy'),last_day(GT_DATE)),'dd/mm/yyyy')  , upper(:gs_garden_snm),'A',decode(SUP_TYPE,'UNIT',decode(nvl(SUP_GROUPIND,'OTHER'),'OWN',decode(GT_TYPE,'PURCHASE','TRANSFERIN','BROUGHT','TRANSFERIN','SALE','TRANSFEROUT','TRANSFER','TRANSFEROUT',GT_TYPE),decode(GT_TYPE,'BROUGHT','TRANSFERIN',GT_TYPE)),GT_TYPE) TM_RECTYPE,decode(GT_TYPE,'OWNATTE','OWN','OWNUSER','OWN',initcap(b.sup_name)),sum(nvl(GT_QUANTITY,0)),0,sum(nvl(GT_NETAMOUNT,0) + nvl(GT_ADJAMT,0)),:gs_user,to_char(sysdate,'dd/mm/yyyy')
from fb_gltransaction a, fb_supplier b
where a.sup_id = b.sup_id     
group by decode(sign(to_number(to_char(GT_DATE,'dd'))-16),-1,to_date('15/'||to_char(GT_DATE,'mm/yyyy'),'dd/mm/yyyy'),last_day(GT_DATE)), upper(:gs_garden_snm),'A',decode(SUP_TYPE,'UNIT',decode(nvl(SUP_GROUPIND,'OTHER'),'OWN',decode(GT_TYPE,'PURCHASE','TRANSFERIN','BROUGHT','TRANSFERIN','SALE','TRANSFEROUT','TRANSFER','TRANSFEROUT',GT_TYPE),decode(GT_TYPE,'BROUGHT','TRANSFERIN',GT_TYPE)),GT_TYPE),decode(GT_TYPE,'OWNATTE','OWN','OWNUSER','OWN',initcap(b.sup_name))
union all
select to_char(decode(sign(to_number(to_char(GLFP_pluckingdate,'dd'))-16),-1,to_date('15/'||to_char(GLFP_pluckingdate,'mm/yyyy'),'dd/mm/yyyy'),last_day(GLFP_pluckingdate)),'dd/mm/yyyy') , upper(:gs_garden_snm), 'A',decode(GWTM_TYPE,'O','TRANSFEROUT',decode(SUP_TYPE,'OWN','OWNATTE','UNIT',decode(nvl(SUP_GROUPIND,'OTHER'),'OWN','TRANSFERIN','PURCHASE'),'PURCHASE')) ty, initcap(FB_SUPPLIER.sup_name),0,sum(nvl(GWTM_TEAMADE,0)) ,0, :gs_user,to_char(sysdate,'dd/mm/yyyy')
from fb_GLFORPRODUCTION,FB_GARDENWISETEAMADE,FB_SUPPLIER 
where  fb_GLFORPRODUCTION.GLFP_PK=FB_GARDENWISETEAMADE.GLFP_PK AND fb_GLFORPRODUCTION.SUP_ID=FB_SUPPLIER.SUP_ID(+)
group by decode(sign(to_number(to_char(GLFP_pluckingdate,'dd'))-16),-1,to_date('15/'||to_char(GLFP_pluckingdate,'mm/yyyy'),'dd/mm/yyyy'),last_day(GLFP_pluckingdate)) , upper(:gs_garden_snm), 'A',decode(GWTM_TYPE,'O','TRANSFEROUT',decode(SUP_TYPE,'OWN','OWNATTE','UNIT',decode(nvl(SUP_GROUPIND,'OTHER'),'OWN','TRANSFERIN','PURCHASE'),'PURCHASE')),initcap(FB_SUPPLIER.sup_name) 
union all
select to_char(case when b.rowno = 1 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 1),'yyyymm'))
            when b.rowno = 2 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 2),'yyyymm'))
            when b.rowno = 3 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 3),'yyyymm'))
            when b.rowno = 4 then last_day(to_date(((MTMB_YEAR  * 100) + 4),'yyyymm'))
            when b.rowno = 5 then last_day(to_date(((MTMB_YEAR  * 100) + 5),'yyyymm'))
            when b.rowno = 6 then last_day(to_date(((MTMB_YEAR  * 100) + 6),'yyyymm'))
            when b.rowno = 7 then last_day(to_date(((MTMB_YEAR  * 100) + 7),'yyyymm'))
            when b.rowno = 8 then last_day(to_date(((MTMB_YEAR  * 100) + 8),'yyyymm'))
            when b.rowno = 9 then last_day(to_date(((MTMB_YEAR  * 100) + 9),'yyyymm'))
            when b.rowno = 10 then last_day(to_date(((MTMB_YEAR  * 100) + 10),'yyyymm'))
            when b.rowno = 11 then last_day(to_date(((MTMB_YEAR  * 100) + 11),'yyyymm'))
            when b.rowno = 12 then last_day(to_date(((MTMB_YEAR  * 100) + 12),'yyyymm'))
       end,'dd/mm/yyyy') dt,upper(:gs_garden_snm),'P',rec_ty,'OWN' recdesc,0,
      SUM(case when b.rowno = 1 then nvl(jantm,0)
            when b.rowno = 2 then nvl(febtm,0)
            when b.rowno = 3 then nvl(martm,0)
            when b.rowno = 4 then nvl(aprtm,0)
            when b.rowno = 5 then nvl(maytm,0)
            when b.rowno = 6 then nvl(juntm,0)
            when b.rowno = 7 then nvl(jultm,0)
            when b.rowno = 8 then nvl(augtm,0)
            when b.rowno = 9 then nvl(septm,0)
            when b.rowno = 10 then nvl(octtm,0)
            when b.rowno = 11 then nvl(novtm,0)
            when b.rowno = 12 then nvl(dectm,0) end) tm, 0, :gs_user,to_char(sysdate,'dd/mm/yyyy')      
  from (select MTMB_YEAR,'OWNATTE' rec_ty, (nvl(MTMB_JANTEAMADEOWN,0) + nvl(MTMB_JANTMOWN_OF,0)) jantm, 
                              (nvl(MTMB_FEBTEAMADEOWN,0) + nvl(MTMB_FEBTMOWN_OF,0)) febtm, 
                              (nvl(MTMB_MARTEAMADEOWN,0) + nvl(MTMB_MARTMOWN_OF,0)) martm, 
                              (nvl(MTMB_APRTEAMADEOWN,0) + nvl(MTMB_APRTMOWN_OF,0)) aprtm, 
                              (nvl(MTMB_MAYTEAMADEOWN,0) + nvl(MTMB_MAYTMOWN_OF,0)) maytm, 
                              (nvl(MTMB_JUNTEAMADEOWN,0) + nvl(MTMB_JUNTMOWN_OF,0)) juntm, 
                              (nvl(MTMB_JULTEAMADEOWN,0) + nvl(MTMB_JULTMOWN_OF,0)) jultm, 
                              (nvl(MTMB_AUGTEAMADEOWN,0) + nvl(MTMB_AUGTMOWN_OF,0)) augtm, 
                              (nvl(MTMB_SEPTEAMADEOWN,0) + nvl(MTMB_SEPTMOWN_OF,0)) septm, 
                              (nvl(MTMB_OCTTEAMADEOWN,0) + nvl(MTMB_OCTTMOWN_OF,0)) octtm, 
                              (nvl(MTMB_NOVTEAMADEOWN,0) + nvl(MTMB_NOVTMOWN_OF,0)) novtm, 
                              (nvl(MTMB_DECTEAMADEOWN,0) + nvl(MTMB_DECTMOWN_OF,0)) dectm
                             from FB_MONTHLYTEAMADEBUDGET) a,
 (select rownum rowno from dual connect by level <= 12) b
group by case when b.rowno = 1 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 1),'yyyymm'))
            when b.rowno = 2 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 2),'yyyymm'))
            when b.rowno = 3 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 3),'yyyymm'))
            when b.rowno = 4 then last_day(to_date(((MTMB_YEAR  * 100) + 4),'yyyymm'))
            when b.rowno = 5 then last_day(to_date(((MTMB_YEAR  * 100) + 5),'yyyymm'))
            when b.rowno = 6 then last_day(to_date(((MTMB_YEAR  * 100) + 6),'yyyymm'))
            when b.rowno = 7 then last_day(to_date(((MTMB_YEAR  * 100) + 7),'yyyymm'))
            when b.rowno = 8 then last_day(to_date(((MTMB_YEAR  * 100) + 8),'yyyymm'))
            when b.rowno = 9 then last_day(to_date(((MTMB_YEAR  * 100) + 9),'yyyymm'))
            when b.rowno = 10 then last_day(to_date(((MTMB_YEAR  * 100) + 10),'yyyymm'))
            when b.rowno = 11 then last_day(to_date(((MTMB_YEAR  * 100) + 11),'yyyymm'))
            when b.rowno = 12 then last_day(to_date(((MTMB_YEAR  * 100) + 12),'yyyymm'))
       end ,'P'
union all       
select to_char(case when b.rowno = 1 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 1),'yyyymm'))
            when b.rowno = 2 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 2),'yyyymm'))
            when b.rowno = 3 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 3),'yyyymm'))
            when b.rowno = 4 then last_day(to_date(((MTMB_YEAR  * 100) + 4),'yyyymm'))
            when b.rowno = 5 then last_day(to_date(((MTMB_YEAR  * 100) + 5),'yyyymm'))
            when b.rowno = 6 then last_day(to_date(((MTMB_YEAR  * 100) + 6),'yyyymm'))
            when b.rowno = 7 then last_day(to_date(((MTMB_YEAR  * 100) + 7),'yyyymm'))
            when b.rowno = 8 then last_day(to_date(((MTMB_YEAR  * 100) + 8),'yyyymm'))
            when b.rowno = 9 then last_day(to_date(((MTMB_YEAR  * 100) + 9),'yyyymm'))
            when b.rowno = 10 then last_day(to_date(((MTMB_YEAR  * 100) + 10),'yyyymm'))
            when b.rowno = 11 then last_day(to_date(((MTMB_YEAR  * 100) + 11),'yyyymm'))
            when b.rowno = 12 then last_day(to_date(((MTMB_YEAR  * 100) + 12),'yyyymm'))
       end,'dd/mm/yyyy') dt,upper(:gs_garden_snm),'P',rec_ty,'Others' recdesc,0,
      SUM(case when b.rowno = 1 then nvl(jantm,0)
            when b.rowno = 2 then nvl(febtm,0)
            when b.rowno = 3 then nvl(martm,0)
            when b.rowno = 4 then nvl(aprtm,0)
            when b.rowno = 5 then nvl(maytm,0)
            when b.rowno = 6 then nvl(juntm,0)
            when b.rowno = 7 then nvl(jultm,0)
            when b.rowno = 8 then nvl(augtm,0)
            when b.rowno = 9 then nvl(septm,0)
            when b.rowno = 10 then nvl(octtm,0)
            when b.rowno = 11 then nvl(novtm,0)
            when b.rowno = 12 then nvl(dectm,0) end) tm, 0, :gs_user,to_char(sysdate,'dd/mm/yyyy')      
  from (select MTMB_YEAR,'PURCHASE' rec_ty, (nvl(MTMB_JANTEAMADEPUR,0) + nvl(MTMB_JANTMOF_OWN,0)) jantm, 
                              (nvl(MTMB_FEBTEAMADEPUR,0) + nvl(MTMB_FEBTMOF_OWN,0)) febtm, 
                              (nvl(MTMB_MARTEAMADEPUR,0) + nvl(MTMB_MARTMOF_OWN,0)) martm, 
                              (nvl(MTMB_APRTEAMADEPUR,0) + nvl(MTMB_APRTMOF_OWN,0)) aprtm, 
                              (nvl(MTMB_MAYTEAMADEPUR,0) + nvl(MTMB_MAYTMOF_OWN,0)) maytm, 
                              (nvl(MTMB_JUNTEAMADEPUR,0) + nvl(MTMB_JUNTMOF_OWN,0)) juntm, 
                              (nvl(MTMB_JULTEAMADEPUR,0) + nvl(MTMB_JULTMOF_OWN,0)) jultm, 
                              (nvl(MTMB_AUGTEAMADEPUR,0) + nvl(MTMB_AUGTMOF_OWN,0)) augtm, 
                              (nvl(MTMB_SEPTEAMADEPUR,0) + nvl(MTMB_SEPTMOF_OWN,0)) septm, 
                              (nvl(MTMB_OCTTEAMADEPUR,0) + nvl(MTMB_OCTTMOF_OWN,0)) octtm, 
                              (nvl(MTMB_NOVTEAMADEPUR,0) + nvl(MTMB_NOVTMOF_OWN,0)) novtm, 
                              (nvl(MTMB_DECTEAMADEPUR,0) + nvl(MTMB_DECTMOF_OWN,0)) dectm
                             from FB_MONTHLYTEAMADEBUDGET) a,
 (select rownum rowno from dual connect by level <= 12) b
group by case when b.rowno = 1 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 1),'yyyymm'))
            when b.rowno = 2 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 2),'yyyymm'))
            when b.rowno = 3 then last_day(to_date((((MTMB_YEAR + 1) * 100) + 3),'yyyymm'))
            when b.rowno = 4 then last_day(to_date(((MTMB_YEAR  * 100) + 4),'yyyymm'))
            when b.rowno = 5 then last_day(to_date(((MTMB_YEAR  * 100) + 5),'yyyymm'))
            when b.rowno = 6 then last_day(to_date(((MTMB_YEAR  * 100) + 6),'yyyymm'))
            when b.rowno = 7 then last_day(to_date(((MTMB_YEAR  * 100) + 7),'yyyymm'))
            when b.rowno = 8 then last_day(to_date(((MTMB_YEAR  * 100) + 8),'yyyymm'))
            when b.rowno = 9 then last_day(to_date(((MTMB_YEAR  * 100) + 9),'yyyymm'))
            when b.rowno = 10 then last_day(to_date(((MTMB_YEAR  * 100) + 10),'yyyymm'))
            when b.rowno = 11 then last_day(to_date(((MTMB_YEAR  * 100) + 11),'yyyymm'))
            when b.rowno = 12 then last_day(to_date(((MTMB_YEAR  * 100) + 12),'yyyymm'))
       end ,'P'
union all
select to_char(decode(sign(to_number(to_char(DTMP_SORTDATE,'dd'))-16),-1,to_date('15/'||to_char(DTMP_SORTDATE,'mm/yyyy'),'dd/mm/yyyy'),last_day(DTMP_SORTDATE)),'dd/mm/yyyy') , upper(:gs_garden_snm), 'A','SORT', TMP_Name,0,sum(nvl(DTMP_SORTQUANTODAYTY,0)) , 0, :gs_user,to_char(sysdate,'dd/mm/yyyy')
From fb_DAILYSORTEDTEAMADEPRODUCT a,fb_teamadeproduct b
where a.tmp_id = b.tmp_id(+) 
group by decode(sign(to_number(to_char(DTMP_SORTDATE,'dd'))-16),-1,to_date('15/'||to_char(DTMP_SORTDATE,'mm/yyyy'),'dd/mm/yyyy'),last_day(DTMP_SORTDATE)),TMP_Name
union all
select to_char(decode(sign(to_number(to_char(dtp.dtp_date,'dd'))-16),-1,to_date('15/'||to_char(dtp.dtp_date,'mm/yyyy'),'dd/mm/yyyy'),last_day(dtp.dtp_date)),'dd/mm/yyyy'), upper(:gs_garden_snm), 'A','PACK', TMP_Name,0,sum(( (nvl(dtpd.dtpd_srnoend,0) - nvl(dtpd.dtpd_srnostart,0)) + 1)  * nvl(dtpd.dtpd_indwt,0)) , 0, :gs_user,to_char(sysdate,'dd/mm/yyyy')
From fb_dailyteapacked dtp,fb_dtpdetails dtpd, fb_teamadeproductcategory tpc, fb_teamadeproduct tmp
where tpc.tpc_id = tmp.tpc_id  AND dtpd.tmp_id = tmp.tmp_id AND dtp.dtp_id = dtpd.dtp_id 
group by decode(sign(to_number(to_char(dtp.dtp_date,'dd'))-16),-1,to_date('15/'||to_char(dtp.dtp_date,'mm/yyyy'),'dd/mm/yyyy'),last_day(dtp.dtp_date)),TMP_Name
union all
select to_char(decode(sign(to_number(to_char(si.si_date,'dd'))-16),-1,to_date('15/'||to_char(si.si_date,'mm/yyyy'),'dd/mm/yyyy'),last_day(si.si_date)),'dd/mm/yyyy'), upper(:gs_garden_snm), 'A','DESPATCH', TMP_Name,0,sum(((nvl(SID.sid_srnoend,0) - nvl(SID.sid_srnostart,0)) + 1) * nvl(dtpd.dtpd_indwt,0)) , 0, :gs_user,to_char(sysdate,'dd/mm/yyyy')
From fb_saleinvoice si, fb_sidetails SID,fb_dtpdetails dtpd, fb_teamadeproductcategory tpc, fb_teamadeproduct tmp
where tpc.tpc_id = tmp.tpc_id AND dtpd.tmp_id = tmp.tmp_id AND SID.dtpd_id = dtpd.dtpd_id AND si.si_id = SID.si_id AND si.si_active = '1' and (((nvl(SID.sid_srnoend,0) - nvl(SID.sid_srnostart,0)) + 1) * nvl(dtpd.dtpd_indwt,0)) > 0 
group by decode(sign(to_number(to_char(si.si_date,'dd'))-16),-1,to_date('15/'||to_char(si.si_date,'mm/yyyy'),'dd/mm/yyyy'),last_day(si.si_date)),TMP_Name
order by 1; 
			
 open c1;
 if sqlca.sqlcode = -1 then
	messagebox('Sql Error During Opening Cursor !',sqlca.sqlerrtext)
	return 1
 elseif sqlca.sqlcode = 0 then
   fetch c1 into :ls_dt, :ls_gsn, :ls_ind, :ls_recind, :ls_desc, :ld_glqty, :ld_teamade, :ld_amt, :ls_entry_by, :ls_entry_dt;

	do while sqlca.sqlcode <> 100
		
		
		if isnull(ls_dt) then; ls_dt=""; end if;
		if isnull(ls_gsn) then; ls_gsn=""; end if;
		if isnull(ls_ind) then; ls_ind=""; end if;	
		if isnull(ls_recind) then; ls_recind=""; end if;		
   		if isnull(ls_desc) then; ls_desc =""; end if;
		if isnull(ld_glqty) then; ld_glqty = 0; end if;
		if isnull(ld_teamade) then; ld_teamade = 0; end if;
		if isnull(ld_amt) then; ld_amt = 0; end if;
		if isnull(ls_entry_by) then; ls_entry_by=""; end if;
		if isnull(ls_entry_dt) then; ls_entry_dt=""; end if;
		
		if pos(ls_desc,",") > 0 then; ls_desc = replace(ls_desc,pos(ls_desc,","),1," "); end if;
		
		if ls_dt="" then  ls_rec = "," else	ls_rec = ls_dt + ","
		ls_rec = ls_rec + ls_gsn +","+ls_ind+","+ls_recind+","+ls_desc+","+string(ld_glqty)+","+string(ld_teamade)+","+string(ld_amt)+","+ls_entry_by+","
		if ls_entry_dt = "" then ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_entry_dt 
		
		filewrite(li_filenum,ls_rec)
		
		li_rec++
		li_ctr++
		
		setnull(ls_rec);setnull(ls_dt);setnull(ls_gsn);setnull(ls_ind);setnull(ls_recind);setnull(ls_desc);setnull(ls_entry_by);setnull(ls_entry_dt);
		ld_glqty = 0; ld_teamade = 0; ld_amt = 0;
	
    fetch c1 into :ls_dt, :ls_gsn, :ls_ind, :ls_recind, :ls_desc, :ld_glqty, :ld_teamade, :ld_amt, :ls_entry_by, :ls_entry_dt;
   
   loop
	close c1;
else
	messagebox('Error: During Opening of Cursor',sqlca.sqlerrtext)
	return -1
end if

	fileclose(li_filenum) 

setpointer(arrow!) 
messagebox('Confirmation','Total No Of Records : '+string(li_ctr))
return 1

end event

type rb_113 from radiobutton within w_csvexport
integer x = 3186
integer y = 2260
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "MIS Expense"
end type

event clicked;string ls_rec,  ls_gsn, ls_ind, ls_eachd_id, ls_eachd_nm, ls_eacshd_id, ls_eacshd_nm, ls_entry_by, ls_entry_dt
double ld_sal, ld_wage, ld_store, ld_other
integer li_filenum, li_rec, li_ctr 
li_ctr=0;
setpointer(hourglass!) 

setnull(ls_rec);setnull(ls_dt);setnull(ls_gsn);setnull(ls_ind);setnull(ls_eachd_id);setnull(ls_eachd_nm);setnull(ls_eacshd_id);setnull(ls_eacshd_nm);setnull(ls_entry_by);setnull(ls_entry_dt);
ld_sal = 0; ld_wage = 0; ld_store = 0; ld_other=0;

If not DirectoryExists ("c:\temp") Then
	CreateDirectory ("c:\temp")
End If

if fileexists("c:\temp\misexpense.csv") = true then
	filedelete("c:\temp\misexpense.csv")
end if

li_filenum =  fileopen("c:\temp\misexpense.csv",linemode!,write!,lockreadwrite!,replace!)
//select 'SH', to_char(SI_DATE,'dd/mm/yyyy'),SI_CN,to_char(SI_CNDATE,'dd/mm/yyyy'),
// 		 decode(SI_TYPE,'AUCTION','AUC','PRICONS','CON','PRILOCAL','LOC','TRANSFREE','TFR','TRANSPRI','TPR',null),
//		 decode(SI_TYPE,'AUCTION',b.CITY_ID,'PRICONS',c.CITY_ID,null) destination,
//		 TRANSP_ID,a.WARE_ID,a.CUS_ID,substr(ADVICE_ID,1,16),SI_DESC,SI_INSURANCEVALUE,BROK_ID,SI_EXCISEDUTY,SI_CESS,SI_EDUCATIONALCESS,
//		 SI_CENTRALEXCISENO,SI_ID,SI_HSECESS,:gs_garden_snm,:gs_unit,SI_WAYBILLNO
//from fb_saleinvoice a, (select WARE_ID, CITY_ID from fb_warehouse) b, (select CUS_ID, CITY_ID from fb_customer) c
//where a.WARE_ID = b.WARE_ID(+) and a.CUS_ID = c.CUS_ID(+) and SI_ROSEND_DT is null order by 2;

DECLARE c1 CURSOR FOR
select to_char(DE_DATE,'dd/mm/yyyy') DE_DATE,upper(:gs_garden_snm),IND,EACHEAD_ID,ACSUBLEDGER_NAME,c.EACSUBHEAD_ID, EACSUBHEAD_NAME,sum(DE_SALARYTODAYTY),sum(DE_WAGESTODAYTY),sum(DE_STORESTODAYTY),sum(DE_OTHERSTODAYTY),:gs_user,to_char(sysdate,'dd/mm/yyyy')
from (SELECT decode(sign(to_number(to_char(DE_DATE,'dd'))-16),-1,to_date('15/'||to_char(DE_DATE,'mm/yyyy'),'dd/mm/yyyy'),last_day(DE_DATE)) DE_DATE,'A' IND,b.EACSUBHEAD_ID, 
            SUM(NVL(DE_SALARYTODAYTY,0)) DE_SALARYTODAYTY, 
            SUM(NVL(DE_WAGESTODAYTY,0)) DE_WAGESTODAYTY,  SUM(NVL(DE_STORESTODAYTY,0)) DE_STORESTODAYTY, 
            SUM(NVL(DE_OTHERSTODAYTY,0)) DE_OTHERSTODAYTY
        FROM  FB_ACSUBLEDGER a, FB_ACLEDGER c, FB_EXPENSEACSUBHEAD d,fb_dailyexpense b
        where  a.ACLEDGER_ID=c.ACLEDGER_ID AND a.ACSUBLEDGER_ID=d.EACHEAD_ID and d.EACSUBHEAD_ID = b.EACSUBHEAD_ID and c.ACLEDGER_LEDGERTYPE = 'REVENUEEXPENDITURE'
      GROUP BY decode(sign(to_number(to_char(DE_DATE,'dd'))-16),-1,to_date('15/'||to_char(DE_DATE,'mm/yyyy'),'dd/mm/yyyy'),last_day(DE_DATE))  , 'A',b.EACSUBHEAD_ID
      UNION 
select case when b.rowno = 1 then last_day(to_date((((MOB_YEAR + 1) * 100) + 1),'yyyymm'))
            when b.rowno = 2 then last_day(to_date((((MOB_YEAR + 1) * 100) + 2),'yyyymm'))
            when b.rowno = 3 then last_day(to_date((((MOB_YEAR + 1) * 100) + 3),'yyyymm'))
            when b.rowno = 4 then last_day(to_date(((MOB_YEAR  * 100) + 4),'yyyymm'))
            when b.rowno = 5 then last_day(to_date(((MOB_YEAR  * 100) + 5),'yyyymm'))
            when b.rowno = 6 then last_day(to_date(((MOB_YEAR  * 100) + 6),'yyyymm'))
            when b.rowno = 7 then last_day(to_date(((MOB_YEAR  * 100) + 7),'yyyymm'))
            when b.rowno = 8 then last_day(to_date(((MOB_YEAR  * 100) + 8),'yyyymm'))
            when b.rowno = 9 then last_day(to_date(((MOB_YEAR  * 100) + 9),'yyyymm'))
            when b.rowno = 10 then last_day(to_date(((MOB_YEAR  * 100) + 10),'yyyymm'))
            when b.rowno = 11 then last_day(to_date(((MOB_YEAR  * 100) + 11),'yyyymm'))
            when b.rowno = 12 then last_day(to_date(((MOB_YEAR  * 100) + 12),'yyyymm'))
       end dt,'P',
       EACSUBHEAD_ID,
      SUM(case when b.rowno = 1 then decode(ind,'S',MOB_JANPRICE,0)
            when b.rowno = 2 then decode(ind,'S',MOB_FEBPRICE,0)
            when b.rowno = 3 then decode(ind,'S',MOB_MARPRICE,0)
            when b.rowno = 4 then decode(ind,'S',MOB_APRPRICE,0)
            when b.rowno = 5 then decode(ind,'S',MOB_MAYPRICE,0)
            when b.rowno = 6 then decode(ind,'S',MOB_JUNPRICE,0)
            when b.rowno = 7 then decode(ind,'S',MOB_JULPRICE,0)
            when b.rowno = 8 then decode(ind,'S',MOB_AUGPRICE,0)
            when b.rowno = 9 then decode(ind,'S',MOB_SEPPRICE,0)
            when b.rowno = 10 then decode(ind,'S',MOB_OCTPRICE,0)
            when b.rowno = 11 then decode(ind,'S',MOB_NOVPRICE,0)
            when b.rowno = 12 then decode(ind,'S',MOB_DECPRICE,0) end) sal,
       SUM(case when b.rowno = 1 then decode(ind,'W',MOB_JANPRICE,0)
            when b.rowno = 2 then decode(ind,'W',MOB_FEBPRICE,0)
            when b.rowno = 3 then decode(ind,'W',MOB_MARPRICE,0)
            when b.rowno = 4 then decode(ind,'W',MOB_APRPRICE,0)
            when b.rowno = 5 then decode(ind,'W',MOB_MAYPRICE,0)
            when b.rowno = 6 then decode(ind,'W',MOB_JUNPRICE,0)
            when b.rowno = 7 then decode(ind,'W',MOB_JULPRICE,0)
            when b.rowno = 8 then decode(ind,'W',MOB_AUGPRICE,0)
            when b.rowno = 9 then decode(ind,'W',MOB_SEPPRICE,0)
            when b.rowno = 10 then decode(ind,'W',MOB_OCTPRICE,0)
            when b.rowno = 11 then decode(ind,'W',MOB_NOVPRICE,0)
            when b.rowno = 12 then decode(ind,'W',MOB_DECPRICE,0) end) wage,     
       SUM(case when b.rowno = 1 then decode(ind,'T',MOB_JANPRICE,0)
            when b.rowno = 2 then decode(ind,'T',MOB_FEBPRICE,0)
            when b.rowno = 3 then decode(ind,'T',MOB_MARPRICE,0)
            when b.rowno = 4 then decode(ind,'T',MOB_APRPRICE,0)
            when b.rowno = 5 then decode(ind,'T',MOB_MAYPRICE,0)
            when b.rowno = 6 then decode(ind,'T',MOB_JUNPRICE,0)
            when b.rowno = 7 then decode(ind,'T',MOB_JULPRICE,0)
            when b.rowno = 8 then decode(ind,'T',MOB_AUGPRICE,0)
            when b.rowno = 9 then decode(ind,'T',MOB_SEPPRICE,0)
            when b.rowno = 10 then decode(ind,'T',MOB_OCTPRICE,0)
            when b.rowno = 11 then decode(ind,'T',MOB_NOVPRICE,0)
            when b.rowno = 12 then decode(ind,'T',MOB_DECPRICE,0) end) stre,
       SUM(case when b.rowno = 1 then decode(ind,'O',MOB_JANPRICE,0)
            when b.rowno = 2 then decode(ind,'O',MOB_FEBPRICE,0)
            when b.rowno = 3 then decode(ind,'O',MOB_MARPRICE,0)
            when b.rowno = 4 then decode(ind,'O',MOB_APRPRICE,0)
            when b.rowno = 5 then decode(ind,'O',MOB_MAYPRICE,0)
            when b.rowno = 6 then decode(ind,'O',MOB_JUNPRICE,0)
            when b.rowno = 7 then decode(ind,'O',MOB_JULPRICE,0)
            when b.rowno = 8 then decode(ind,'O',MOB_AUGPRICE,0)
            when b.rowno = 9 then decode(ind,'O',MOB_SEPPRICE,0)
            when b.rowno = 10 then decode(ind,'O',MOB_OCTPRICE,0)
            when b.rowno = 11 then decode(ind,'O',MOB_NOVPRICE,0)
            when b.rowno = 12 then decode(ind,'O',MOB_DECPRICE,0) end) OTH      
  from (select MOB_YEAR,'O' ind, EACSUBHEAD_ID, MOB_JANPRICE, MOB_FEBPRICE, MOB_MARPRICE, MOB_APRPRICE, MOB_MAYPRICE, MOB_JUNPRICE, MOB_JULPRICE,
             MOB_AUGPRICE, MOB_SEPPRICE, MOB_OCTPRICE, MOB_NOVPRICE, MOB_DECPRICE from fb_monthlyothersbudget union all
        select MWB_YEAR,'W', EACSUBHEAD_ID,(nvl(MWB_JANRATE,0) * nvl(MWB_JANMANDAYS,0)) jan,
               (nvl(MWB_FEBRATE,0) * nvl(MWB_FEBMANDAYS,0)), (nvl(MWB_MARRATE,0) * nvl(MWB_MARMANDAYS,0)),
                (nvl(MWB_APRRATE,0) * nvl(MWB_APRMANDAYS,0)),(nvl(MWB_MAYRATE,0) * nvl(MWB_MAYMANDAYS,0)),
                (nvl(MWB_JUNRATE,0) * nvl(MWB_JUNMANDAYS,0)),(nvl(MWB_JULRATE,0) * nvl(MWB_JULMANDAYS,0)),
                (nvl(MWB_AUGRATE,0) * nvl(MWB_AUGMANDAYS,0)),(nvl(MWB_SEPRATE,0) * nvl(MWB_SEPMANDAYS,0)),
                (nvl(MWB_OCTRATE,0) * nvl(MWB_OCTMANDAYS,0)),(nvl(MWB_NOVRATE,0) * nvl(MWB_NOVMANDAYS,0)),
                (nvl(MWB_DECRATE,0) * nvl(MWB_DECMANDAYS,0)) from FB_MONTHLYWAGESBUDGET  union all
        select MSB_YEAR,'T', EACSUBHEAD_ID, MSB_JANPRICE, MSB_FEBPRICE, MSB_MARPRICE, MSB_APRPRICE, MSB_MAYPRICE, MSB_JUNPRICE, MSB_JULPRICE, MSB_AUGPRICE, MSB_SEPPRICE, MSB_OCTPRICE, MSB_NOVPRICE, MSB_DECPRICE from FB_MONTHLYSTOREBUDGET union all
        select MSAB_YEAR,'S', EACSUBHEAD_ID, MSAB_JANSALARY, MSAB_FEBSALARY, MSAB_MARSALARY, MSAB_APRSALARY, MSAB_MAYSALARY, MSAB_JUNSALARY, MSAB_JULSALARY, MSAB_AUGSALARY, MSAB_SEPSALARY, MSAB_OCTSALARY, MSAB_NOVSALARY, MSAB_DECSALARY from fb_monthlysalarybudget) a,
 (select rownum rowno from dual connect by level <= 12) b
group by case when b.rowno = 1 then last_day(to_date((((MOB_YEAR + 1) * 100) + 1),'yyyymm'))
            when b.rowno = 2 then last_day(to_date((((MOB_YEAR + 1) * 100) + 2),'yyyymm'))
            when b.rowno = 3 then last_day(to_date((((MOB_YEAR + 1) * 100) + 3),'yyyymm'))
            when b.rowno = 4 then last_day(to_date(((MOB_YEAR  * 100) + 4),'yyyymm'))
            when b.rowno = 5 then last_day(to_date(((MOB_YEAR  * 100) + 5),'yyyymm'))
            when b.rowno = 6 then last_day(to_date(((MOB_YEAR  * 100) + 6),'yyyymm'))
            when b.rowno = 7 then last_day(to_date(((MOB_YEAR  * 100) + 7),'yyyymm'))
            when b.rowno = 8 then last_day(to_date(((MOB_YEAR  * 100) + 8),'yyyymm'))
            when b.rowno = 9 then last_day(to_date(((MOB_YEAR  * 100) + 9),'yyyymm'))
            when b.rowno = 10 then last_day(to_date(((MOB_YEAR  * 100) + 10),'yyyymm'))
            when b.rowno = 11 then last_day(to_date(((MOB_YEAR  * 100) + 11),'yyyymm'))
            when b.rowno = 12 then last_day(to_date(((MOB_YEAR  * 100) + 12),'yyyymm'))
       end ,'P',
       EACSUBHEAD_ID) a,fb_acsubledger b,FB_EXPENSEACSUBHEAD c
where a.EACSUBHEAD_ID = c.EACSUBHEAD_ID and EACHEAD_ID = b.ACSUBLEDGER_ID
group by DE_DATE,upper(:gs_garden_snm),IND,EACHEAD_ID,ACSUBLEDGER_NAME,c.EACSUBHEAD_ID, EACSUBHEAD_NAME
order by 1; 
			
 open c1;
 if sqlca.sqlcode = -1 then 
	messagebox('Sql Error During Opening Cursor !',sqlca.sqlerrtext)
	return 1
 elseif sqlca.sqlcode = 0 then
   fetch c1 into :ls_dt, :ls_gsn, :ls_ind, :ls_eachd_id, :ls_eachd_nm, :ls_eacshd_id, :ls_eacshd_nm, :ld_sal, :ld_wage, :ld_store, :ld_other, :ls_entry_by, :ls_entry_dt;

	do while sqlca.sqlcode <> 100
		
		
		if isnull(ls_dt) then; ls_dt=""; end if;
		if isnull(ls_gsn) then; ls_gsn=""; end if;
		if isnull(ls_ind) then; ls_ind=""; end if;		
   		if isnull(ls_eachd_id) then; ls_eachd_id =""; end if;
   		if isnull(ls_eachd_nm) then; ls_eachd_nm=""; end if;
		if isnull(ls_eacshd_id) then; ls_eacshd_id=""; end if;
		if isnull(ls_eacshd_nm) then; ls_eacshd_nm=""; end if;
		if isnull(ld_sal) then; ld_sal = 0; end if;
		if isnull(ld_wage) then; ld_wage = 0; end if;
		if isnull(ld_store) then; ld_store = 0; end if;
		if isnull(ld_other) then; ld_other = 0; end if;
		if isnull(ls_entry_by) then; ls_entry_by=""; end if;
		if isnull(ls_entry_dt) then; ls_entry_dt=""; end if;
		
		if pos(ls_eachd_nm,",") > 0 then; ls_eachd_nm = replace(ls_eachd_nm,pos(ls_eachd_nm,","),1," "); end if;
		if pos(ls_eacshd_nm,",") > 0 then; ls_eacshd_nm = replace(ls_eacshd_nm,pos(ls_eacshd_nm,","),1," "); end if;

		
		if ls_dt="" then  ls_rec = "," else	ls_rec = ls_dt + ","
		ls_rec = ls_rec + ls_gsn +","+ls_ind+","+ls_eachd_id+","+ls_eachd_nm+","+ls_eacshd_id+","+ls_eacshd_nm+","+string(ld_sal)+","+string(ld_wage)+","+string(ld_store)+","+string(ld_other)+","+ls_entry_by+","
		if ls_entry_dt = "" then ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_entry_dt 
		
		filewrite(li_filenum,ls_rec)
		
		li_rec++
		li_ctr++
		
				setnull(ls_rec);setnull(ls_dt);setnull(ls_gsn);setnull(ls_ind);setnull(ls_eachd_id);setnull(ls_eachd_nm);setnull(ls_eacshd_id);setnull(ls_eacshd_nm);setnull(ls_entry_by);setnull(ls_entry_dt);
				ld_sal = 0; ld_wage = 0; ld_store = 0; ld_other=0;
	
   fetch c1 into :ls_dt, :ls_gsn, :ls_ind, :ls_eachd_id, :ls_eachd_nm, :ls_eacshd_id, :ls_eacshd_nm, :ld_sal, :ld_wage, :ld_store, :ld_other, :ls_entry_by, :ls_entry_dt;
   
   loop
	close c1;
else
	messagebox('Error: During Opening of Cursor',sqlca.sqlerrtext)
	return -1
end if

	fileclose(li_filenum) 

setpointer(arrow!) 
messagebox('Confirmation','Total No Of Records : '+string(li_ctr))
return 1

end event

type rb_112 from radiobutton within w_csvexport
integer x = 69
integer y = 1968
integer width = 713
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Summarise Attendance"
end type

event clicked;ls_sql =   "select es_year, es_month, es_empid, es_division, es_hajari, es_present, es_absent, es_casual, es_sick, es_earn, es_suspend, es_maternity, es_weekoff, es_holiday, es_entry_by, to_char(es_entry_dt,'dd/mm/yyyy hh24:mi:ss') from fb_empattendance_summary where ES_ROSEND_DT is null"

if wf_csv(ls_sql,'empattendance') =-1 then
	return
end if

update fb_empattendance_summary set ES_ROSEND_DT = sysdate where  ES_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating summarise empattendance Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	






end event

type rb_111 from radiobutton within w_csvexport
integer x = 3611
integer y = 1596
integer width = 530
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Weekely Advance"
end type

event clicked;ls_sql =  "select LWAW_ID, LABOUR_ID, LWAW_WORKDAYS, LWAW_ADVANCE, LS_ID, FIELD_ID, LWAW_EMPTYPE, LWAW_ENTRY_BY, to_char(LWAW_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_labourweeklyadvance where lwaw_rosend_dt is null"
if wf_csv(ls_sql,'labourweeklyadvance') =-1 then
	return
end if

update fb_labourweeklyadvance set fd_rosend_dt = sysdate where  lwaw_rosend_dt is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating labourweeklyadvance Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_110 from radiobutton within w_csvexport
integer x = 3159
integer y = 1596
integer width = 398
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Disciplinary"
end type

event clicked;ls_sql =  "select FD_ID, to_char(FD_DATE,'dd/mm/yyyy hh24:mi:ss'), FD_TYPE, to_char(FD_PERIOD_FR,'dd/mm/yyyy hh24:mi:ss'), to_char(FD_PERIOD_TO,'dd/mm/yyyy hh24:mi:ss'), FD_DESC, FD_LABOUR_ID, FD_ENTRY_BY, to_char(FD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss'), to_char(FD_PRINT_DT,'dd/mm/yyyy hh24:mi:ss'), FD_ABSDAYS, FD_ABSDATES from FB_DISCIPLINARY where fd_rosend_dt is null"
if wf_csv(ls_sql,'disciplinary') =-1 then
	return
end if

update FB_DISCIPLINARY set fd_rosend_dt = sysdate where  fd_rosend_dt is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Disciplinary Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_109 from radiobutton within w_csvexport
integer x = 2661
integer y = 1596
integer width = 480
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Process Ration"
end type

event clicked;ls_sql =  "select LRW_ID, LABOUR_ID, LWR_RICEWT, LWR_ATTAWT, LWR_RATIONDED, LWR_NOMIN, LWR_NOMAJ, LWR_WORKDAYS, LWR_ELP, LWR_COINBF, LWR_LASTCOINBF, LS_ID, LWR_GL, LWR_TASKGL, LWR_NETELP, FIELD_ID, LWR_EMPTYPE, LWR_PENALTY from fb_labourweeklyration where LWR_ROSEND_DT is null"
if wf_csv(ls_sql,'KEROSINISSUE') =-1 then
	return
end if

update fb_labourweeklyration set LWR_ROSEND_DT = sysdate where  LWR_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Ration Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_108 from radiobutton within w_csvexport
integer x = 2309
integer y = 1596
integer width = 329
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Overtime"
end type

event clicked;ls_sql =  "select OT_EMP_ID, to_char(OT_DT,'dd/mm/yyyy hh24:mi:ss'), OT_HOURS, OT_REMARK, OT_KAMSUB_ID, OT_RATE, OT_AMOUNT, OT_MES_IND, OT_LAB_HR_IND, OT_ENTRY_BY, to_char(OT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_overtime where OT_ROSEND_DT is null"
if wf_csv(ls_sql,'KEROSINISSUE') =-1 then
	return
end if

update fb_overtime set OT_ROSEND_DT = sysdate where  OT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Overtime Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_107 from radiobutton within w_csvexport
integer x = 1998
integer y = 1596
integer width = 288
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Kerosin"
end type

event clicked;ls_sql =  "select EMP_ID, to_char(KI_DATE,'dd/mm/yyyy hh24:mi:ss'), KI_QUANTITY, KI_ENTRY_BY, to_char(KI_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss'), FIELD_ID, KI_RATE from FB_KEROSINISSUE where KI_ROSEND_DT is null"
if wf_csv(ls_sql,'KEROSINISSUE') =-1 then
	return
end if

update FB_KEROSINISSUE set KI_ROSEND_DT = sysdate where  KI_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Kerosin Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_106 from radiobutton within w_csvexport
integer x = 1349
integer y = 1596
integer width = 663
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Wage Advance Week"
end type

event clicked;ls_sql =  "select LWAW_ID, to_char(LWAW_STARTDATE,'dd/mm/yyyy hh24:mi:ss'), to_char(LWAW_ENDDATE,'dd/mm/yyyy hh24:mi:ss'), LWAW_CALFLAG, LWAW_PAIDFLAG, LWW_ID, LWAW_ENTRY_BY, to_char(LWAW_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_labourwagadvweek"
if wf_csv(ls_sql,'labourwagadvweek') =-1 then
	return
end if
end event

type rb_105 from radiobutton within w_csvexport
integer x = 722
integer y = 1596
integer width = 617
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Attendance Incentive"
end type

event clicked;ls_sql =  "select AI_LABOURTYPE, to_char(AI_FROMDT,'dd/mm/yyyy hh24:mi:ss'), to_char(AI_TODT,'dd/mm/yyyy hh24:mi:ss'), AI_RATERANGE, AI_RATEADULT, AI_RATEADOLE, AI_MINDAYS, AI_SICKWITHWAGES, AI_HOLIDAY, AI_MATERNITY, AI_LEAVEWITHWAGES, AI_PFELIGIBLE, AI_BONEUSELIGIBLE, AI_LWWELIGIBLE, AI_ENTRY_BY, to_char(AI_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_attendanceincentive"
if wf_csv(ls_sql,'attendanceincentive') =-1 then
	return
end if
end event

type rb_80 from radiobutton within w_csvexport
integer x = 421
integer y = 1596
integer width = 311
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Exempt"
end type

event clicked;ls_sql =  "select EM_LSID, to_char(EM_FROMDT,'dd/mm/yyyy hh24:mi:ss'), to_char(EM_TODT,'dd/mm/yyyy hh24:mi:ss'), EM_PFIND, EM_LWWIND, EM_BONUSIND, EM_ENTRY_BY, to_char(EM_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_exemptmaster"
if wf_csv(ls_sql,'exemptmaster') =-1 then
	return
end if
end event

type rb_70 from radiobutton within w_csvexport
integer x = 69
integer y = 1596
integer width = 361
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Maternity"
end type

event clicked;ls_sql =  "select MT_EMPID, to_char(MT_FROMDT,'dd/mm/yyyy hh24:mi:ss'), to_char(MT_TODT,'dd/mm/yyyy hh24:mi:ss'), MT_ENTRY_BY, to_char(MT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_maternity"
if wf_csv(ls_sql,'maternity') =-1 then
	return
end if
end event

type rb_46 from radiobutton within w_csvexport
integer x = 3017
integer y = 1512
integer width = 398
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Pro-Rata"
end type

event clicked;ls_sql =  "select to_char(PH_DATE,'dd/mm/yyyy hh24:mi:ss'), PH_DESC, PH_HOURS, PH_ENTRY_BY, to_char(PH_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PH_ENTRY_DT from fb_prorata_hours"
if wf_csv(ls_sql,'incentive') =-1 then
	return
end if
end event

type rb_33 from radiobutton within w_csvexport
integer x = 480
integer y = 700
integer width = 421
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Requisition"
end type

event clicked;ls_sql ="select PR_ID, to_char(PR_DATE,'dd/mm/yyyy hh24:mi:ss') PR_DATE, PR_DIVISION, to_char(PR_REQDATE,'dd/mm/yyyy hh24:mi:ss') PR_REQDATE, PR_ENTRY_BY, to_char(PR_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PR_ENTRY_DT from fb_product_requ where PR_ROSEND_DT is null"
if wf_csv(ls_sql,'productrequ') =-1 then
	return
end if

ls_sql = "select b.PR_ID, SP_ID, PR_EACSUBHEAD_ID, PR_REQQUANTITY, PR_VALUE, PR_ECC_ID, PR_SECTION_ID, PR_AVL_STOCK from fb_product_requ_det a, fb_product_requ b where PR_ROSEND_DT is null"
if wf_csv(ls_sql,'productrequdet') =-1 then
	return
end if

update fb_product_requ set PR_ROSEND_DT = sysdate where  PR_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Indent Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_45 from radiobutton within w_csvexport
integer x = 3648
integer y = 164
integer width = 571
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Made Tea Transfer"
end type

event clicked;ls_sql =  "select to_char(PT_DATE,'dd/mm/yyyy hh24:mi:ss') PT_DATE, PT_TRANTYPE, PT_UNIT_FROM, PT_UNIT_TO, PT_STATUS, TPC_ID, TMP_ID, PT_QUANTITY, PT_PRICE, PT_ENTRY_BY, to_char(PT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PT_ENTRY_DT from fb_packteatransfer where PT_ROSEND_DT is null"
if wf_csv(ls_sql,'packteatransfer') =-1 then
	return
end if

update fb_packteatransfer set PT_ROSEND_DT = sysdate where  PT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating reprocess_tea Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type cb_4 from commandbutton within w_csvexport
integer x = 4256
integer y = 2124
integer width = 297
integer height = 96
integer taborder = 40
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
string text = "&Close"
end type

event clicked;IF MessageBox("Exit Alert", 'Do You Want To Exit....?' ,Exclamation!, YesNo!, 1) = 1 THEN
	close(parent)
else
	return
end if

end event

type rb_104 from radiobutton within w_csvexport
boolean visible = false
integer x = 2107
integer y = 2460
integer width = 407
integer height = 72
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "Sales Invoice"
boolean automatic = false
end type

event clicked;string ls_rec_ty, ls_sidate, ls_sicn, ls_sicndt, ls_type, ls_tranid, ls_wareid, ls_custid,ls_advid, ls_sidesc, ls_brokid, ls_siid,ls_rec, ls_gsn, ls_mfg_frdt, ls_mfg_todt, ls_pack_dt
string ls_lotno,ls_tmpid, ls_unitid,ls_CEXCISENO,ls_waybill, LS_SOURCE, ls_transp_name,ls_sale_for
double ld_insval, ld_exciseduty, ld_sicess, ld_sieducess,ld_hecess
long ll_stno,ll_endno, ll_season
double ld_chestwt, ld_indwt,ld_tcs_per, ld_tcs_amt
double ld_CGST_PER, ld_CGST_AMT, ld_SGST_PER, ld_SGST_AMT, ld_IGST_PER, ld_IGST_AMT, ld_RATE
string ls_ISS_LOCN, ls_REC_LOCN, ls_PONO, ls_PODT, ls_DCNO, ls_DCDT, ls_PROMPTDT, ls_SUPPLY_DT, ls_SUPPLY_PLACE, ls_TAXINVNO, ls_DELVCHNO, ls_SHIP_TO_ADD, ls_REV_CHRG
integer li_filenum, li_rec, li_ctr 
li_ctr=0;
setpointer(hourglass!) 

setnull(ls_rec_ty);setnull(ls_sidate);setnull(ls_sicn);setnull(ls_sicndt);setnull(ls_type);setnull(ls_destination);setnull(ls_tranid);setnull(ls_wareid);setnull(ls_custid);
setnull(ls_advid);setnull(ls_sidesc);setnull(ls_brokid);setnull(ls_siid);setnull(ls_CEXCISENO); setnull(ls_mfg_frdt); setnull(ls_mfg_todt);  setnull(ls_pack_dt); setnull(ls_transp_name);setnull(ls_sale_for);
setnull(ls_ISS_LOCN); setnull(ls_REC_LOCN); setnull(ls_PONO); setnull(ls_PODT); setnull(ls_DCNO); setnull(ls_DCDT); setnull(ls_PROMPTDT); setnull(ls_SUPPLY_DT); setnull(ls_SUPPLY_PLACE);setnull(ls_TAXINVNO); setnull(ls_DELVCHNO); setnull(ls_SHIP_TO_ADD); setnull(ls_REV_CHRG);
ld_insval = 0; ld_exciseduty = 0; ld_sicess = 0; ld_sieducess = 0; ld_hecess=0; setnull(ls_gsn); setnull(ls_unitid);setnull(ls_waybill);
ld_CGST_PER = 0; ld_CGST_AMT = 0; ld_SGST_PER = 0; ld_SGST_AMT = 0; ld_IGST_PER = 0; ld_IGST_AMT = 0; ld_RATE = 0; ld_tcs_per = 0; ld_tcs_amt = 0;

If not DirectoryExists ("c:\temp") Then
	CreateDirectory ("c:\temp")
End If


if fileexists("c:\temp\"+gs_garden_snm+"_saleinvoice"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv") = true then
	filedelete("c:\temp\"+gs_garden_snm+"_saleinvoice"+string(today(),"-ddmmyy_")+string(now(),"hhmmss")+".csv")
end if

ls_file = "c:\temp\"+gs_garden_snm+"_saleinvoice"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv"

//li_filenum =  fileopen("c:\temp\saleinvoice"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".csv",linemode!,write!,lockreadwrite!,replace!)
li_filenum =  fileopen(ls_file,linemode!,write!,lockreadwrite!,replace!)
//select 'SH', to_char(SI_DATE,'dd/mm/yyyy'),SI_CN,to_char(SI_CNDATE,'dd/mm/yyyy'),
// 		 decode(SI_TYPE,'AUCTION','AUC','PRICONS','CON','PRILOCAL','LOC','TRANSFREE','TFR','TRANSPRI','TPR',null),
//		 decode(SI_TYPE,'AUCTION',b.CITY_ID,'PRICONS',c.CITY_ID,null) destination,
//		 TRANSP_ID,a.WARE_ID,a.CUS_ID,substr(ADVICE_ID,1,16),SI_DESC,SI_INSURANCEVALUE,BROK_ID,SI_EXCISEDUTY,SI_CESS,SI_EDUCATIONALCESS,
//		 SI_CENTRALEXCISENO,SI_ID,SI_HSECESS,:gs_garden_snm,:gs_unit,SI_WAYBILLNO
//from fb_saleinvoice a, (select WARE_ID, CITY_ID from fb_warehouse) b, (select CUS_ID, CITY_ID from fb_customer) c
//where a.WARE_ID = b.WARE_ID(+) and a.CUS_ID = c.CUS_ID(+) and SI_ROSEND_DT is null order by 2;

DECLARE c1 CURSOR FOR
select distinct 'SH', min(to_char(SI_DATE,'dd/mm/yyyy')),SI_CN,min(to_char(SI_CNDATE,'dd/mm/yyyy')),
          decode(SI_TYPE,'AUCTION','AUC','PRICONS','CON','PRILOCAL','LOC','TRANSFREE','TFR','TRANSPRI','TPR','TRANSBROK','SMP','EXP','EXP','SEZ','SEZ',null),
         decode(SI_TYPE,'AUCTION',b.CITY_ID,'PRICONS',c.CITY_ID,'EXP',c.CITY_ID,'SEZ',c.CITY_ID,null) destination,
         a.TRANSP_ID,a.WARE_ID,a.CUS_ID,min(substr(ADVICE_ID,1,16)),min(SI_DESC),sum(nvl(SI_INSURANCEVALUE,0)) SI_INSURANCEVALUE,min(BROK_ID),
         sum(nvl(SI_EXCISEDUTY,0)) SI_EXCISEDUTY, sum(nvl(SI_CESS,0)) SI_CESS,sum(nvl(SI_EDUCATIONALCESS,0)) SI_EDUCATIONALCESS, 
         min(SI_CENTRALEXCISENO) SI_CENTRALEXCISENO,min(SI_ID) SI_ID,sum(nvl(SI_HSECESS,0)) SI_HSECESS,:gs_garden_snm,:gs_unit,SI_WAYBILLNO,
        SI_ISS_LOCN, SI_REC_LOCN, SI_PONO, min(to_char(SI_PODT,'dd/mm/yyyy')), SI_DCNO, min(to_char(SI_DCDT,'dd/mm/yyyy')), min(to_char(SI_PROMPTDT,'dd/mm/yyyy')), 
        min(to_char(SI_SUPPLY_DT,'dd/mm/yyyy')), SI_SUPPLY_PLACE, SI_TAXINVNO, SI_DELVCHNO, SI_SHIP_TO_ADD, SI_REV_CHRG,SI_TCS_PER, SI_TCS_AMT, replace(TRANSP_NAME,',',' '),nvl(SI_SALE_FOR,'') SI_SALE_FOR
from fb_saleinvoice a, (select WARE_ID, CITY_ID from fb_warehouse) b, (select CUS_ID, CITY_ID from fb_customer) c, fb_transport d
where a.WARE_ID = b.WARE_ID(+) and a.CUS_ID = c.CUS_ID(+) and a.transp_id = d.transp_id(+) and SI_ROSEND_DT is null  and (SI_CN is not null and SI_CN <> '0') and SI_TYPE <> 'TRANSFREE'
group by SI_CN,decode(SI_TYPE,'AUCTION','AUC','PRICONS','CON','PRILOCAL','LOC','TRANSFREE','TFR','TRANSPRI','TPR','TRANSBROK','SMP','EXP','EXP','SEZ','SEZ',null),
             decode(SI_TYPE,'AUCTION',b.CITY_ID,'PRICONS',c.CITY_ID,'EXP',c.CITY_ID,'SEZ',c.CITY_ID,null),a.TRANSP_ID,a.WARE_ID,a.CUS_ID,SI_WAYBILLNO,
            SI_ISS_LOCN, SI_REC_LOCN, SI_PONO,  SI_DCNO, SI_SUPPLY_PLACE, SI_TAXINVNO, SI_DELVCHNO, SI_SHIP_TO_ADD, SI_REV_CHRG,SI_TCS_PER, SI_TCS_AMT, TRANSP_NAME,SI_SALE_FOR
order by 2; 
			
 open c1;
 if sqlca.sqlcode = -1 then
	messagebox('Sql Error During Opening Cursor !',sqlca.sqlerrtext)
	return 1
 elseif sqlca.sqlcode = 0 then
   fetch c1 into :ls_rec_ty, :ls_sidate, :ls_sicn, :ls_sicndt, :ls_type, :ls_destination, :ls_tranid, :ls_wareid, :ls_custid, :ls_advid, :ls_sidesc, :ld_insval, :ls_brokid, :ld_exciseduty, :ld_sicess, :ld_sieducess, :ls_CEXCISENO, :ls_siid, :ld_hecess, :ls_gsn, :ls_unitid,:ls_waybill,:ls_ISS_LOCN, :ls_REC_LOCN, :ls_PONO, :ls_PODT, :ls_DCNO, :ls_DCDT, :ls_PROMPTDT, :ls_SUPPLY_DT, :ls_SUPPLY_PLACE, :ls_TAXINVNO, :ls_DELVCHNO, :ls_SHIP_TO_ADD, :ls_REV_CHRG, :ld_tcs_per, :ld_tcs_amt,:ls_transp_name,:ls_sale_for;
	
	if sqlca.sqlcode = 100 then
		messagebox('Message','No pending sale invoices')
		close c1;
		return 1
	end if

	do while sqlca.sqlcode <> 100
		
		
		if isnull(ls_rec_ty) then; ls_rec_ty=""; end if;
		if isnull(ls_sidate) then; ls_sidate=""; end if;
		if isnull(ls_sicn) then; ls_sicn=""; end if;		
   		if isnull(ls_sicndt) then; ls_sicndt=""; end if;
   		if isnull(ls_type) then; ls_type=""; end if;
		if isnull(ls_destination) then; ls_destination=""; end if;
		if isnull(ls_tranid) then; ls_tranid=""; end if;
		if isnull(ls_wareid) then; ls_wareid=""; end if;
   		if isnull(ls_custid) then; ls_custid=""; end if;
		if isnull(ls_advid) then; ls_advid=""; end if;
		if isnull(ls_sidesc) then; ls_sidesc=""; end if;
		if isnull(ld_insval) then; ld_insval = 0; end if;
		if isnull(ls_brokid) then; ls_brokid=""; end if;											                                                          																																									                                     
		if isnull(ld_exciseduty) then; ld_exciseduty = 0; end if;
		if isnull(ld_sicess) then; ld_sicess = 0; end if;
		if isnull(ld_sieducess) then; ld_sieducess = 0; end if;
		if isnull(ls_CEXCISENO) then; ls_CEXCISENO = ""; end if;
		if isnull(ls_siid) then; ls_siid=""; end if;
		if isnull(ls_gsn) then; ls_gsn=""; end if;
		if isnull(ls_unitid) then; ls_unitid=""; end if;
		if isnull(ls_waybill) then; ls_waybill = ""; end if;
		if isnull(ls_transp_name) then; ls_transp_name = ""; end if;
		if isnull(ls_sale_for) then; ls_sale_for = ""; end if;	
		
		if isnull(ls_ISS_LOCN) then; ls_ISS_LOCN = ""; end if;
		if isnull(ls_REC_LOCN) then; ls_REC_LOCN = ""; end if;
		if isnull(ls_PONO) then; ls_PONO = ""; end if;
		if isnull(ls_PODT) then; ls_PODT = ""; end if;
		if isnull(ls_DCNO) then; ls_DCNO = ""; end if;
		if isnull(ls_DCDT) then; ls_DCDT = ""; end if;
		if isnull(ls_PROMPTDT) then; ls_PROMPTDT = ""; end if;
		if isnull(ls_SUPPLY_DT) then; ls_SUPPLY_DT = ""; end if;
		if isnull(ls_SUPPLY_PLACE) then; ls_SUPPLY_PLACE = ""; end if;
		if isnull(ls_TAXINVNO) then; ls_TAXINVNO = ""; end if;
		if isnull(ls_DELVCHNO) then; ls_DELVCHNO = ""; end if;
		if isnull(ls_SHIP_TO_ADD) then; ls_SHIP_TO_ADD = ""; end if;
		if isnull(ls_REV_CHRG) then; ls_REV_CHRG = ""; end if;
		if isnull(ld_tcs_per) then; ld_tcs_per = 0; end if;
		if isnull(ld_tcs_amt) then; ld_tcs_amt = 0; end if;
		
		if pos(ls_sidesc,"'") > 0 then; ls_sidesc = replace(ls_sidesc,pos(ls_sidesc,"'"),1,"`"); end if;
		
		if pos(ls_sidesc,",") > 0 then
			do while pos(ls_sidesc,",") > 0
				 ls_sidesc = replace(ls_sidesc,pos(ls_sidesc,","),1," "); 
			loop
		end if;
		
		if pos(ls_destination,"'") > 0 then; ls_destination = replace(ls_destination,pos(ls_destination,"'"),1,"`"); end if;
		
		if pos(ls_destination,",") > 0 then
			do while pos(ls_destination,",") > 0
				 ls_destination = replace(ls_destination,pos(ls_destination,","),1," "); 
			loop
		end if;
		
		if pos(ls_PONO,"'") > 0 then; ls_PONO = replace(ls_PONO,pos(ls_PONO,"'"),1,"`"); end if;		
		
		if pos(ls_PONO,",") > 0 then
			do while pos(ls_PONO,",") > 0
				 ls_PONO = replace(ls_PONO,pos(ls_PONO,","),1," "); 
			loop
		end if;	
		
		if pos(ls_DCNO,"'") > 0 then; ls_DCNO = replace(ls_DCNO,pos(ls_DCNO,"'"),1,"`"); end if;		
		
		if pos(ls_DCNO,",") > 0 then
			do while pos(ls_DCNO,",") > 0
				 ls_DCNO = replace(ls_DCNO,pos(ls_DCNO,","),1," "); 
			loop
		end if;
		
		if pos(ls_SUPPLY_PLACE,"'") > 0 then; ls_SUPPLY_PLACE = replace(ls_SUPPLY_PLACE,pos(ls_SUPPLY_PLACE,"'"),1,"`"); end if;		
		
		if pos(ls_SUPPLY_PLACE,",") > 0 then
			do while pos(ls_SUPPLY_PLACE,",") > 0
				 ls_SUPPLY_PLACE = replace(ls_SUPPLY_PLACE,pos(ls_SUPPLY_PLACE,","),1," "); 
			loop
		end if;		
		
	
		if pos(ls_SHIP_TO_ADD,"'") > 0 then; ls_SHIP_TO_ADD = replace(ls_SHIP_TO_ADD,pos(ls_SHIP_TO_ADD,"'"),1,"`"); end if;		
		
		if pos(ls_SHIP_TO_ADD,",") > 0 then
			do while pos(ls_SHIP_TO_ADD,",") > 0
				 ls_SHIP_TO_ADD = replace(ls_SHIP_TO_ADD,pos(ls_SHIP_TO_ADD,","),1," "); 
			loop
		end if;
		
		ls_rec = ls_rec_ty +","
		if ls_sidate="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_sidate + ","
		ls_rec = ls_rec + ls_sicn +","
		if ls_sicndt = "" then ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_sicndt + ","
		ls_rec = ls_rec + ls_type +","+ ls_tranid +","+ ls_wareid +","+ ls_custid +","
		ls_rec = ls_rec + trim(ls_advid) +","+ trim(ls_sidesc) +"," 
		ls_rec = ls_rec + string(ld_insval)+","+ls_brokid +"," + string(ld_exciseduty)+","+string(ld_sicess)+ "," + string(ld_sieducess) + "," + ls_CEXCISENO+ "," + ls_siid + "," + string(ld_hecess) + "," + ls_gsn + "," + ls_unitid + "," + ls_waybill + "," + ls_destination +"," 
		ls_rec = ls_rec + string(ls_ISS_LOCN) +","+string(ls_REC_LOCN) +"," + ls_PONO+","
		if ls_PODT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_PODT + "," 
		ls_rec = ls_rec + trim(ls_DCNO) +","
		if ls_DCDT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_DCDT + "," 
		if ls_PROMPTDT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_PROMPTDT + "," 
		if ls_SUPPLY_DT="" then  ls_rec = ls_rec + "," else	ls_rec = ls_rec+ls_SUPPLY_DT + "," 
		ls_rec = ls_rec + ls_SUPPLY_PLACE+","+ls_TAXINVNO +"," + ls_DELVCHNO+","+ls_SHIP_TO_ADD+ ","+ ls_REV_CHRG + "," + string(ld_tcs_per) + ","+ string(ld_tcs_amt) + "," + ls_transp_name+","+ls_sale_for
		
		
		filewrite(li_filenum,ls_rec)
		
		setnull(ls_rec);setnull(ls_lotno); setnull(ls_tmpid); ll_stno = 0; ll_endno = 0; ld_chestwt = 0; ld_indwt = 0; ll_season = 0;	ld_CGST_PER = 0; ld_CGST_AMT = 0; ld_SGST_PER = 0; ld_SGST_AMT = 0; ld_IGST_PER = 0; ld_IGST_AMT = 0; ld_RATE = 0;

//		select 'SL', dtp_lotno,SID_SRNOSTART, SID_SRNOEND,tmp_id,dtpd_chestwt,dtpd_indwt,sid_season,SID_CGST_PER, SID_CGST_AMT, SID_SGST_PER, SID_SGST_AMT, SID_IGST_PER, SID_IGST_AMT, SID_RATE
//		from fb_dailyteapacked a, fb_dtpdetails b, fb_saleinvoice c,fb_sidetails d
//		where a.dtp_id= b.dtp_id and c.SI_ID = d.SI_ID and c.si_cn = :ls_sicn and b.DTPD_ID = d.DTPD_ID and SID_SRNOSTART = dtpd_srnostart and 
//				SID_SRNOEND = dtpd_srnoend and SI_ROSEND_DT is null;

		DECLARE c2 CURSOR FOR
		select 'SL', dtp_lotno,SID_SRNOSTART, SID_SRNOEND,tmp_id,dtpd_chestwt,dtpd_indwt,sid_season,SID_CGST_PER, SID_CGST_AMT, SID_SGST_PER, SID_SGST_AMT, SID_IGST_PER, SID_IGST_AMT, SID_RATE, DTP_SOURCE, to_char(DTPD_MFG_FRDT,'dd/mm/yyyy'), to_char(DTPD_MFG_TODT,'dd/mm/yyyy'), to_char(dtp_date,'dd/mm/yyyy')
		from  fb_saleinvoice c,fb_sidetails d, 
				(select DTP_LOTNO,TMP_ID, DTPD_SRNOSTART, DTPD_SRNOEND, DTPD_INDWT, DTPD_CHESTWT,DTPD_ID , DTP_SOURCE, DTPD_MFG_FRDT, DTPD_MFG_TODT,dtp_date
			  from fb_dailyteapacked a,fb_dtpdetails b where a.DTP_ID = b.DTP_ID and not exists  (select *
                            from fb_dailyteapacked_new c,fb_dtpdetails_new d where c.DTP_ID = d.DTP_ID and c.dtp_id=a.dtp_id) 
union all
select DTP_LOTNO,TMP_ID, DTPD_SRNOSTART, DTPD_SRNOEND, DTPD_INDWT, DTPD_CHESTWT,DTPD_ID , DTP_SOURCE, DTPD_MFG_FRDT, DTPD_MFG_TODT,dtp_date
			  from fb_dailyteapacked_new a,fb_dtpdetails_new b where a.DTP_ID = b.DTP_ID) e
		where c.SI_ID = d.SI_ID and c.si_cn = :ls_sicn and d.DTPD_ID = e.DTPD_ID and SI_ROSEND_DT is null and c.SI_ID = :ls_siid;
		 open c2;
		
		 if sqlca.sqlcode = 0 then
			fetch c2 into :ls_rec_ty,:ls_lotno,:ll_stno,:ll_endno,:ls_tmpid,:ld_chestwt,:ld_indwt,:ll_season,:ld_CGST_PER, :ld_CGST_AMT, :ld_SGST_PER, :ld_SGST_AMT, :ld_IGST_PER, :ld_IGST_AMT, :ld_RATE, :ls_source, :ls_mfg_frdt, :ls_mfg_todt, :ls_pack_dt;
		
			do while sqlca.sqlcode <> 100
		
		//		for li_rec = 1 to 10
		//			if pos(ls_reason,"'") > 0 then; ls_reason = replace(ls_reason,pos(ls_reason,"'"),1,"`"); end if;
		//		next 
				
					if isnull(ls_rec_ty) then; ls_rec_ty=""; end if;
					if isnull(ls_lotno) then; ls_lotno=""; end if;
					if isnull(ls_tmpid) then; ls_tmpid=""; end if;		
					if isnull(ll_season) then; ll_season = 0; end if;
					if isnull(ld_CGST_PER) then; ld_CGST_per = 0; end if;
					if isnull(ld_CGST_AMT) then; ld_CGST_AMT = 0; end if;
					if isnull(ld_SGST_PER) then; ld_SGST_per = 0; end if; 
					if isnull(ld_SGST_AMT) then; ld_SGST_AMT = 0; end if;
					if isnull(ld_IGST_PER) then; ld_IGST_per = 0; end if; 
					if isnull(ld_IGST_AMT) then; ld_IGST_AMT = 0; end if;
					if isnull(ld_RATE) then; ld_RATE = 0; end if;
					if isnull(ls_source) then; ls_source=""; end if;
					if isnull(ls_mfg_frdt) then; ls_mfg_frdt=""; end if;
					if isnull(ls_mfg_todt) then; ls_mfg_todt=""; end if;
					if isnull(ls_pack_dt) then; ls_pack_dt=""; end if;
		
			//		if pos(ls_ref_ordno,"'") > 0 then; ls_ref_ordno = replace(ls_ref_ordno,pos(ls_ref_ordno,"'"),1,"`"); end if;
					
				ls_rec = ls_rec_ty +","+ ls_lotno +","
				ls_rec = ls_rec + string(ll_stno) +","+ string(ll_endno) +","+ ls_tmpid +","+ string(ld_chestwt) +","+ string(ld_indwt) +","+string(ll_season)+","+string(ld_CGST_PER)+","+string(ld_CGST_AMT)+","+string(ld_SGST_PER)+","+string(ld_SGST_AMT)+","+string(ld_IGST_PER)+","+string(ld_IGST_AMT)+","+string(ld_RATE)+","+string(ls_source)+","+ls_mfg_frdt+","+ls_mfg_todt+","+ls_pack_dt
				
				filewrite(li_filenum,ls_rec)
				//li_rec++
				
				setnull(ls_rec);setnull(ls_lotno); setnull(ls_tmpid); ll_stno = 0; ll_endno = 0; ld_chestwt = 0; ld_indwt = 0; ll_season = 0; ld_CGST_PER = 0; ld_CGST_AMT = 0; ld_SGST_PER = 0; ld_SGST_AMT = 0; ld_IGST_PER = 0; ld_IGST_AMT = 0; ld_RATE = 0; setnull(ls_source); setnull(ls_mfg_frdt); setnull(ls_mfg_todt);setnull(ls_pack_dt);
				
			fetch c2 into :ls_rec_ty,:ls_lotno,:ll_stno,:ll_endno,:ls_tmpid,:ld_chestwt,:ld_indwt,:ll_season,:ld_CGST_PER, :ld_CGST_AMT, :ld_SGST_PER, :ld_SGST_AMT, :ld_IGST_PER, :ld_IGST_AMT, :ld_RATE, :ls_source, :ls_mfg_frdt, :ls_mfg_todt, :ls_pack_dt;
			
			loop
			close c2;
		else
			messagebox('Error: During Opening of Cursor c2',sqlca.sqlerrtext)
			return -1
		end if
		
//		update fb_saleinvoice set SI_ROSEND_DT = sysdate where si_cn = :ls_sicn;
//		
//		 if sqlca.sqlcode = -1 then
//			messagebox('Error: During Update Send Date',sqlca.sqlerrtext)
//			rollback using sqlca;
//			return -1
//		end if
		
		li_rec++
		li_ctr++
		
		setnull(ls_rec_ty);setnull(ls_sidate);setnull(ls_sicn);setnull(ls_sicndt);setnull(ls_type);setnull(ls_destination);setnull(ls_tranid);setnull(ls_wareid);setnull(ls_custid);
		setnull(ls_advid);setnull(ls_sidesc);setnull(ls_brokid);setnull(ls_siid);setnull(ls_CEXCISENO);setnull(ls_transp_name);setnull(ls_sale_for);
		ld_insval = 0; ld_exciseduty = 0; ld_sicess = 0; ld_sieducess = 0; ld_hecess=0; setnull(ls_gsn); setnull(ls_unitid);setnull(ls_waybill); ld_tcs_per = 0; ld_tcs_amt = 0;
		setnull(ls_ISS_LOCN); setnull(ls_REC_LOCN); setnull(ls_PONO); setnull(ls_PODT); setnull(ls_DCNO); setnull(ls_DCDT); setnull(ls_PROMPTDT); setnull(ls_SUPPLY_DT); 
		setnull(ls_SUPPLY_PLACE);setnull(ls_TAXINVNO); setnull(ls_DELVCHNO); setnull(ls_SHIP_TO_ADD); setnull(ls_REV_CHRG);
	
   fetch c1 into :ls_rec_ty,:ls_sidate, :ls_sicn, :ls_sicndt, :ls_type, :ls_destination, :ls_tranid, :ls_wareid, :ls_custid, :ls_advid, :ls_sidesc, :ld_insval, :ls_brokid, :ld_exciseduty, :ld_sicess, :ld_sieducess, :ls_CEXCISENO, :ls_siid, :ld_hecess, :ls_gsn, :ls_unitid,:ls_waybill,:ls_ISS_LOCN, :ls_REC_LOCN, :ls_PONO, :ls_PODT, :ls_DCNO, :ls_DCDT, :ls_PROMPTDT, :ls_SUPPLY_DT, :ls_SUPPLY_PLACE, :ls_TAXINVNO, :ls_DELVCHNO, :ls_SHIP_TO_ADD, :ls_REV_CHRG,:ld_tcs_per, :ld_tcs_amt,:ls_transp_name,:ls_sale_for;
   
   loop
	close c1;
else
	messagebox('Error: During Opening of Cursor',sqlca.sqlerrtext)
	return -1
end if

	fileclose(li_filenum) 
	
integer li_temp
dw_2.settransobject(sqlca)
dw_2.retrieve()

ls_file2 = "c:\temp\"+gs_garden_snm+"_saleinvoicepdf"+string(today(),"_ddmmyy_")+string(now(),"hhmmss")+".pdf"
li_temp = dw_2.saveas(ls_file2,pdf!,true)

messagebox('Confirmation','Total No Of Records : '+string(li_ctr))


select MD_SEND_BY, MD_TO, MD_CC, MD_BCC, MD_SUBJECT, MD_DETAIL, MD_SIGNATURE into :ls_sender, :ls_recipient, :ls_cc, :ls_bcc, :ls_subject, :ls_body_text, :ls_signature from FB_MAIL_MESSAGE_DETAIL where nvl(MD_EMAIL_IND,'N') = 'Y' and MD_MESS_ID = 1 ;
if sqlca.sqlcode = -1 then
	messagebox('Error','Error occured while fetching mail parameters - '+sqlca.sqlerrtext)
	return 1
elseif sqlca.sqlcode = 100 then
	messagebox('Warning','No parameters found for mail')
	return 1
end if

if isnull(ls_sender)	then
	messagebox('Warning','Sender Email is blank')
	return 1
end if

if isnull(ls_recipient)	then
	messagebox('Warning','Sender Email is blank')
	return 1
end if

if isnull(ls_cc) then ls_cc = ""

if isnull(ls_bcc) then ls_bcc = ""

if isnull(ls_subject) then ls_subject = ""

if isnull(ls_body_text) then ls_body_text = ""

if isnull(ls_signature) then ls_signature = ""
	
//ls_sender  =  'erpsupport@luxmitea.com'


//ls_recipient = 'sanjay@luxmigroup.in; sanjay@luxmitea.com; sibendu@luxmigroup.in'
//ls_cc='sghosh@luxmigroup.in; prabhat.kumar@obeetee.com; khalid.mateen@obeetee.com; '

if(len(gs_garden_mail)<>0) then
	ls_cc += gs_garden_mail
end if
	
//ls_recipient = 'khalid.mateen@obeetee.com;'
//ls_cc = 'prabhat.kumar@obeetee.com;'

ls_addattachment = ls_file

ls_addattachment2 = ls_file2

ls_subject 	 = ls_subject + string(today(),'dd/mm/yyyy')+" "+ gs_garden_nm

ls_message	= "Dear Sir/Madam, "+gs_lfcr+gs_lfcr+ls_body_text+gs_lfcr+gs_lfcr
ls_message	 = ls_message +gs_lfcr+"Your kind attention is required."+gs_lfcr

ls_message	 = ls_message +gs_lfcr+"Administrator"+gs_lfcr

ls_message	 = ls_message +gs_lfcr+gs_lfcr+gs_garden_nm+gs_lfcr+gs_garden_add+gs_lfcr+gs_lfcr

ls_message += ls_signature

n_web_mail lnvo_mail
	
lnvo_mail = Create n_web_mail

lb_flag = lnvo_mail.of_send_webmail(ls_sender,ls_recipient,ls_cc,ls_subject,ls_message,ls_bcc,ls_addattachment,ls_addattachment2) 
//lnvo_mail.of_send_webmail_chilkat(ls_sender,ls_recipient,ls_cc,ls_subject,ls_message,ls_bcc,ls_addattachment) 

if lb_flag = True then
	update fb_saleinvoice set SI_ROSEND_DT = sysdate where SI_ROSEND_DT is null  and (SI_CN is not null and SI_CN <> '0') and SI_TYPE <> 'TRANSFREE';
	
	 if sqlca.sqlcode = -1 then
		messagebox('Error: During Update Send Date',sqlca.sqlerrtext)
		rollback using sqlca;
		return -1
	end if
	
	update FB_MAIL_MESSAGE_DETAIL set MD_SENT_DATE = sysdate  where nvl(MD_EMAIL_IND,'N') = 'Y' and MD_MESS_ID = 1 ;
	 if sqlca.sqlcode = -1 then
		messagebox('Error: During Update Send Date',sqlca.sqlerrtext)
		rollback using sqlca;
		return -1
	end if
	
	commit;
	setpointer(arrow!) 
else
	rollback;
end if
setpointer(arrow!) 
return 1


end event

type cb_1 from commandbutton within w_csvexport
integer x = 4256
integer y = 2016
integer width = 297
integer height = 96
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
string text = "&Make Csv"
end type

event clicked;//string ls_path

setpointer(hourglass!)

ChangeDirectory("c:\")
if DirectoryExists("reports") = false then
	CreateDirectory ("reports")
end if
	ChangeDirectory("reports")

if DirectoryExists("csv"+string(today(),'dd-mm-yyyy')) = false then
	CreateDirectory ("csv"+string(today(),'dd-mm-yyyy'))
end if
ChangeDirectory("csv"+string(today(),'dd-mm-yyyy'))
ls_path = getcurrentdirectory()+"\"

rb_1.triggerevent(clicked!)
rb_2.triggerevent(clicked!)
rb_3.triggerevent(clicked!)
rb_4.triggerevent(clicked!)
rb_5.triggerevent(clicked!)
rb_6.triggerevent(clicked!)
rb_7.triggerevent(clicked!)
rb_8.triggerevent(clicked!)
rb_9.triggerevent(clicked!)
rb_10.triggerevent(clicked!)
rb_11.triggerevent(clicked!)
rb_12.triggerevent(clicked!)
rb_13.triggerevent(clicked!)
rb_14.triggerevent(clicked!)
rb_15.triggerevent(clicked!)
rb_16.triggerevent(clicked!)
rb_17.triggerevent(clicked!)
rb_18.triggerevent(clicked!)
rb_19.triggerevent(clicked!)
rb_20.triggerevent(clicked!)
rb_21.triggerevent(clicked!)
rb_22.triggerevent(clicked!)
rb_23.triggerevent(clicked!)
rb_24.triggerevent(clicked!)
rb_25.triggerevent(clicked!)
rb_26.triggerevent(clicked!)
rb_27.triggerevent(clicked!)
rb_28.triggerevent(clicked!)
rb_29.triggerevent(clicked!)
rb_30.triggerevent(clicked!)
rb_31.triggerevent(clicked!)
rb_32.triggerevent(clicked!)
rb_33.triggerevent(clicked!)
rb_34.triggerevent(clicked!)
rb_35.triggerevent(clicked!)
rb_36.triggerevent(clicked!)
rb_37.triggerevent(clicked!)
rb_38.triggerevent(clicked!)
rb_39.triggerevent(clicked!)
rb_40.triggerevent(clicked!)
rb_41.triggerevent(clicked!)
rb_42.triggerevent(clicked!)
rb_43.triggerevent(clicked!)
rb_44.triggerevent(clicked!)
rb_45.triggerevent(clicked!)
rb_46.triggerevent(clicked!)
rb_47.triggerevent(clicked!)
rb_48.triggerevent(clicked!)
rb_49.triggerevent(clicked!)
rb_50.triggerevent(clicked!)
rb_51.triggerevent(clicked!)
rb_52.triggerevent(clicked!)
rb_53.triggerevent(clicked!)
rb_54.triggerevent(clicked!)
rb_55.triggerevent(clicked!)
rb_56.triggerevent(clicked!)
rb_57.triggerevent(clicked!)
rb_58.triggerevent(clicked!)
rb_59.triggerevent(clicked!)
rb_60.triggerevent(clicked!)
rb_61.triggerevent(clicked!)
rb_62.triggerevent(clicked!)
rb_63.triggerevent(clicked!)
rb_64.triggerevent(clicked!)
rb_65.triggerevent(clicked!)
rb_66.triggerevent(clicked!)
rb_67.triggerevent(clicked!)
rb_68.triggerevent(clicked!)
rb_69.triggerevent(clicked!)
rb_70.triggerevent(clicked!)
rb_71.triggerevent(clicked!)
rb_72.triggerevent(clicked!)
rb_73.triggerevent(clicked!)
rb_74.triggerevent(clicked!)
rb_75.triggerevent(clicked!)
rb_76.triggerevent(clicked!)
rb_77.triggerevent(clicked!)
rb_78.triggerevent(clicked!)
rb_79.triggerevent(clicked!)
rb_80.triggerevent(clicked!)
rb_81.triggerevent(clicked!)
rb_82.triggerevent(clicked!)
rb_83.triggerevent(clicked!)
rb_84.triggerevent(clicked!)
rb_85.triggerevent(clicked!)
rb_86.triggerevent(clicked!)
rb_87.triggerevent(clicked!)
rb_88.triggerevent(clicked!)
rb_89.triggerevent(clicked!)
rb_90.triggerevent(clicked!)
rb_91.triggerevent(clicked!)
rb_92.triggerevent(clicked!)
rb_93.triggerevent(clicked!)
rb_94.triggerevent(clicked!)
rb_95.triggerevent(clicked!)
rb_96.triggerevent(clicked!)
rb_97.triggerevent(clicked!)
rb_98.triggerevent(clicked!)
rb_99.triggerevent(clicked!)
rb_100.triggerevent(clicked!)
rb_101.triggerevent(clicked!)
rb_102.triggerevent(clicked!)
rb_103.triggerevent(clicked!)
rb_105.triggerevent(clicked!)
rb_106.triggerevent(clicked!)
rb_107.triggerevent(clicked!)
rb_108.triggerevent(clicked!)
rb_109.triggerevent(clicked!)
rb_110.triggerevent(clicked!)

//if cbx_1.checked then
//	
//  integer li_filenum
//
//	if fileexists(ls_path+"obicsv.bat") = true then
//		filedelete(ls_path+"obicsv.bat")
//	end if
//	
//	 li_filenum =  fileopen(ls_path+"obicsv.bat",linemode!,write!,lockreadwrite!,replace!)
//	 
//	 filewrite(li_filenum,"zmzip -m dobicsv"+string(today(),'ddmmyyyy')+"_d1.zip "+ls_file_p1)
//	 filewrite(li_filenum,"zmzip -m dobicsv"+string(today(),'ddmmyyyy')+"_d2.zip "+ls_file_p2)
//	 filewrite(li_filenum,"zmzip -m dobicsv"+string(today(),'ddmmyyyy')+"_d3.zip "+ls_file_p3)
//	 
//	 filewrite(li_filenum,"exit")
//	 
//	fileclose(li_filenum)
//
//	run(ls_path+"obicsv.bat")
//
//	Parent.TriggerEvent("ue_send_email")
//	
//	if fileexists(ls_path+"obicsv.bat") = true then
//		filedelete(ls_path+"obicsv.bat")
//	end if
//	setpointer(arrow!)
//	close(w_mdi)
//else
messagebox('Confirmation','Data Has been Sucessfully Exported..!')
setpointer(arrow!)
//end if
end event

type rb_103 from radiobutton within w_csvexport
integer x = 3415
integer y = 1512
integer width = 507
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Labour &Incentive "
end type

event clicked;ls_sql =  "select KAMSUB_ID, to_char(INC_FRDT,'dd/mm/yyyy hh24:mi:ss') INC_FRDT, to_char(INC_TODT,'dd/mm/yyyy hh24:mi:ss') INC_TODT, INC_AMTPERDAY, INC_PF_IND, INC_ENTRY_BY, to_char(INC_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') INC_ENTRY_DT from fb_incentive"
if wf_csv(ls_sql,'incentive') =-1 then
	return
end if
end event

type rb_102 from radiobutton within w_csvexport
integer x = 2464
integer y = 1512
integer width = 512
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Holiday Master"
end type

event clicked;ls_sql =  "select to_char(FH_DATE,'dd/mm/yyyy hh24:mi:ss') FH_DATE, FH_DESC, FH_ACTIVE_IND, FH_LWW_ID, FH_ENTRY_BY, to_char(FH_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') FH_ENTRY_DT,FH_PAID_IND, FH_EMP_TYPE, to_char(FH_PWK_DATE,'dd/mm/yyyy hh24:mi:ss'), to_char(FH_NWK_DATE,'dd/mm/yyyy hh24:mi:ss') from  fb_holiday"
if wf_csv(ls_sql,'holiday') =-1 then
	return
end if
end event

type rb_101 from radiobutton within w_csvexport
integer x = 1961
integer y = 1512
integer width = 471
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Bonus Period"
end type

event clicked;ls_sql =  "select LBS_ID, to_char(LBS_STARTDATE,'dd/mm/yyyy hh24:mi:ss') LBS_STARTDATE, to_char(LBS_ENDDATE,'dd/mm/yyyy hh24:mi:ss') LBS_ENDDATE, LBS_CONFIRM, LBS_ENTRY_BY, to_char(LBS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LBS_ENTRY_DT, LBS_EMP_TYPE from fb_labbonusseason"
if wf_csv(ls_sql,'labbonusseason') =-1 then
	return
end if
end event

type rb_100 from radiobutton within w_csvexport
integer x = 1344
integer y = 1512
integer width = 453
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&LWW Period"
end type

event clicked;ls_sql =  "select LLS_ID, to_char(LLS_STARTDATE,'dd/mm/yyyy hh24:mi:ss') LLS_STARTDATE, to_char(LLS_ENDDATE,'dd/mm/yyyy hh24:mi:ss') LLS_ENDDATE, to_char(LLS_LDATE,'dd/mm/yyyy hh24:mi:ss') LLS_LDATE, to_char(LLS_PDATE,'dd/mm/yyyy hh24:mi:ss') LLS_PDATE, LLS_CONFIRM, LLS_ENTRY_BY, to_char(LLS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LLS_ENTRY_DT, LLS_EMP_TYPE from fb_lablwwseason"
if wf_csv(ls_sql,'lablwwseason') =-1 then
	return
end if
end event

type rb_99 from radiobutton within w_csvexport
integer x = 814
integer y = 1512
integer width = 489
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ration &Period"
end type

event clicked;ls_sql =  "select rpfw_LWW_ID, to_char(RPFW_STARTDATE,'dd/mm/yyyy hh24:mi:ss') RPFW_STARTDATE, to_char(RPFW_ENDDATE,'dd/mm/yyyy hh24:mi:ss') RPFW_ENDDATE, RPFW_ID, RPFW_ENTRY_BY, to_char(RPFW_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') RPFW_ENTRY_DT, RPFW_PAIDFLAG, RPFW_CALFLAG, RPFW_RICEWT, RPFW_ATTAWT, RPFW_EMP_TYPE from  fb_rationperiodforweek"
if wf_csv(ls_sql,'rationperiodforweek') =-1 then
	return
end if
end event

type rb_98 from radiobutton within w_csvexport
integer x = 69
integer y = 1512
integer width = 741
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Food Compensation Rate"
end type

event clicked;ls_sql =  "select FC_RATE, to_char(FC_DT_FROM,'dd/mm/yyyy hh24:mi:ss') FC_DT_FROM, to_char(FC_DT_TO,'dd/mm/yyyy hh24:mi:ss') FC_DT_TO, FC_ACTIVE_IND, FC_ENTRY_BY, to_char(FC_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') FC_ENTRY_DT from fb_foodcomprate"
if wf_csv(ls_sql,'foodcomprate') =-1 then
	return
end if
end event

type rb_97 from radiobutton within w_csvexport
integer x = 3410
integer y = 1432
integer width = 635
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Cash Plucking Rate"
end type

event clicked;ls_sql =   "select KAMSUB_ID, RATE, DAILYRATE, to_char(CP_DT_FROM,'dd/mm/yyyy hh24:mi:ss') CP_DT_FROM, to_char(CP_DT_TO,'dd/mm/yyyy hh24:mi:ss') CP_DT_TO, CP_ACTIVE_IND, CP_ENTRY_BY, to_char(CP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') CP_ENTRY_DT from fb_cashpluckingrate"
if wf_csv(ls_sql,'cashpluckingrate') =-1 then
	return
end if
end event

type rb_96 from radiobutton within w_csvexport
integer x = 2944
integer y = 1428
integer width = 457
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Ration Chart"
end type

event clicked;ls_sql =  "select LRC_MAJORMINORFLAG, LRC_LABOURTYPE, LRC_RICEWT, LRC_ATTAWT, LRC_RICERATE, LRC_ATTARATE, LRC_NOWORKDAYS, FIELD_ID, LRC_MINWORKDAYS, LRC_ADULTALLOW, LRC_CHILDALLALLOW, LRC_RICEAMO, LRC_ATTAAMO, LRC_ENTRY_BY, to_char(LRC_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LRC_ENTRY_DT, LRC_ACTIVE_IND, to_char(LRC_FRDT,'dd/mm/yyyy hh24:mi:ss') LRC_FRDT, to_char(LRC_TODT,'dd/mm/yyyy hh24:mi:ss') LRC_TODT from  fb_labourrationchart"
if wf_csv(ls_sql,'labourrationchart') =-1 then
	return
end if
end event

type rb_95 from radiobutton within w_csvexport
integer x = 2423
integer y = 1428
integer width = 480
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Kamjari Task"
end type

event clicked;ls_sql =  "select TASK_ID, TASK_CHANGEPOINT, TASK_RATEUPPER, TASK_RATELOWER, TASK_UNIT, TASK_CHANGEPOINT2, TASK_RATEUPPER2, TASK_PRUNTYPE, TASK_TYPE, TASK_AVGRT_LOWER, TASK_AVGRT_UPPER, to_char(TASK_DT_FROM,'dd/mm/yyyy hh24:mi:ss') TASK_DT_FROM, to_char(TASK_DT_TO,'dd/mm/yyyy hh24:mi:ss') TASK_DT_TO, TASK_ACTIVE_IND, TASK_ENTRY_BY, to_char(TASK_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') TASK_ENTRY_DT, TASK_RATELOWER2 from fb_task"
if wf_csv(ls_sql,'task') =-1 then
	return
end if
end event

type rb_94 from radiobutton within w_csvexport
integer x = 1920
integer y = 1428
integer width = 503
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Kamjari Codes"
end type

event clicked;ls_sql =  "select KAMSUB_ID, KAMSUB_NAME, KAMSUB_DESC, KAMSUB_AFRATE, KAMSUB_CFRATE, KAMSUB_AHRATE, KAMSUB_ADHRATE, KAMSUB_CHRATE, KAMSUB_TYPE, KAMSUB_ADFRATE, KAMSUB_NKAMTYPE, KAMSUB_SECDIVPOL, KAMSUB_ACTIVE_IND, KAMSUB_ENTRY_BY, to_char(KAMSUB_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') KAMSUB_ENTRY_DT, to_char(KAMSUB_FRDT,'dd/mm/yyyy hh24:mi:ss') KAMSUB_FRDT, to_char(KAMSUB_TODT,'dd/mm/yyyy hh24:mi:ss') KAMSUB_TODT, KAMSUB_SECIND, KAMSUB_MEASIND, KAMSUB_COSTCIND from fb_kamsubhead"
if wf_csv(ls_sql,'kamsubhead') =-1 then
	return
end if
end event

type rb_93 from radiobutton within w_csvexport
integer x = 1367
integer y = 1428
integer width = 549
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Payment Period"
end type

event clicked;ls_sql =  "select to_char(LWW_STARTDATE,'dd/mm/yyyy hh24:mi:ss') LWW_STARTDATE, to_char(LWW_ENDDATE,'dd/mm/yyyy hh24:mi:ss') LWW_ENDDATE, LWW_ID, LWW_PAIDFLAG, LWW_PAYCALFLAG, LWW_ATTENDANCEFLAG, LWW_RICE, LWW_ATTA, LWW_ADVANCEFLAG, LWW_LWFFLAG, LWW_ENTRY_BY, to_char(LWW_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LWW_ENTRY_DT from fb_labourwagesweek"
if wf_csv(ls_sql,'labourwagesweek') =-1 then
	return
end if
end event

type rb_92 from radiobutton within w_csvexport
integer x = 933
integer y = 1428
integer width = 293
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Spouse"
end type

event clicked;ls_sql =  "select LABOUR_ID, SPOUSE_TYPE, SPOUSE_NAME, SPOUSE_ID, SPOUSE_ACTIVE, to_char(SPOUSE_DOB,'dd/mm/yyyy hh24:mi:ss') SPOUSE_DOB, SPOUSE_ENTRY_BY, to_char(SPOUSE_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SPOUSE_ENTRY_DT from fb_labourspouse"
if wf_csv(ls_sql,'labourspouse') =-1 then
	return
end if
end event

type rb_91 from radiobutton within w_csvexport
integer x = 398
integer y = 1428
integer width = 539
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Census Records"
end type

event clicked;ls_sql =  "select LABOUR_ID, CHILD_NAME, CHILD_DOB, CHILD_MARITAL, CHILD_SCHOOLFLAG, CHILD_GENDER, CHILD_ACTIVE, CHILD_DEPENDENTTYPE, CHILD_DOBPRE, CHILD_ENTRY_BY, to_char(CHILD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') CHILD_ENTRY_DT from  fb_labourdependent where CHILD_ROSEND_DT is null"
if wf_csv(ls_sql,'labourdependent') =-1 then
	return
end if

update fb_labourdependent set CHILD_ROSEND_DT = sysdate where  CHILD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating labourdependent Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		
	
end event

type rb_90 from radiobutton within w_csvexport
integer x = 69
integer y = 1428
integer width = 334
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Pay Book"
end type

event clicked;ls_sql =   "select LS_ID, FIELD_ID, LS_GENDER, LS_LABOURTYPE, LS_MANID, LS_DESC, LS_OUTSIDERTYPE, LS_LWFFLAG, LS_SUBSFLAG, LS_RATIONCOMFLAG, LS_HWPFLAG, LS_FORTNIGHTRATION, LS_GIVERATION, LS_ACTIVE_IND, LS_AUTOGENPFIND, LS_ENTRY_BY, to_char(LS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LS_ENTRY_DT from  fb_laboursheet"
if wf_csv(ls_sql,'laboursheet') =-1 then
	return
end if
end event

type rb_89 from radiobutton within w_csvexport
integer x = 3598
integer y = 1876
integer width = 343
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "D&eduction"
end type

event clicked;ls_sql =  "select EMP_ID, EWD_MONTH, EWD_YEAR, EWD_RATIONDED, EWD_ADVANCEDED, EWD_ELECTRICDED, EWD_LIPDED, EWD_ENTRY_BY, to_char(EWD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EWD_ENTRY_DT, EWD_PFADVDED from fb_empwisededuction where EWD_ROSEND_DT is null"
if wf_csv(ls_sql,'empwisededuction') =-1 then
	return
end if

update fb_empwisededuction set EWD_ROSEND_DT = sysdate where  EWD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating empwisededuction Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_88 from radiobutton within w_csvexport
integer x = 3310
integer y = 1876
integer width = 283
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Payroll"
end type

event clicked;ls_sql =  "select EPS_YEAR, EPS_MONTH, EPS_ADVANCECONFIRM, EPS_PAYCALFLAG, EPS_PAIDFLAG, EPS_LWFFLAG, to_char(EPS_CALDATE,'dd/mm/yyyy hh24:mi:ss') EPS_CALDATE, to_char(EPS_PAYDATE,'dd/mm/yyyy hh24:mi:ss') EPS_PAYDATE from fb_emppaymentstatus where EPS_ROSEND_DT is null"
if wf_csv(ls_sql,'emppaymentstatus') =-1 then
	return
end if

update fb_emppaymentstatus set EPS_ROSEND_DT = sysdate where  EPS_ROSEND_DT is null;
if sqlca.sqlcode = -1 then
	messagebox('Error : While updating emppaymentstatus Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
end if

ls_sql =   "select EMP_ID, EP_YEAR, EP_MONTH, EP_BASICAMOUNT, EP_DAAMOUNT, EP_VDAAMOUNT, EP_CVRFORPFAMOUNT, EP_HRAMOUNT, EP_ELECTRICAMOUNT, EP_FUELAMOUNT, EP_PENSIONFUNDDEDAMOUNT, EP_PFCONTDEDAMOUNT, EP_LIPDEDAMOUNT, EP_PTAXDEDAMOUNT, EP_REVENUESTAMPDEDAMOUNT, EP_LWFDEDAMOUNT, EP_ELECTRICDEDAMOUNT, EP_ADVANCEDEDAMOUNT, EP_RATIONDEDAMOUNT, EP_COINBF, EP_LASTCOINBF, EP_NETPAYABLE, EP_RICEWT, EP_ATTAWT, EP_STATUSTYPE, EP_STATUSDAYS, EP_ADHOC, EP_VOU_NO, to_char(EP_VOU_DT,'dd/mm/yyyy hh24:mi:ss') EP_VOU_DT from fb_emppayment where EP_ROSEND_DT is null"
if wf_csv(ls_sql,'emppayment') =-1 then
	return
end if

update fb_emppayment set EP_ROSEND_DT = sysdate where  EP_ROSEND_DT is null;
if sqlca.sqlcode = -1 then
	messagebox('Error : While updating emppayment Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_87 from radiobutton within w_csvexport
integer x = 2990
integer y = 1876
integer width = 325
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Overtime"
end type

event clicked;ls_sql =   "select OT_EMP_ID, to_char(OT_DT,'dd/mm/yyyy hh24:mi:ss') OT_DT, OT_HOURS, OT_REMARK, OT_ENTRY_BY, to_char(OT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') OT_ENTRY_DT, OT_LAB_HR_IND, OT_KAMSUB_ID, OT_RATE, OT_AMOUNT, OT_MES_IND from fb_overtime where OT_ROSEND_DT is null"
if wf_csv(ls_sql,'overtime') =-1 then
	return
end if

update fb_overtime set OT_ROSEND_DT = sysdate where  OT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating overtime Details',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	





end event

type rb_86 from radiobutton within w_csvexport
integer x = 2670
integer y = 1876
integer width = 306
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "A&dvance"
end type

event clicked;ls_sql =   "select EMP_ID, EMP_ADVANCEAMOUNT, EMP_DESC, to_char(EMP_DATE,'dd/mm/yyyy hh24:mi:ss') EMP_DATE, to_char(EMP_AMOUNTTOPAYTODATE,'dd/mm/yyyy hh24:mi:ss') EMP_AMOUNTTOPAYTODATE, TRANSAC_ID, EMP_ENTRY_BY, to_char(EMP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EMP_ENTRY_DT, EMP_INSTALLMENT, to_char(EMP_DED_DT,'dd/mm/yyyy hh24:mi:ss') EMP_DED_DT, EMP_PFADVANCE,EMP_PFINTEREST,FIELD_ID from fb_empadvance where EMP_ROSEND_DT is null"
if wf_csv(ls_sql,'empadvance') =-1 then
	return
end if

update fb_empadvance set EMP_ROSEND_DT = sysdate where  EMP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating empadvance Details',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_85 from radiobutton within w_csvexport
integer x = 2290
integer y = 1876
integer width = 370
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Attendance"
end type

event clicked;ls_sql =   "select EMP_ID, to_char(EATTEN_DATE,'dd/mm/yyyy hh24:mi:ss') EATTEN_DATE, EATTEN_STATUS, EATTEN_ENTRY_BY, to_char(EATTEN_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EATTEN_ENTRY_DT,EATTEN_HAJARI, FIELD_ID from fb_empattendance where EATTEN_ROSEND_DT is null"
if wf_csv(ls_sql,'empattendance') =-1 then
	return
end if

update fb_empattendance set EATTEN_ROSEND_DT = sysdate where  EATTEN_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating empattendance Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	






end event

type rb_84 from radiobutton within w_csvexport
integer x = 1865
integer y = 1196
integer width = 503
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Nursery Details"
end type

event clicked;ls_sql =  "select LOCATION_ID, NURSERY_ID, NURSERY_STARTDATE, NURSERY_ENDDATE, NURSERY_TYPE, NURSERY_TOTPLANTS, NURSERY_ACTIVE_IND, NURSERY_ENTRY_BY, to_char(NURSERY_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') NURSERY_ENTRY_DT from  fb_locationnursery"
if wf_csv(ls_sql,'locationnursery') =-1 then
	return
end if
end event

type rb_83 from radiobutton within w_csvexport
integer x = 1097
integer y = 1196
integer width = 759
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&New Planting/Replanting"
end type

event clicked;ls_sql =  "select SECTION_ID, SECTIONPLANT_YEAR, SECTIONPLANT_JAT, SECTIONPLANT_HEDGING, HEDGING_BUSHES, HEDGING_HEDGES, HEDGING_TREELINES, SECPLANT_ID, SECTIONPLANT_TYPE, SECTIONPLANT_STDPLANT, SECTION_ACTIVE_IND, SECTION_ENTRY_BY, to_char(SECTION_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SECTION_ENTRY_DT from  fb_sectionplantation"
if wf_csv(ls_sql,'sectionplantation') =-1 then
	return
end if
end event

type rb_82 from radiobutton within w_csvexport
integer x = 571
integer y = 1196
integer width = 512
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Section Details"
end type

event clicked;ls_sql =  "select SECTION_ID, FIELD_ID, SECTION_NAME, SECTION_DESC, SECTION_AREA, SECTION_DRAINLENGTH, SECTION_SHADETREES, SECTION_HEDGING, SECTION_FORMULAPLANTS, SECTION_MANID, SECTION_PLANTSTATUS, SECTION_ACTUALPLANTS, SECTION_BUSHDIST, SECTION_HEDGEDIST, SETION_TREELINEDIST, SECTION_UPROOTFLAG, SECTION_TREELINEDIST, SECTION_SHADETREESTEMP, SECTION_TYPE, SECTION_ACTIVE_IND, SECTION_ENTRY_BY, to_char(SECTION_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SECTION_ENTRY_DT from  fb_section"
if wf_csv(ls_sql,'section') =-1 then
	return
end if
end event

type rb_81 from radiobutton within w_csvexport
integer x = 73
integer y = 1196
integer width = 530
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Division Master"
end type

event clicked;ls_sql =  "select FIELD_ID, FIELD_NAME, FIELD_DESC, FIELD_MANID, FIELD_TYPE, UNIT_SHORTNAME, FIELD_ACTIVE_IND, FIELD_ENTRY_BY, to_char(FIELD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') FIELD_ENTRY_DT from  fb_field"
if wf_csv(ls_sql,'field') =-1 then
	return
end if
end event

type rb_79 from radiobutton within w_csvexport
integer x = 1376
integer y = 80
integer width = 517
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Category Master"
end type

event clicked;ls_sql =  "select TPC_ID, TPC_NAME, TPC_MANID, TPC_TYPE, TPC_RANK, TPC_ACTIVE_IND, TPC_ENTRY_BY, to_char(TPC_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') TPC_ENTRY_DT from fb_teamadeproductcategory"
if wf_csv(ls_sql,'teamadeproductcategory') =-1 then
	return
end if
end event

type rb_78 from radiobutton within w_csvexport
integer x = 923
integer y = 80
integer width = 430
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Consumption"
end type

event clicked;ls_sql =  "select CT_ID, CT_MANID, CT_UNIT,CT_STOREIND, CT_SPID, CT_ACTIVE_IND, CT_ENTRY_BY, to_char(CT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') CT_ENTRY_DT,CT_SUBLEGID from  fb_consumptiontype"
if wf_csv(ls_sql,'consumptiontype') =-1 then
	return
end if
end event

type rb_77 from radiobutton within w_csvexport
integer x = 535
integer y = 80
integer width = 384
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Machinary"
end type

event clicked;ls_sql =  "select MACHINE_ID, MACHINE_NAME, MACHINE_DESC, to_char(MACHINE_ESTABDATE,'dd/mm/yyyy hh24:mi:ss') MACHINE_ESTABDATE, MACHINE_MANID, MACHINE_TYPE, MACHINE_ACTIVE, MACHINE_LENGTH, MACHINE_BREADTH, MACHINE_HEIGHT, MACHINE_INSTALLEDLOAD, MACHINE_INSTALLEDCAPACITY, MAC_ACTIVE_IND, MAC_ENTRY_BY, to_char(MAC_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MAC_ENTRY_DT from  fb_machine"
if wf_csv(ls_sql,'machine') =-1 then
	return
end if
end event

type rb_76 from radiobutton within w_csvexport
integer x = 64
integer y = 80
integer width = 457
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Grade Master"
end type

event clicked;ls_sql =   "select TMP_ID, TMP_NAME, TPC_ID, TMP_MANID, TMP_TYPE, TMP_SUB_CATEGORY, TMP_RANK, TMP_ACTIVE_IND, TMP_ENTRY_BY, to_char(TMP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') TMP_ENTRY_DT from fb_teamadeproduct"
if wf_csv(ls_sql,'teamadeproduct') =-1 then
	return
end if
end event

type rb_75 from radiobutton within w_csvexport
integer x = 1970
integer y = 344
integer width = 530
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Parameter Master"
end type

event clicked;ls_sql =  "select PD_DOC_TYPE, PD_DESC, PD_PERIOD_FROM, PD_PERIOD_TO, PD_VALUE, PD_ENTRY_BY, to_char(PD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PD_ENTRY_DT, PD_VALUETYPE,PD_CODE  from fb_param_detail"
if wf_csv(ls_sql,'param_detail') =-1 then
	return
end if
end event

type rb_69 from radiobutton within w_csvexport
integer x = 1559
integer y = 344
integer width = 379
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Customer"
end type

event clicked;ls_sql =   "select CUS_ID, CUS_NAME, CUS_DESC, CUS_ADD, CUS_TELEPHONE, CUS_MOBILE, CUS_FAX, CUS_EMAIL, CUS_WEBSITE, CUS_TYPE, CUS_ACTIVE, CITY_ID, CUS_REGISTERED, CUS_CONTACTPERSON, CUS_CONTACTNO, CUS_LSALETAXNO, CUS_CSALETAXNO, CUS_STATEID, CUS_ZIP, CUS_ENTRY_BY, to_char(CUS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') CUS_ENTRY_DT, CUS_TINNO from  fb_customer"
if wf_csv(ls_sql,'customer') =-1 then
	return
end if
end event

type rb_68 from radiobutton within w_csvexport
integer x = 2597
integer y = 344
integer width = 265
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Advice"
end type

event clicked;ls_sql =   "select substr(ADVICE_ID,1,16), to_char(ADVICE_DATE,'dd/mm/yyyy hh24:mi:ss') ADVICE_DATE, ADVICE_DESC, ADVICE_COMPDATE, ADVICE_COMPFLAG, ADVICE_INSURANCEVALUE, ADVICE_TYPE, ADVICE_MEDIUM, ADVICE_ACTIVE, to_char(ADVICE_DEADLINEDATE,'dd/mm/yyyy hh24:mi:ss') ADVICE_DEADLINEDATE, ADVICE_ENTRY_BY, to_char(ADVICE_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') ADVICE_ENTRY_DT, CUST_ID, BROKER_ID from fb_advice where ADVICE_ROSEND_DT is null "
if wf_csv(ls_sql,'advice') =-1 then
	return
end if

ls_sql =   "select substr(b.ADVICE_ID,1,16), TMP_ID, ADVICE_ORDQUANTITY, ADVICE_UNITPRICE, ADVICE_DELIQUANTITY, b.ADVICE_COMPFLAG, b.ADVICE_EXTRADELI from fb_advice a, fb_advicedetails b where a.ADVICE_ID = b.ADVICE_ID and a.ADVICE_ROSEND_DT is null"
if wf_csv(ls_sql,'advicedetails') =-1 then
	return
end if

update fb_advice set ADVICE_ROSEND_DT = sysdate where  ADVICE_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating advice Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	






end event

type rb_67 from radiobutton within w_csvexport
integer x = 2921
integer y = 344
integer width = 265
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Invoice"
end type

event clicked;ls_sql =   "select SI_ID, TRANSP_ID, SI_CN, SI_AMOCHARGED, SI_EXCISEDUTY, SI_CESS, to_char(SI_DATE,'dd/mm/yyyy hh24:mi:ss') SI_DATE, SI_INSURANCEVALUE, SI_DESC, SI_ACTIVE, SI_CONFIRMFLAG, SI_TYPE, SI_EDUCATIONALCESS, SI_CENTRALEXCISENO, SI_HSECESS, to_char(SI_CNDATE,'dd/mm/yyyy hh24:mi:ss') SI_CNDATE, SI_ENTRY_BY, to_char(SI_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SI_ENTRY_DT, ADVICE_ID, to_char(SI_PRINT_DT,'dd/mm/yyyy hh24:mi:ss') SI_PRINT_DT, BROK_ID, WARE_ID, COMM_ID, CUS_ID, to_char(SI_ISSUE_DT,'dd/mm/yyyy hh24:mi:ss') SI_ISSUE_DT, SI_WAYBILLNO from fb_saleinvoice where SI_ROSEND_DT is null"
if wf_csv(ls_sql,'saleinvoice') =-1 then
	return
end if

ls_sql =   "select b.SI_ID, DTPD_ID, SID_SRNOSTART, SID_SRNOEND,sid_season from fb_saleinvoice a, fb_sidetails b where a.SI_ID = b.SI_ID and a.SI_ROSEND_DT is null"
if wf_csv(ls_sql,'sidetails') =-1 then
	return
end if

update fb_saleinvoice set SI_ROSEND_DT = sysdate where  SI_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating saleinvoice Details',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_42 from radiobutton within w_csvexport
integer x = 3241
integer y = 344
integer width = 366
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Tax Invoice"
end type

event clicked;ls_sql =   "select TI_ID, TI_INVNO, to_char(TI_INVDT,'dd/mm/yyyy hh24:mi:ss') TI_INVDT, TI_SUPID, TI_CUSTID, TI_TERM, TI_ENTRY_BY, to_char(TI_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') TI_ENTRY_DT from fb_taxinvhdr where TI_ROSEND_DT is null"
if wf_csv(ls_sql,'taxinvhdr') =-1 then
	return
end if

ls_sql =   "select b.TD_ID, TI_ITEMCD, TI_QNTY, TI_UNITPRICE, TI_SALEPRICE, TI_TAXRATE, TI_VATPAYABLE, TI_PACKINVNO from fb_taxinvhdr a, fb_taxinvdet b where a.TI_ID = b.TD_ID and a.TI_ROSEND_DT is null"
if wf_csv(ls_sql,'sidetails') =-1 then
	return
end if

update fb_taxinvhdr set TI_ROSEND_DT = sysdate where  TI_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating saleinvoice Details',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	





end event

type rb_40 from radiobutton within w_csvexport
integer x = 3721
integer y = 344
integer width = 498
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Sample Disptch"
end type

event clicked;ls_sql =  "select to_char(SD_DATE,'dd/mm/yyyy hh24:mi:ss') SD_DATE, SD_TYPE, SD_HRS, SD_FRM_HRS, TPC_ID, TMP_ID, SD_QNTY, DTP_LOTNO, SD_CUSTID, SD_ENTRY_BY, to_char(SD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SD_ENTRY_DT,SD_ADVICEID, SD_HOSENDIND from fb_sample_dispatch where SD_ROSEND_DT is null"
if wf_csv(ls_sql,'sample_dispatch') =-1 then
	return
end if

update fb_sample_dispatch set SD_ROSEND_DT = sysdate where  SD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating sample_dispatch Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_38 from radiobutton within w_csvexport
integer x = 942
integer y = 700
integer width = 407
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Productissue"
end type

event clicked;ls_sql ="select PRIS_ID, to_char(PRIS_DATE,'dd/mm/yyyy hh24:mi:ss') PRIS_DATE, PRIS_CONFIRMFLAG, PRIS_ACTIVE, PRIS_REQDATE, PRIS_VOU_NO, to_char(PRIS_VOU_DT,'dd/mm/yyyy hh24:mi:ss') PRIS_VOU_DT,PRIS_ENTRY_BY, to_char(PRIS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PRIS_ENTRY_DT, PRIS_STOCKIND,PRIS_DIVISION,PRIS_DIV_REQUID from fb_productissue a	where PRIS_ROSEND_DT is null"
if wf_csv(ls_sql,'productissue') =-1 then
	return
end if

ls_sql = "select  b.PRIS_ID, SP_ID, EACSUBHEAD_ID, PRIS_ISSUEQUANTITY, PRIS_REQQUANTITY, PRIS_VALUE, ECC_ID, SECTION_ID, AVL_STOCK  from fb_productissue a,fb_productissuedetails b where PRIS_ROSEND_DT is null"
if wf_csv(ls_sql,'productissuedetails') =-1 then
	return
end if

update fb_productissue set PRIS_ROSEND_DT = sysdate where  PRIS_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Indent Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_36 from radiobutton within w_csvexport
integer x = 549
integer y = 524
integer width = 293
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Supplier"
end type

event clicked;ls_sql ="select SUP_ID, SUP_NAME, SUP_ADD, SUP_TELEPHONE, SUP_MOBILE, SUP_EMAIL, SUP_CITY, SUP_FAX, SUP_WEBSITE, SUP_ACTIVE, SUP_DESC, SUP_TYPE, SUP_REGISTERED, SUP_CONTACTPERSON, SUP_CONTACTNO, SUP_CSALETAXNO, SUP_LSALETAXNO, ACSUBLEDGER_ID, SUP_ENTRY_BY, to_char(SUP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SUP_ENTRY_DT, SUP_MATL_TYPE from  fb_supplier"
if wf_csv(ls_sql,'supplier') =-1 then
	return
end if

end event

type rb_34 from radiobutton within w_csvexport
integer x = 73
integer y = 524
integer width = 389
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Stores &Items"
end type

event clicked;ls_sql ="select SP_ID, SP_NAME, SPC_ID, SP_UNIT,  SP_TYPE, SP_EFLAG, SP_ACTIVE_IND, SP_DISP_IND, SP_TBOARD_CODE, SP_SIZE,SP_TAREWT, SP_PUR_UNIT, SP_MINORDER_LEVEL, SP_MAXORDER_LEVEL, SP_REORDER_LEVEL, SP_WHEREHOUSE_RACKNO, SP_MISLENEOUS_IND, SP_PHYCOUNT_SCH, SP_MANID, SSP_ID,SP_ENTRY_BY, to_char(SP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SP_ENTRY_DT from  fb_storeproduct where SP_ROSEND_DT is null"
if wf_csv(ls_sql,'storeproduct') =-1 then
	return
end if

update fb_storeproduct set SP_ROSEND_DT = sysdate where  SP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating storeproduct',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_32 from radiobutton within w_csvexport
integer x = 1097
integer y = 868
integer width = 613
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "E&xpense Sub-Heads"
end type

event clicked;ls_sql ="select EACSUBHEAD_ID, EACSUBHEAD_NAME, EACSUBHEAD_DESC, EACHEAD_ID, EACSUBHEAD_MANID, EACSUBHEAD_KAMFLAG, EACSUBHEAD_SALARY_IND, EACSUBHEAD_WAGES_IND, EACSUBHEAD_STORE_IND, EACSUBHEAD_CASH_IND, EACSUBHEAD_ENTRY_BY, to_char(EACSUBHEAD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_expenseacsubhead"
if wf_csv(ls_sql,'expenseacsubhead') =-1 then
	return
end if

end event

type rb_31 from radiobutton within w_csvexport
integer x = 544
integer y = 868
integer width = 389
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Sub-Ledger"
end type

event clicked;ls_sql ="select ACSUBLEDGER_ID, ACSUBLEDGER_MANID, ACSUBLEDGER_NAME, ACSUBLEDGER_DESC, ACLEDGER_ID, ACSUBLEDGER_ACSUBLEDGERTYPE, ACSUBLEDGER_ACTIVE_IND, ACSUBLEDGER_ENTRY_BY, to_char(ACSUBLEDGER_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') ACSUBLEDGER_ENTRY_DT, EXP_HEAD_IND, ACSUBLEDGER_DIVISIONTYPE, ACSUBLEDGER_ADDINTOTAL, ACSUBLEDGER_ADDINCOSTPERKG, ACSUBLEDGER_COSTFOR, ACSUBLEDGER_COSTNATURE from fb_acsubledger where ACSUBLEDGER_ROSEND_DT is null"
if wf_csv(ls_sql,'acsubledger') =-1 then
	return
end if

update fb_acsubledger set ACSUBLEDGER_ROSEND_DT = sysdate where  ACSUBLEDGER_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating acsubledger',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_30 from radiobutton within w_csvexport
integer x = 69
integer y = 868
integer width = 247
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Ledger "
end type

event clicked;ls_sql ="select ACLEDGER_ID, ACLEDGER_MANID, ACLEDGER_NAME, ACLEDGER_DESC, ACLEDGER_TYPE, ACLEDGER_ACTYPE, ACLEDGER_LEDGERTYPE, ACLEDGER_ACTIVE_IND, ACLEDGER_ENTRY_BY, to_char(ACLEDGER_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') ACLEDGER_ENTRY_DT, ACLEDGER_CUMLATIVE_IND, ACLEDGER_DCIND from fb_acledger"
if wf_csv(ls_sql,'acledger') =-1 then
	return
end if


end event

type rb_21 from radiobutton within w_csvexport
integer x = 2825
integer y = 1032
integer width = 713
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Monthly Teamade Budget"
end type

event clicked;ls_sql ="select MTMB_YEAR, MTMB_JANTEAMADEOWN, MTMB_FEBTEAMADEOWN, MTMB_MARTEAMADEOWN, MTMB_APRTEAMADEOWN, MTMB_MAYTEAMADEOWN,MTMB_JUNTEAMADEOWN, MTMB_JULTEAMADEOWN, MTMB_AUGTEAMADEOWN, MTMB_SEPTEAMADEOWN, MTMB_OCTTEAMADEOWN,MTMB_NOVTEAMADEOWN, MTMB_DECTEAMADEOWN, MTMB_JANTEAMADEPUR, MTMB_FEBTEAMADEPUR, MTMB_MARTEAMADEPUR,MTMB_APRTEAMADEPUR, MTMB_MAYTEAMADEPUR, MTMB_JUNTEAMADEPUR, MTMB_JULTEAMADEPUR, MTMB_AUGTEAMADEPUR,MTMB_SEPTEAMADEPUR, MTMB_OCTTEAMADEPUR, MTMB_NOVTEAMADEPUR, MTMB_DECTEAMADEPUR, MTMB_ENTRY_BY,to_char(MTMB_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MTMB_ENTRY_DT, MTMB_JANTMOWN_OF, MTMB_FEBTMOWN_OF, MTMB_MARTMOWN_OF, MTMB_APRTMOWN_OF, MTMB_MAYTMOWN_OF,MTMB_JUNTMOWN_OF, MTMB_JULTMOWN_OF, MTMB_AUGTMOWN_OF, MTMB_SEPTMOWN_OF, MTMB_OCTTMOWN_OF,MTMB_NOVTMOWN_OF, MTMB_DECTMOWN_OF, MTMB_JANTMOF_OWN, MTMB_FEBTMOF_OWN, MTMB_MARTMOF_OWN,MTMB_APRTMOF_OWN, MTMB_MAYTMOF_OWN, MTMB_JUNTMOF_OWN, MTMB_JULTMOF_OWN, MTMB_AUGTMOF_OWN,MTMB_SEPTMOF_OWN, MTMB_OCTTMOF_OWN, MTMB_NOVTMOF_OWN, MTMB_DECTMOF_OWN from FB_MONTHLYTEAMADEBUDGET where MTMB_ROSEND_DT is null"
if wf_csv(ls_sql,'Monthlyteamadebudget') =-1 then
	return
end if

update FB_MONTHLYTEAMADEBUDGET set MTMB_ROSEND_DT = sysdate where  MTMB_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Monthlyteamadebudget Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if

ls_sql ="select MTMBD_YEAR, MTMBD_MONTH, MTMBD_ESTATE, MTMBD_TMOWN_OF, MTMBD_TMOF_OWN,MTMBD_ENTRY_BY, to_char(MTMBD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MTMBD_ENTRY_DT from FB_MONTHLYTEAMADEBUDGET_DET where MTMBD_ROSEND_DT is null"
if wf_csv(ls_sql,'Monthlyteamadebudgetdetail') =-1 then
	return
end if

update FB_MONTHLYTEAMADEBUDGET_DET set MTMBD_ROSEND_DT = sysdate where  MTMBD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Monthlyteamadebudgetdetail Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		




end event

type rb_48 from radiobutton within w_csvexport
integer x = 3557
integer y = 1032
integer width = 475
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Yearly Area"
end type

event clicked;ls_sql ="select YEAR, MT_AREA, YT_AREA, ZT_AREA, UP_AREA, YT_ENTRY_BY, to_char(YT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') YT_ENTRY_DT from FB_YEARLYAREA where YT_ROSEND_DT is null"
if wf_csv(ls_sql,'yearlyarea') =-1 then
	return
end if

update FB_YEARLYAREA set YT_ROSEND_DT = sysdate where  YT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating yearlyarea Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_53 from radiobutton within w_csvexport
integer x = 1161
integer y = 344
integer width = 375
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Warehouse"
end type

event clicked;ls_sql =  "select WARE_ID, WARE_NAME, WARE_DESC, WARE_ADD, WARE_TELEPHONE, WARE_MOBILE, WARE_EMAIL, WARE_FAX, WARE_ACTIVE, CITY_ID, WARE_ZIP, WARE_STATEID, WARE_ENTRY_BY, to_char(WARE_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') WARE_ENTRY_DT from fb_warehouse"
if wf_csv(ls_sql,'warehouse') =-1 then
	return
end if
end event

type rb_51 from radiobutton within w_csvexport
integer x = 745
integer y = 344
integer width = 407
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Transporter"
end type

event clicked;ls_sql =   "select TRANSP_ID, TRANSP_DESC, TRANSP_ADD, TRANSP_TELEPHONE, TRANSP_MOBILE, TRANSP_FAX, TRANSP_EMAIL, TRANSP_ACTIVE, CITY_ID, TRANSP_NAME,TRANSP_TINNO, TRANSP_PANNO,TRANS_TDS, TRANS_SERVICETAX, TRANS_SVTAXREGNO, TRANSP_CONPERSON, TRANSP_CONNUMBER, TRANSP_WEBSITE, TRANS_ZIP, TRANS_STATEID, TRANSP_ACTIVE_IND, TRANSP_ENTRY_BY, to_char(TRANSP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') TRANSP_ENTRY_DT from fb_transport"
if wf_csv(ls_sql,'transport') =-1 then
	return
end if
end event

type rb_52 from radiobutton within w_csvexport
integer x = 357
integer y = 344
integer width = 334
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "State/City"
end type

event clicked;ls_sql =   "select CITY_ID, CITY_NAME, CITY_ACTIVE_IND, CITY_ENTRY_BY, to_char(CITY_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') CITY_ENTRY_DT, CITY_STATE from fb_city"
if wf_csv(ls_sql,'city') =-1 then
	return
end if
end event

type rb_57 from radiobutton within w_csvexport
integer x = 69
integer y = 344
integer width = 283
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Broker"
end type

event clicked;ls_sql =   "select BROK_ID, BROK_NAME, BROK_DESC, BROK_ADD, BROK_TELEPHONE, BROK_MOBILE, BROK_ACTIVE, CITY_ID, BROK_FAX, BROK_EMAIL,BROK_TYPE, BROK_ZIP, BROK_STATEID, BROK_PANNO, BROK_ENTRY_BY, to_char(BROK_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') BROK_ENTRY_DT from fb_broker"
if wf_csv(ls_sql,'broker') =-1 then
	return
end if




end event

type rb_29 from radiobutton within w_csvexport
integer x = 3067
integer y = 1196
integer width = 498
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Section Planting"
end type

event clicked;ls_sql =   "select SECTION_ID, SPD_PLANTAREA, SPD_PLANTS, SPD_FORMULAPLANTS, to_char(SPD_DATE,'dd/mm/yyyy hh24:mi:ss') SPD_DATE, SPD_NOLABOURS, SECPLANT_ID, SPD_ENTRY_BY, to_char(SPD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SPD_ENTRY_DT, SPD_NEW_RE_PLANT from fb_sectionplantationdetails where SPD_ROSEND_DT is null"
if wf_csv(ls_sql,'sectionplantationdetails') =-1 then
	return
end if

update fb_sectionplantationdetails set SPD_ROSEND_DT = sysdate where  SPD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating sectionplantationdetails Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_28 from radiobutton within w_csvexport
integer x = 2409
integer y = 1196
integer width = 581
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Counting &&Infilling"
end type

event clicked;ls_sql =  "select SECTION_ID, SECPLANT_NOPLANT, to_char(SECPLANT_DATE,'dd/mm/yyyy hh24:mi:ss') SECPLANT_DATE, SECPLANT_NOLABOURS, SECPLANT_TYPE, SECTIONPLANT_JAT, SECPLANT_ENTRY_BY, to_char(SECPLANT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SECPLANT_ENTRY_DT from fb_sectionplantcount where SECPLANT_ROSEND_DT is null"
if wf_csv(ls_sql,'sectionplantcount') =-1 then
	return
end if
update fb_sectionplantcount set SECPLANT_ROSEND_DT = sysdate where  SECPLANT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating sectionplantcount Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		
	
end event

type rb_27 from radiobutton within w_csvexport
integer x = 3625
integer y = 1196
integer width = 421
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Soil &Analysis"
end type

event clicked;ls_sql =  "select SECTION_ID, SOIL_YEAR, SOIL_MONTH, SOIL_DESC, SOIL_REMARK, SOIL_PH, SOIL_C, SOIL_K2O, SOIL_S, SOIL_TYPE, SOIL_ENTRY_BY, to_char(SOIL_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SOIL_ENTRY_DT from fb_soilanalysis where SOIL_ROSEND_DT is null"
if wf_csv(ls_sql,'soilanalysis') =-1 then
	return
end if

update fb_soilanalysis set SOIL_ROSEND_DT = sysdate where  SOIL_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating soilanalysis Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if
end event

type rb_26 from radiobutton within w_csvexport
integer x = 73
integer y = 1280
integer width = 325
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Manuring"
end type

event clicked;ls_sql =  "select SECTION_ID, to_char(MFWD_DATE,'dd/mm/yyyy hh24:mi:ss') MFWD_DATE, MFWD_NOBUSH, MFWD_NOLABOURS, MFWD_AREA, MFWD_ACTIVITYTYPE, MFWD_TYPE, MFWD_ENTRY_BY, to_char(MFWD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MFWD_ENTRY_DT from fb_manfolweeddetails where MFWD_ROSEND_DT is null"
if wf_csv(ls_sql,'manfolweeddetails') =-1 then
	return
end if

update fb_manfolweeddetails set MFWD_ROSEND_DT = sysdate where  MFWD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating manfolweeddetails Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_20 from radiobutton within w_csvexport
integer x = 613
integer y = 1280
integer width = 375
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Shade &Tree"
end type

event clicked;ls_sql =  "select SECTION_ID, SHADE_TREESINC, SHADE_TREESDEC, SHADE_JAT, to_char(SHADE_DATE,'dd/mm/yyyy hh24:mi:ss') SHADE_DATE, SHADE_NOLABOURS, SHADE_DISTX, SHADE_DISTY, SHADE_ENTRY_BY, to_char(SHADE_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SHADE_ENTRY_DT from fb_sectionshade where SHADE_ROSEND_DT is null"
if wf_csv(ls_sql,'sectionshade') =-1 then
	return
end if

update fb_sectionshade set SHADE_ROSEND_DT = sysdate where  SHADE_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating sectionshade Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_19 from radiobutton within w_csvexport
integer x = 1061
integer y = 1280
integer width = 498
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Plucking Round"
end type

event clicked;ls_sql =  "select SECTION_ID, to_char(SPR_DATE,'dd/mm/yyyy hh24:mi:ss') SPR_DATE, SPR_AREACOVERED, SPR_GL, KAMSUB_ID, SPR_MANDAYS, SPR_PLUCCKTYPE, SPR_PLKRATE,SPR_ENTRY_BY, to_char(SPR_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SPR_ENTRY_DT,SPR_VOU_NO, to_char(SPR_VOU_DT,'dd/mm/yyyy hh24:mi:ss') from fb_sectionpluckinground where SPR_ROSEND_DT is null"
if wf_csv(ls_sql,'sectionpluckinground') =-1 then
	return
end if

update fb_sectionpluckinground set SPR_ROSEND_DT = sysdate where  SPR_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating sectionpluckinground Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_16 from radiobutton within w_csvexport
integer x = 1691
integer y = 1280
integer width = 334
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Uprooting"
end type

event clicked;ls_sql =  "select SECTION_ID, to_char(SU_DATE,'dd/mm/yyyy hh24:mi:ss') SU_DATE, SU_NOPLANT, SU_UPAREA, SU_ACTIVE_IND, SU_ENTRY_BY, to_char(SU_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SU_ENTRY_DT from fb_sectionuproot where SU_ROSEND_DT is null"
if wf_csv(ls_sql,'sectionuproot') =-1 then
	return
end if

update fb_sectionuproot set SU_ROSEND_DT = sysdate where  SU_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating sectionuproot Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_14 from radiobutton within w_csvexport
integer x = 2149
integer y = 1280
integer width = 439
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Plant &Infection"
end type

event clicked;ls_sql =  "select SECTION_ID, INFECT_YEAR, INFECT_MONTH, INFECT_NATURE, INFECT_MEDICINEUSED, INFECT_TYPE, INFECT_AREA, INFECT_QNTY, INFECT_UNIT, INFECT_ENTRY_BY, to_char(INFECT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') INFECT_ENTRY_DT from fb_plantinfection where INFECT_ROSEND_DT is null"
if wf_csv(ls_sql,'plantinfection') =-1 then
	return
end if

update fb_plantinfection set INFECT_ROSEND_DT = sysdate where  INFECT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating plantinfection Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_11 from radiobutton within w_csvexport
integer x = 2725
integer y = 1280
integer width = 311
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "P&running"
end type

event clicked;ls_sql =  "select SECTION_ID, PRUN_YEAR, PRUN_STYLE, PRUN_ID, PRUN_HEIGHT, PRUN_TIPPINGHEIGHT, PRUN_ENTRY_BY, to_char(PRUN_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PRUN_ENTRY_DT from fb_pruningsession where PRUN_ROSEND_DT is null"
if wf_csv(ls_sql,'pruningsession') =-1 then
	return
end if

ls_sql =  "select b.PRUN_ID, to_char(PRUN_DATE,'dd/mm/yyyy hh24:mi:ss') PRUN_DATE, PRUN_AREA, PRUN_NOLABOURS, PRUN_NOBUSH from fb_pruningsession a, fb_pruningdetails b where a.PRUN_ID = b.PRUN_ID and PRUN_ROSEND_DT is null"
if wf_csv(ls_sql,'pruningdetails') =-1 then
	return
end if

update fb_pruningsession set PRUN_ROSEND_DT = sysdate where  PRUN_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating pruningsession Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if
end event

type rb_9 from radiobutton within w_csvexport
integer x = 3154
integer y = 1280
integer width = 311
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Weather"
end type

event clicked;ls_sql =  "select to_char(WR_DATE,'dd/mm/yyyy hh24:mi:ss') WR_DATE, WR_MAXTEMP, WR_MINTEMP, WR_RAINFALL, WR_ENTRY_BY, to_char(WR_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') WR_ENTRY_DT  from fb_weatherreport where WR_ROSEND_DT is null"
if wf_csv(ls_sql,'weatherreport') =-1 then
	return
end if

update fb_weatherreport set WR_ROSEND_DT = sysdate where  WR_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating weatherreport Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_7 from radiobutton within w_csvexport
integer x = 3506
integer y = 1280
integer width = 343
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Nursery"
end type

event clicked;ls_sql =  "select NURSERY_ID, NURSERY_NOPLANTINC, NURSERY_PLANTJAT, to_char(NURSERY_DATE,'dd/mm/yyyy hh24:mi:ss') NURSERY_DATE, NURSERY_COMMENT, NURSERY_ENTRY_BY, to_char(NURSERY_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') NURSERY_ENTRY_DT, LOCATION_ID, NURSERY_TRAN_TYPE, NURSERY_TRANFER_TO, SECTION_ID,nursery_pricereplant  from fb_nurserydetails where NURSERY_ROSEND_DT is null"
if wf_csv(ls_sql,'nurserydetails') =-1 then
	return
end if

update fb_nurserydetails set NURSERY_ROSEND_DT = sysdate where  NURSERY_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating nurserydetails Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_35 from radiobutton within w_csvexport
integer x = 3241
integer y = 524
integer width = 398
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Indentcancel"
end type

event clicked;ls_sql ="select INDENT_ID, to_char(INDENT_DATE,'dd/mm/yyyy hh24:mi:ss') INDENT_DATE, SP_ID, INDDET_QNTY, INDDET_RECV_QNTY, INDDET_CANCEL_QNTY, NDDET_REMARKS,INDENT_ENTRY_BY, to_char(INDENT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') INDENT_ENTRY_DT, INDENT_CNCL_ID, to_char(INDENT_CNCL_DT,'dd/mm/yyyy hh24:mi:ss') INDENT_CNCL_DT, INDDET_TOBE_CANCEL_QNTY,CNCL_TYPE, AUTO_CNCL_IND from fb_indentcancel where INDENT_ROSEND_DT is null"
if wf_csv(ls_sql,'indentcancel') =-1 then
	return
end if

update fb_indentcancel set INDENT_ROSEND_DT = sysdate where  INDENT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating indentcancel Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_37 from radiobutton within w_csvexport
integer x = 2537
integer y = 524
integer width = 640
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Localpurchaseinvoice"
end type

event clicked;ls_sql ="select LPI_ID, to_char(LPI_DATE,'dd/mm/yyyy hh24:mi:ss') LPI_DATE, LPI_DESC, LPI_AMOCHARGED, LPI_AMODUE, LPI_FREIGHT, LPI_OTHERAMO, LPI_SALETAX, LPI_NETAMO,LPI_MODETRANSPORT, LPI_CARRIER, LPI_PAYMENTTERMS, LPI_DISCOUNT, LPI_MANID, LPI_INSURANCE, LPI_CONFIRMFLAG,LPI_ENTRY_BY, to_char(LPI_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LPI_ENTRY_DT, LPO_ID, LPI_VOU_NO, to_char(LPI_VOU_DT,'dd/mm/yyyy hh24:mi:ss') LPI_VOU_DT from  fb_localpurchaseinvoice where LPI_ROSEND_DT is null"
if wf_csv(ls_sql,'localpurchaseinvoice') =-1 then
	return
end if

ls_sql ="select  b.LPI_ID, b.SP_ID, b.LPI_QUANTITY, b.LPI_UNITPRICE, b.LPI_REMARKS, b.LPI_EFFECTIVEUNITPRICE, b.LPI_SALETAX, b.LPI_DISCOUNT from fb_localpurchaseinvoice a,fb_lpidetails b where a.LPI_ID=b.LPI_ID and LPI_ROSEND_DT is null"
if wf_csv(ls_sql,'lpidetails') =-1 then
	return
end if

update fb_localpurchaseinvoice set LPI_ROSEND_DT = sysdate where  LPI_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating localpurchaseinvoice Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_39 from radiobutton within w_csvexport
integer x = 1879
integer y = 524
integer width = 635
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Localpurchaseorder"
end type

event clicked;ls_sql ="select LPO_ID, to_char(LPO_DATE,'dd/mm/yyyy hh24:mi:ss') LPO_DATE, to_char(LPO_DEADLINEDATE,'dd/mm/yyyy hh24:mi:ss') LPO_DEADLINEDATE, to_char(LPO_COMPDATE,'dd/mm/yyyy hh24:mi:ss') LPO_COMPDATE, LPO_AMOCHARGED, INDENT_ID, LPO_QUOTNO, LPO_CARRIER,LPO_MODETRANSPORT, LPO_PAYTERMS, SUP_ID, LPO_ACTIVE, LPO_DESC, LPO_ENTRY_BY, to_char(LPO_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LPO_ENTRY_DT, to_char(LPO_PRINT_DT,'dd/mm/yyyy hh24:mi:ss') LPO_PRINT_DT from fb_localpurchaseorder where  LPO_ROSEND_DT is null"
if wf_csv(ls_sql,'localpurchaseorder') =-1 then
	return
end if

ls_sql ="select b.LPO_ID, SP_ID, LPO_QUANTITY, LPO_UNITPRICE, LPO_QUANTITYRECEIVED, LPO_REMARKS,LPO_CANCELQUANTITY from fb_localpurchaseorder a,fb_lpodetails b where a.LPO_ID=b.LPO_ID and LPO_ROSEND_DT is null"
if wf_csv(ls_sql,'lpodetails') =-1 then
	return
end if

update fb_localpurchaseorder set LPO_ROSEND_DT = sysdate where  LPO_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating localpurchaseorder Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_41 from radiobutton within w_csvexport
integer x = 1262
integer y = 524
integer width = 603
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Hopurchaseinvoice"
end type

event clicked;ls_sql ="select HOPI_ID, to_char(HOPI_DATE,'dd/mm/yyyy hh24:mi:ss') HOPI_DATE, HOPI_DESC, SUP_ID, HOPI_AMOCHARGED, HOPI_AMODUE, HOPI_MANID, HOPI_FREIGHT, HOPI_INSURANCE, HOPI_OTHERAMO,HOPI_SALETAX, HOPI_NETAMO, HOPI_CONFIRMFLAG, INDENT_ID, HOPI_ACTIVE, to_char(HOPI_MANDATE,'dd/mm/yyyy hh24:mi:ss') HOPI_MANDATE, HOPI_ENTRY_BY, to_char(HOPI_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') HOPI_ENTRY_DT, HOPI_VOU_NO,to_char(HOPI_VOU_DT,'dd/mm/yyyy hh24:mi:ss')HOPI_VOU_DT from fb_hopurchaseinvoice where HOPI_VOU_NO is not null and HOPI_ROSEND_DT is null"
if wf_csv(ls_sql,'hopurchaseinvoice') =-1 then
	return
end if

ls_sql = "select b.HOPI_ID, SP_ID, HOPI_QUANTITY, HOPI_UNITPRICE, HOPI_DISCOUNT, HOPI_EFFECTIVEUNITPRICE, b.HOPI_SALETAX from fb_hopurchaseinvoice a,fb_hopidetails b where a.HOPI_ID=b.HOPI_ID and a.HOPI_VOU_NO is not null and a.HOPI_ROSEND_DT is null"
if wf_csv(ls_sql,'hopidetails') =-1 then
	return
end if

update fb_hopurchaseinvoice set HOPI_ROSEND_DT = sysdate where  HOPI_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating hopurchaseinvoice Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_43 from radiobutton within w_csvexport
integer x = 910
integer y = 524
integer width = 270
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Indent"
end type

event clicked;ls_sql ="select INDENT_ID, to_char(INDENT_DATE,'dd/mm/yyyy hh24:mi:ss') INDENT_DATE, INDENT_DESC, INDENT_ACTIVE, INDENT_DELIVERYTYPE, INDENT_RCNO,to_char(INDENT_RCDATE,'dd/mm/yyyy hh24:mi:ss') INDENT_RCDATE,INDENT_HOLOCALFLAG, INDENT_ENTRY_BY, to_char(INDENT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') INDENT_ENTRY_DT from fb_indent where INDENT_ROSEND_DT is null"

if wf_csv(ls_sql,'indent') =-1 then
	return
end if

ls_sql = "select b.INDENT_ID, SP_ID, INDDET_QUANTITY, INDDET_RECEIVEDQUANTITY, INDENT_STOCKINHAND,INDENT_LASTMONTHCONS, INDENT_BUDGETQUANTITY, INDENT_RECEIVEDTODATE, INDDET_REMARKS,INDDET_REQDATE, INDDET_PURPOSE, INDDET_CANCELQUANTITY from fb_indent a,fb_indentdetails b where a.INDENT_ID=b.INDENT_ID and INDENT_ROSEND_DT is null"

if wf_csv(ls_sql,'indentdetails') =-1 then
	return
end if

update fb_indent set INDENT_ROSEND_DT = sysdate where  INDENT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Indent Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_25 from radiobutton within w_csvexport
integer x = 69
integer y = 1036
integer width = 667
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Monthly Salary Budget"
end type

event clicked;ls_sql ="select MSAB_YEAR, EACSUBHEAD_ID, MSAB_JANSALARY, MSAB_FEBSALARY, MSAB_MARSALARY, MSAB_APRSALARY, MSAB_MAYSALARY,MSAB_JUNSALARY, MSAB_JULSALARY, MSAB_AUGSALARY, MSAB_SEPSALARY, MSAB_OCTSALARY, MSAB_NOVSALARY, MSAB_DECSALARY,MSAB_ENTRY_BY, to_char(MSAB_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MSAB_ENTRY_DT from FB_MONTHLYSALARYBUDGET where MSAB_ROSEND_DT is null"
if wf_csv(ls_sql,'Monthlysalarybudget') =-1 then
	return
end if

update FB_MONTHLYSALARYBUDGET set MSAB_ROSEND_DT = sysdate where  MSAB_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Monthlysalarybudget Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_24 from radiobutton within w_csvexport
integer x = 736
integer y = 1036
integer width = 667
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Monthly Wages Budget"
end type

event clicked;ls_sql ="select MWB_YEAR, EACSUBHEAD_ID, MWB_JANRATE, MWB_FEBRATE, MWB_MARRATE, MWB_APRRATE, MWB_MAYRATE, MWB_JUNRATE,MWB_JULRATE, MWB_AUGRATE, MWB_SEPRATE, MWB_OCTRATE, MWB_NOVRATE, MWB_DECRATE, MWB_JANMANDAYS, MWB_FEBMANDAYS,MWB_MARMANDAYS, MWB_APRMANDAYS, MWB_MAYMANDAYS, MWB_JUNMANDAYS, MWB_JULMANDAYS, MWB_AUGMANDAYS,MWB_SEPMANDAYS, MWB_OCTMANDAYS, MWB_NOVMANDAYS, MWB_DECMANDAYS, MWB_PERRESTFLAG, MWB_ENTRY_BY, to_char(MWB_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MWB_ENTRY_DT from fb_monthlywagesbudget where MWB_ROSEND_DT is null"
if wf_csv(ls_sql,'Monthlywagesbudget') =-1 then
	return
end if

update fb_monthlywagesbudget set MWB_ROSEND_DT = sysdate where  MWB_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Monthlywagesbudget Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_23 from radiobutton within w_csvexport
integer x = 1445
integer y = 1036
integer width = 645
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Monthly Store Budget"
end type

event clicked;ls_sql ="select MSB_YEAR, SP_ID, MSB_PK, EACSUBHEAD_ID, MSB_JANPRICE, MSB_FEBPRICE, MSB_MARPRICE, MSB_APRPRICE,MSB_MAYPRICE, MSB_JUNPRICE, MSB_JULPRICE, MSB_AUGPRICE, MSB_SEPPRICE, MSB_OCTPRICE, MSB_NOVPRICE,MSB_DECPRICE, MSB_ENTRY_BY, to_char(MSB_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MSB_ENTRY_DT, MSB_JANUNITPRICE, MSB_FEBUNITPRICE, MSB_MARUNITPRICE,MSB_APRUNITPRICE, MSB_MAYUNITPRICE, MSB_JUNUNITPRICE, MSB_JULUNITPRICE, MSB_AUGUNITPRICE,MSB_SEPUNITPRICE, MSB_OCTUNITPRICE, MSB_NOVUNITPRICE, MSB_DECUNITPRICE, MSB_JANQUANTITY, MSB_FEBQUANTITY,MSB_MARQUANTITY, MSB_APRQUANTITY, MSB_MAYQUANTITY, MSB_JUNQUANTITY, MSB_JULQUANTITY, MSB_AUGQUANTITY,MSB_SEPQUANTITY, MSB_OCTQUANTITY, MSB_NOVQUANTITY, MSB_DECQUANTITY from FB_MONTHLYSTOREBUDGET where MSB_ROSEND_DT is null"
if wf_csv(ls_sql,'Monthlystorebudget') =-1 then
	return
end if

update FB_MONTHLYSTOREBUDGET set MSB_ROSEND_DT = sysdate where  MSB_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Monthlystorebudget Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_22 from radiobutton within w_csvexport
integer x = 2139
integer y = 1036
integer width = 672
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Monthly Others Budget"
end type

event clicked;ls_sql ="select MOB_YEAR, EACSUBHEAD_ID, MOB_JANPRICE, MOB_FEBPRICE, MOB_MARPRICE, MOB_APRPRICE, MOB_MAYPRICE,MOB_JUNPRICE, MOB_JULPRICE, MOB_AUGPRICE, MOB_SEPPRICE, MOB_OCTPRICE, MOB_NOVPRICE, MOB_DECPRICE,MOB_ENTRY_BY, to_char(MOB_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') MOB_ENTRY_DT from FB_MONTHLYOTHERSBUDGET where MOB_ROSEND_DT is null"
if wf_csv(ls_sql,'Monthlyotherbudget') =-1 then
	return
end if

update FB_MONTHLYOTHERSBUDGET set MOB_ROSEND_DT = sysdate where  MOB_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Monthlyotherbudget Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_8 from radiobutton within w_csvexport
integer x = 69
integer y = 700
integer width = 407
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Cost Centre"
end type

event clicked;ls_sql ="select CC_ID, CC_DESC, CC_TYPE, CC_ACTIVE_IND, CC_ENTRY_BY, to_char(CC_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') CC_ENTRY_DT, to_char(CC_EFFECTIVE_DATE,'dd/mm/yyyy hh24:mi:ss') CC_EFFECTIVE_DATE from fb_costcentre"
if wf_csv(ls_sql,'costcentre') =-1 then
	return
end if

end event

type rb_10 from radiobutton within w_csvexport
integer x = 1394
integer y = 700
integer width = 494
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Producttransfer"
end type

event clicked;ls_sql ="select PRIS_ID, to_char(PRIS_DATE,'dd/mm/yyyy hh24:mi:ss') PRIS_DATE, PRIS_CONFIRMFLAG, PRIS_ACTIVE, to_char(PRIS_REQDATE,'dd/mm/yyyy hh24:mi:ss') PRIS_REQDATE, SUP_ID,PRIS_ENTRY_BY, to_char(PRIS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PRIS_ENTRY_DT,PRIS_VOU_NO, to_char(PRIS_VOU_DT,'dd/mm/yyyy hh24:mi:ss') PRIS_VOU_DT, PRIS_FROM_SUP_ID, PRIS_TRANSFERTO_IND, PRIS_STOCKIND, PRIS_REC_TYPE from fb_producttransfer where PRIS_ROSEND_DT in null"
if wf_csv(ls_sql,'producttransfer') =-1 then
	return
end if

ls_sql ="select b.PRIS_ID, SP_ID, PRIS_ISSUEQUANTITY, PRIS_REQQUANTITY, PRIS_VALUE, AVL_STOCK  from fb_producttransfer a,fb_producttransferdetails b where a.PRIS_ID=b.PRIS_ID and PRIS_ROSEND_DT is null "
if wf_csv(ls_sql,'producttransferdetails') =-1 then
	return
end if

update fb_producttransfer set PRIS_ROSEND_DT = sysdate where  PRIS_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating producttransfer Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_12 from radiobutton within w_csvexport
integer x = 1957
integer y = 700
integer width = 562
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Stores Adjustment"
end type

event clicked;ls_sql ="select SA_ADJ_ID, SP_ID, to_char(SA_ADJ_DATE,'dd/mm/yyyy hh24:mi:ss') SA_ADJ_DATE, EACHEAD_ID, EACSUBHEAD_ID, SA_ENTRY_BY, to_char(SA_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SA_ENTRY_DT,SA_QUANTITY,SA_CONFIRMFLAG, SA_REMARK, SA_UNITPRICE, SA_VALUE, SA_VOU_NO, to_char(SA_VOU_DT,'dd/mm/yyyy hh24:mi:ss') SA_VOU_DT, SA_STOCKIND,SA_DIVISION,SA_AUTHORISED_BY, SA_REASON from fb_stores_adjustment where SA_ROSEND_DT is null "
if wf_csv(ls_sql,'storesadjustment') =-1 then
	return
end if

update fb_stores_adjustment set SA_ROSEND_DT = sysdate where  SA_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating storesadjustment Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_13 from radiobutton within w_csvexport
integer x = 2583
integer y = 700
integer width = 457
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Productreturn"
end type

event clicked;ls_sql ="select PRET_ID, to_char(PRET_DATE,'dd/mm/yyyy hh24:mi:ss') PRET_DATE, PRET_CONFIRMFLAG, PRET_ACTIVE, to_char(PRET_REQDATE,'dd/mm/yyyy hh24:mi:ss') PRET_REQDATE,SUP_ID, PRET_ENTRY_BY, to_char(PRET_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PRET_ENTRY_DT,PRET_VOU_NO, to_char(PRET_VOU_DT,'dd/mm/yyyy hh24:mi:ss') PRET_VOU_DT, PRET_ISSUE_ID, PRET_STOCKIND from FB_PRODUCTRETURN a where PRET_ROSEND_DT is null"
if wf_csv(ls_sql,'productreturn') =-1 then
	return
end if

ls_sql ="select b.PRET_ID, SP_ID, PRET_RETURNQUANTITY, PRET_REQQUANTITY, PRET_VALUE, EACSUBHEAD_ID, PRET_UNITPRICE from FB_PRODUCTRETURN a,FB_PRODUCTRETURNDETAILS b where a.PRET_ID=b.PRET_ID and PRET_ROSEND_DT is null"
if wf_csv(ls_sql,'productreturndetails') =-1 then
	return
end if

update FB_PRODUCTRETURN set PRET_ROSEND_DT = sysdate where  PRET_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating productreturn Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_15 from radiobutton within w_csvexport
integer x = 3090
integer y = 700
integer width = 530
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Supproductreturn"
end type

event clicked;ls_sql ="select SPR_ID, to_char(SPR_DATE,'dd/mm/yyyy hh24:mi:ss') SPR_DATE, SPR_DESC, SPR_LPI_HPI_ID, SPR_CONFIRMFLAG, SPR_ENTRY_BY, to_char(SPR_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') SPR_ENTRY_DT,SPR_TYPE, SUP_ID, SPR_VOU_NO, to_char(SPR_VOU_DT,'dd/mm/yyyy hh24:mi:ss') SPR_VOU_DT, SPR_STOCKIND,SPR_DIVISION from fb_supproductreturn where SPR_ROSEND_DT is null"
if wf_csv(ls_sql,'supproductreturn') =-1 then
	return
end if

ls_sql ="select  b.SPR_ID, SP_ID, SPR_INVQUANTITY, SPR_QUANTITY, SPR_UNITPRICE, SPR_REMARKS from fb_supproductreturn a,fb_supproductreturndetails b where a.SPR_ID=b.SPR_ID and SPR_ROSEND_DT is null "
if wf_csv(ls_sql,'supproductreturndetails') =-1 then
	return
end if

update fb_supproductreturn set SPR_ROSEND_DT = sysdate where  SPR_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating supproductreturn Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_44 from radiobutton within w_csvexport
integer x = 3703
integer y = 700
integer width = 402
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Assets Scrap"
end type

event clicked;ls_sql ="select FAS_SCRAP_ID, to_char(FAS_SCRAP_DT,'dd/mm/yyyy hh24:mi:ss') FAS_SCRAP_DT, FAS_SCRAP_TYPE, FAS_ITEM_CD, FAS_QNTY, FAS_ENTRY_BY,to_char(FAS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') FAS_ENTRY_DT, FAS_REMARK, FAS_SALE_VALUE from fb_Assets_scrap WHERE FAS_ROSEND_DT is null"
if wf_csv(ls_sql,'Assetsscrap') =-1 then
	return
end if

update fb_Assets_scrap set FAS_ROSEND_DT = sysdate where  FAS_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating Assetsscrap Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_17 from radiobutton within w_csvexport
integer x = 1879
integer y = 868
integer width = 407
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Fixed Assets"
end type

event clicked;ls_sql ="select FA_ITEM_CD, FA_ITEM_NAME, FA_ITEM_DESC, to_char(FA_CAP_DT,'dd/mm/yyyy hh24:mi:ss') FA_CAP_DT, FA_QNTY, FA_ASSETS_GROUP, FA_ITEM_ORG_COST, to_char(FA_SELL_DATE,'dd/mm/yyyy hh24:mi:ss') FA_SELL_DATE,FA_SELL_AMT, FA_SELL_IND, FA_ENTRY_BY, to_char(FA_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') FA_ENTRY_DT, FA_REMARK from FB_FIXED_ASSETS  where FA_ROSEND_DT is null"
if wf_csv(ls_sql,'FixedAssets') =-1 then
	return
end if

update FB_FIXED_ASSETS set FA_ROSEND_DT = sysdate where  FA_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating FixedAssets Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_18 from radiobutton within w_csvexport
integer x = 2519
integer y = 868
integer width = 631
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Voucher Head/Details"
end type

event clicked;ls_sql ="select VH_CO_ID, VH_UNIT_ID, VH_SECTION_ID, VH_DOC_SRL, VH_VOU_NO, to_char(VH_VOU_DATE,'dd/mm/yyyy hh24:mi:ss') VH_VOU_DATE, VH_VOU_TYPE, VH_NARR,VH_CONTRA_GL, VH_AC_YEAR, to_char(VH_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') VH_ENTRY_DT, VH_ENTRY_BY, VH_APPROVED_BY, VH_PRINT_IND,to_char(VH_APPROVED_DT,'dd/mm/yyyy hh24:mi:ss') VH_APPROVED_DT, VH_REMITNO, VH_CHEQUE_NO, VH_CONTRA_SGL, VH_CHEQUE_DT, VH_AC_PERIOD, VH_REMIT_DT, VH_CHEQUE_PAYTO, VH_LEDGER_TYPE from fb_vou_head where VH_ROSEND_DT is null"
if wf_csv(ls_sql,'vouhead') =-1 then
	return
end if

ls_sql ="select VD_DOC_SRL,VD_VOU_NO, VD_DETAIL, VD_GL_CD, VD_SGL_CD, VD_AMOUNT, VD_DC_IND, VD_REF_NO, VD_UNIT_ID, VD_SECTION_ID, to_char(VD_REF_DATE,'dd/mm/yyyy hh24:mi:ss') VD_REF_DATE, VD_CO_ID, VD_AC_YEAR, VD_USER_ID, to_char(VD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') VD_ENTRY_DT, VD_CHQ_NO, VD_BANK_REFNO, VD_PREFERRED_MES, VD_EXPSUBHEAD, VD_MANDAYS,  VD_PF_NO, VD_LOAN_TYPE, VD_INT_AMT, VD_INT_RATE, VD_LOAN_BAL, to_char(VD_DEDN_DATE,'dd/mm/yyyy hh24:mi:ss') VD_DEDN_DATE, VD_DEDN_EMI, VD_EMP_ID,VD_FUNCTIONS, VD_NARR_FREE_TEXT, VD_NARRATION_NO2, to_char(VD_NARR_DATE2,'dd/mm/yyyy hh24:mi:ss') VD_NARR_DATE2, VD_NARR_TXT2, VD_BUSINESS_SEGMENT, VD_PARTY_CD from fb_vou_head,fb_vou_det where VH_DOC_SRL=VD_DOC_SRL and VH_ROSEND_DT is null"

if wf_csv(ls_sql,'voudet') =-1 then
	return
end if

update fb_vou_head set VH_ROSEND_DT = sysdate where  VH_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating vouhead Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_47 from radiobutton within w_csvexport
integer x = 3392
integer y = 868
integer width = 434
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Daily Expense"
end type

event clicked;ls_sql ="select to_char(DE_DATE,'dd/mm/yyyy hh24:mi:ss') DE_DATE, EACSUBHEAD_ID, DE_SALARYTODAYTY, DE_WAGESTODAYTY, DE_STORESTODAYTY, DE_OTHERSTODAYTY, DE_SALARYTODATETY, DE_WAGESTODATETY, DE_STORESTODATETY, DE_OTHERSTODATETY,SECTION_ID from fb_dailyexpense where de_rosend_dt is null"
if wf_csv(ls_sql,'dailyexpense') =-1 then
	return
end if

update fb_dailyexpense set DE_ROSEND_DT = sysdate where  DE_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating dailyexpense Ro send date',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_74 from radiobutton within w_csvexport
integer x = 1193
integer y = 164
integer width = 567
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Pack Tea Transfer"
end type

event clicked;ls_sql =  "select to_char(PT_DATE,'dd/mm/yyyy hh24:mi:ss') PT_DATE, PT_TRANTYPE, PT_UNIT_FROM, PT_STATUS, TPC_ID, TMP_ID, PT_PRICE, PT_ENTRY_BY, to_char(PT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PT_ENTRY_DT, PT_UNIT_TO, PT_QUANTITY from fb_packteatransfer where PT_ROSEND_DT is null"
if wf_csv(ls_sql,'packteatransfer') =-1 then
	return
end if

update fb_packteatransfer set PT_ROSEND_DT = sysdate where PT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating packteatransfer Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_73 from radiobutton within w_csvexport
integer x = 1865
integer y = 164
integer width = 274
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Sorting"
end type

event clicked;ls_sql =  "select to_char(DTMP_SORTDATE,'dd/mm/yyyy hh24:mi:ss') DTMP_SORTDATE, TMP_ID, DTMP_SORTQUANTODAYTY, DTMP_ENTRY_BY, to_char(DTMP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') DTMP_ENTRY_DT from fb_dailysortedteamadeproduct where DTMP_ROSEND_DT is null"
if wf_csv(ls_sql,'dailysortedteamadeproduct') =-1 then
	return
end if

update fb_dailysortedteamadeproduct set DTMP_ROSEND_DT = sysdate where  DTMP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating dailysortedteamadeproduct Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_72 from radiobutton within w_csvexport
integer x = 2245
integer y = 164
integer width = 320
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Packing"
end type

event clicked;ls_sql =  "select DTP_ID, to_char(DTP_DATE,'dd/mm/yyyy hh24:mi:ss') DTP_DATE, DTP_LOTNO, DTP_SEASON, DTP_NO, DTP_PREFIX, DTP_ENTRY_BY, to_char(DTP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') DTP_ENTRY_DT, DTP_PACKID,DTP_DISPIND from fb_dailyteapacked where DTP_ROSEND_DT is null"
if wf_csv(ls_sql,'dailyteapacked') =-1 then
	return
end if

ls_sql =  "select b.DTP_ID, TMP_ID, DTPD_SRNOSTART, DTPD_SRNOEND, DTPD_INDWT, DTPD_CHESTWT, SP_ID, DTPD_ID,DTPD_SORTEDSTK from fb_dailyteapacked a, fb_dtpdetails b where a.DTP_ID = b.DTP_ID and a.DTP_ROSEND_DT is null"
if wf_csv(ls_sql,'dtpdetails') =-1 then
	return
end if

update fb_dailyteapacked set DTP_ROSEND_DT = sysdate where  DTP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating dailyteapacked Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_71 from radiobutton within w_csvexport
integer x = 2638
integer y = 164
integer width = 370
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Excess Tea"
end type

event clicked;ls_sql =  "select to_char(ET_STOCK_DATE,'dd/mm/yyyy hh24:mi:ss') ET_STOCK_DATE, ET_ESTATE, ET_EXCESS_TEA, ET_ENTRY_BY, to_char(ET_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') ET_ENTRY_DT, TPC_ID, GLFP_PK, ET_GL_QTY from fb_excess_tea where ET_ROSEND_DT is null"
if wf_csv(ls_sql,'excess_tea') =-1 then
	return
end if

update fb_excess_tea set ET_ROSEND_DT = sysdate where  ET_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating excess_tea Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_66 from radiobutton within w_csvexport
integer x = 69
integer y = 1680
integer width = 384
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Attendance"
end type

event clicked;ls_sql =   "select to_char(LDA_DATE,'dd/mm/yyyy hh24:mi:ss') LDA_DATE, LABOUR_ID, KAMSUB_ID, LDA_WAGES, LDA_STATUS, JOB_ID, LWW_ID, LDA_ELP, LDA_SECTIONID1, LDA_SECTIONID2, LDA_SECTIONID3, LDA_ENTRY_BY, to_char(LDA_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LDA_ENTRY_DT, LDA_MFJ_COUNT1, LDA_MFJ_COUNT2, LDA_MFJ_COUNT3, LDA_TASK, LDA_LATTA, LDA_LWWIND, LDA_NATURE, LDA_MFJ_JUNGLIFOOT, LDA_PRORATAIND, LDA_TASKIND from fb_labourdailyattendance where LDA_ROSEND_DT is null"
if wf_csv(ls_sql,'labourdailyattendance') =-1 then
	return
end if

ls_sql =   "select a.LWW_ID, LS_ID, LSA_ATTENDANCEFLAG, to_char(LSA_DATE,'dd/mm/yyyy hh24:mi:ss') LSA_DATE, LSA_ATTENDANCECONFIRM from fb_laboursheetattendance a,fb_labourdailyattendance b where a.lww_id = b.lww_id and b.LDA_ROSEND_DT is null"
if wf_csv(ls_sql,'laboursheetattendance') =-1 then
	return
end if


update fb_labourdailyattendance set LDA_ROSEND_DT = sysdate where  LDA_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating labourdailyattendance Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type rb_65 from radiobutton within w_csvexport
integer x = 462
integer y = 1680
integer width = 507
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Electric Advance"
end type

event clicked;ls_sql =  "select EA_GRPID, to_char(EA_BILLDATE,'dd/mm/yyyy hh24:mi:ss'), to_char(EA_BILLDATE_TO,'dd/mm/yyyy hh24:mi:ss'), EA_NOLABOUR, EA_BILLAMOUNT, EA_AVGAMOUNT, EA_AVGAMTPERWEEK, EA_ENTRY_BY, to_char(EA_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') from fb_electricadvance where EA_ROSEND_DT is null"
if wf_csv(ls_sql,'labouradvance') =-1 then
	return
end if
update fb_electricadvance set EA_ROSEND_DT = sysdate where  EA_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating electricadvance Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		
	
end event

type rb_64 from radiobutton within w_csvexport
integer x = 987
integer y = 1680
integer width = 617
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Electricity Deduction"
end type

event clicked;ls_sql =  "select EDG_ID, EDG_ELECTRICDED, EDG_DESC, EDG_ENTRY_BY, to_char(EDG_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EDG_ENTRY_DT from fb_electricdedgroup where EDG_ROSEND_DT is null"
if wf_csv(ls_sql,'electricdedgroup') =-1 then
	return
end if

update fb_electricdedgroup set EDG_ROSEND_DT = sysdate where  EDG_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating electricdedgroup Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if
end event

type rb_63 from radiobutton within w_csvexport
integer x = 2341
integer y = 1680
integer width = 471
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Process &Wages"
end type

event clicked;ls_sql =  "select LABOUR_ID, LWW_ID, LABOUR_WEEKSTATUS, LABOUR_HAJIRADAYS, LABOUR_MATERNITYDAYS, LABOUR_SICKDAYS, LABOUR_WAGES, LABOUR_MATERNITYEARN, LABOUR_SICKEARN, LABOUR_ELPEARN, LABOUR_OTHEREARN, LABOUR_FOODCONC, LABOUR_PF, LABOUR_FPF, LABOUR_LWF, LABOUR_ADVANCE, LABOUR_ELECTRICITY, LABOUR_RATION, LABOUR_COINBF, LABOUR_NETPAYABLEAMOUNT, LABOUR_LASTCOINBF, LABOUR_HOLIDAYPAY, LABOUR_RICEWT, LABOUR_ATTAWT, LS_ID, LABOUR_SUBSDED, LABOUR_PFADVANCEDED, LABOUR_PFINTERESTDED, LABOUR_RATIONDAYS, LABOUR_MINOR, LABOUR_MAJOR, LABOUR_VOU_NO, to_char(LABOUR_VOU_DT,'dd/mm/yyyy hh24:mi:ss') LABOUR_VOU_DT, LABOUR_ELEGRDEDAMT, LABOUR_LIP, LABOUR_RD, LABOUR_PTAX, LABOUR_REVST, LABOUR_KOIL, LABOUR_ELECTUNITS, LABOUR_WAGESADJ, LABOUR_PFADJ, LABOUR_FPFADJ,LABOUR_ATTN_INC from fb_labourweeklywages where LABOUR_ROSEND_DT is null"
if wf_csv(ls_sql,'labourweeklywages') =-1 then
	return
end if

update fb_labourweeklywages set LABOUR_ROSEND_DT = sysdate where  LABOUR_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating labourweeklywages Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_62 from radiobutton within w_csvexport
integer x = 1682
integer y = 1680
integer width = 549
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Advance Deduction"
end type

event clicked;ls_sql =  "select LABOUR_ID, ADVANCEDED, LWW_ID, PFADVANCEDED, PFINTERESTDED, ELECTRICDED, PFADVDEDCASH, PFINTDEDCASH, LAD_ENTRY_BY, to_char(LAD_DATE,'dd/mm/yyyy hh24:mi:ss') LAD_DATE from fb_labadvancededuction where LAD_ROSEND_DT is null"
if wf_csv(ls_sql,'labadvancededuction') =-1 then
	return
end if

update fb_labadvancededuction set LAD_ROSEND_DT = sysdate where  LAD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating labadvancededuction Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_61 from radiobutton within w_csvexport
integer x = 2894
integer y = 1680
integer width = 443
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Process &LWW"
end type

event clicked;ls_sql =  "select LLP_ID, LABOUR_ID, LWW_WDAYS, LWW_WAGESAMO, LWW_DAYS, LWW_EARN, LWW_FOODCONC, LWW_PF, LWW_FPF, LWW_NETAMO, LWW_DED, LWW_EDED from fb_lablww where LWW_ROSEND_DT is null"
if wf_csv(ls_sql,'lablww') =-1 then
	return
end if

update fb_lablww set LWW_ROSEND_DT = sysdate where  LWW_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating lablww Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_60 from radiobutton within w_csvexport
integer x = 3392
integer y = 1680
integer width = 453
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Process &Bonus"
end type

event clicked;ls_sql =  "select LBP_ID, LABOUR_ID, LB_WORKDAYS, LB_GREARN, LB_BONUSAMO, LB_DED, LB_PUJAAMO, LB_PAUSAMO, LB_FAGUAAMO from fb_labbonus where LB_ROSEND_DT is null"
if wf_csv(ls_sql,'labbonus') =-1 then
	return
end if

update fb_labbonus set LB_ROSEND_DT = sysdate where  LB_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating labbonus Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_59 from radiobutton within w_csvexport
integer x = 3941
integer y = 1876
integer width = 270
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Bonus"
end type

event clicked;ls_sql =  "select EBP_ID, to_char(EBP_STARTDATE,'dd/mm/yyyy hh24:mi:ss') EBP_STARTDATE, to_char(EBP_ENDDATE,'dd/mm/yyyy hh24:mi:ss') EBP_ENDDATE, EBP_PAIDFLAG, EBP_BONUSPER, LBS_ID, EBP_PUJAPER, EBP_PAUSPER, EBP_FAGUAPER, EBP_MINWDAYS, EBP_PERORNOT, EBP_ENTRY_BY, to_char(EBP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EBP_ENTRY_DT, LBS_EMP_TYPE from fb_empbonusperiod where EBP_ROSEND_DT is null"
if wf_csv(ls_sql,'empbonusperiod') =-1 then
	return
end if

update fb_empbonusperiod  set EBP_ROSEND_DT = sysdate where  EBP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating empbonusperiod Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_58 from radiobutton within w_csvexport
integer x = 1755
integer y = 1876
integer width = 526
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Employee &Spouse"
end type

event clicked;ls_sql =  "select EMP_ID, EMPS_ID, EMPS_TYPE, EMPS_NAME, EMPS_ACTIVE, to_char(EMPS_DOB,'dd/mm/yyyy hh24:mi:ss') EMPS_DOB, EMPS_ENTRY_BY, to_char(EMPS_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EMPS_ENTRY_DT from fb_empspouse"
if wf_csv(ls_sql,'empspouse') =-1 then
	return
end if
end event

type rb_50 from radiobutton within w_csvexport
integer x = 1477
integer y = 1876
integer width = 265
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&P. Tax"
end type

event clicked;ls_sql =  "select EPD_STATE_CODE, EPD_STARTSLAB, EPD_ENDSLAB, EPD_PTAX, EPD_VALIDITYFLAG, to_char(EPD_DT_FROM,'dd/mm/yyyy hh24:mi:ss') EPD_DT_FROM, to_char(EPD_DT_TO,'dd/mm/yyyy hh24:mi:ss') EPD_DT_TO, EPD_ENTRY_BY, to_char(EPD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EPD_ENTRY_DT from fb_empptaxdeduction"
if wf_csv(ls_sql,'empptaxdeduction') =-1 then
	return
end if
end event

type rb_54 from radiobutton within w_csvexport
integer x = 919
integer y = 1876
integer width = 553
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Allow. & Deductions"
end type

event clicked;ls_sql =   "select EAD_YEAR, EAD_MONTH, EAD_GRADE, to_char(EAD_ENTRYDATE,'dd/mm/yyyy hh24:mi:ss') EAD_ENTRYDATE, EAD_DA, EAD_VDA, EAD_CVRFORPF, EAD_HR, EAD_ELECTRIC, EAD_FUEL, EAD_PENSIONFUNDDED, EAD_PFCONTDED, EAD_PTAXDED, EAD_REVENUESTAMPABOVEDED, EAD_LWFDED, EAD_VALIDITYFLAG, EAD_ENTRY_BY, EAB_STBASIC, EAB_INCREMENT1, EAB_2NDBASIC, EAB_INCREMENT2, EAB_ENDBASIC from  fb_empallowancededuction"
if wf_csv(ls_sql,'empallowancededuction') =-1 then
	return
end if
end event

type rb_55 from radiobutton within w_csvexport
integer x = 393
integer y = 1876
integer width = 526
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Employee &Census"
end type

event clicked;ls_sql =   "select EMP_ID, EMPD_NAME, to_char(EMPD_DOB,'dd/mm/yyyy hh24:mi:ss') EMPD_DOB, EMPD_SEX, EMPD_ACTIVE, EMPD_SCHOOLFLAG, EMPD_MARITALSTATUS, EMPD_DEPENDENTTYPE, EMPD_ENTRY_BY, to_char(EMPD_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EMPD_ENTRY_DT from FB_EMPDEPENDENTS"
if wf_csv(ls_sql,'EMPDEPENDENTS') =-1 then
	return
end if
end event

type rb_56 from radiobutton within w_csvexport
integer x = 69
integer y = 1876
integer width = 334
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Employee"
boolean automatic = false
end type

event clicked;ls_sql =   "select EMP_ID, EMP_NAME, to_char(EMP_DOB,'dd/mm/yyyy hh24:mi:ss') EMP_DOB, EMP_DESC, EMP_TYPE, EMP_ADD, EMP_SEX, EMP_MARITAL, to_char(EMP_JDATE,'dd/mm/yyyy hh24:mi:ss') EMP_JDATE, EMP_PFNO, EMP_ACTIVE, EMP_NOMINEENAME, EMP_NOMINEERELATION, EMP_FATHERNAME, EMP_DESIG, EMP_HOUSE, EMP_ELECT, RH_ID, EMP_LIP, EMP_RATIONCARDNO, EDG_ID, EMP_PFDEDCODE, EMP_PFNAME, FIELD_ID, EMP_ADHOC, EMP_INACTIVETYPE, EMP_ENTRY_BY, to_char(EMP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') EMP_ENTRY_DT, LS_ID, EMP_GRADE, EBS_ID, ACSUBLEDGER_ID, EBS_BASICAMOUNT, to_char(EMP_JOBLEAVINGDATE,'dd/mm/yyyy hh24:mi:ss') EMP_JOBLEAVINGDATE, EMP_JOBLEAVINGREASON, EACSUBHEAD_ID, to_char(emp_promotion_dt,'dd/mm/yyyy hh24:mi:ss') emp_promotion_dt,EMP_CYCLEALLOW, EMP_FORTNIGHTADV, EMP_KEROSININD, EMP_ELECTSLNO, EMP_ALLOWWOPF, EMP_ALLOWWPF, EMP_PFNAME,EM_STATE, EM_PIN_CD,EMP_RD, EMP_ADVANCE, EMP_KOIL from  fb_employee where emp_rosend_dt is null"
if wf_csv(ls_sql,'employee') =-1 then
	return
end if

update fb_employee set EMP_ROSEND_DT = sysdate where  EMP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating employee Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	






end event

type rb_49 from radiobutton within w_csvexport
integer x = 663
integer y = 164
integer width = 366
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Production"
end type

event clicked;//ls_sql =  "SELECT GT_ID, SUP_ID, to_char(GT_DATE,'dd/mm/yyyy hh24:mi:ss') GT_DATE, GT_DESC, GT_QUANTITY, GT_UNITPRICE, GT_SALETAX, GT_OTHERAMO, GT_CONFIRMFLAG, GT_TYPE, to_char(PLUCKINGDATE,'dd/mm/yyyy hh24:mi:ss'), GT_NETAMOUNT, GT_ENTRY_BY, to_char(GT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss'), GT_REF_CHLNNO, GT_VOU_NO, to_char(GT_VOU_DT,'dd/mm/yyyy hh24:mi:ss'), GT_PROD_IND  FROM fb_gltransaction where  GT_ROSEND_DT is null"
//if wf_csv(ls_sql,'gltransaction') =-1 then
//	return
//end if
//
//update fb_gltransaction set GT_ROSEND_DT = sysdate where  GT_ROSEND_DT is null;
//
//if sqlca.sqlcode = -1 then
//	messagebox('Error : While updating gltransaction Detail',sqlca.sqlerrtext)
//	rollback using sqlca;
//	return 1
//else
//	commit using sqlca;
//end if		
//
end event

type dw_1 from datawindow within w_csvexport
integer x = 5
integer y = 2092
integer width = 3154
integer height = 336
integer taborder = 20
string title = "none"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type rb_4 from radiobutton within w_csvexport
integer x = 3113
integer y = 164
integer width = 471
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Reprocess Tea"
end type

event clicked;ls_sql =  "select RT_DRIER, to_char(RT_REPROCESS_DT,'dd/mm/yyyy hh24:mi:ss') RT_REPROCESS_DT, to_char(RT_STARTTIME,'dd/mm/yyyy hh24:mi:ss') RT_STARTTIME, to_char(RT_ENDTIME,'dd/mm/yyyy hh24:mi:ss') RT_ENDTIME, RT_FUELTYPE, RT_QUANTITY, RT_REPROCESS_TEA, RT_ENTRY_BY, to_char(RT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') RT_ENTRY_DT, TPC_ID, TMP_ID, PRIS_ID from fb_reprocess_tea where RT_ROSEND_DT is null"
if wf_csv(ls_sql,'reprocess_tea') =-1 then
	return
end if

update fb_reprocess_tea set RT_ROSEND_DT = sysdate where  RT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating reprocess_tea Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_1 from radiobutton within w_csvexport
integer x = 3063
integer y = 80
integer width = 535
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Machine Reading"
end type

event clicked;ls_sql =  "SELECT DRYER_ID, DDP_RUNHOURS,to_char(DDP_STARTRUNTIME,'dd/mm/yyyy hh24:mi:ss') DDP_STARTRUNTIME,to_char(DDP_ENDRUNTIME,'dd/mm/yyyy hh24:mi:ss') DDP_ENDRUNTIME, to_char(DDP_PLUCKINGDATE,'dd/mm/yyyy hh24:mi:ss') DDP_PLUCKINGDATE, DDP_CONFIRMFLAG, DDP_PK, DDP_TYPE, DDP_ENTRY_BY, to_char(DDP_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') DDP_ENTRY_DT,PRIS_ID  FROM fb_dailydryerproduct where  DDP_ROSEND_DT is null"
if wf_csv(ls_sql,'dailydryerproduct') =-1 then
	return
end if

ls_sql =  "Select a.DDP_PK, CT_ID, DDC_UNITCONSUMED  FROM fb_dailydryerconsumption a,fb_dailydryerproduct b where a.DDP_PK = b.DDP_PK and  b.DDP_ROSEND_DT is null"
if wf_csv(ls_sql,'dailydryerconsumption') =-1 then
	return
end if

update fb_dailydryerproduct set DDP_ROSEND_DT = sysdate where  DDP_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating dailydryerproduct Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if
end event

type rb_6 from radiobutton within w_csvexport
integer x = 64
integer y = 164
integer width = 512
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&GLTransaction"
end type

event clicked;ls_sql =  "SELECT GT_ID, SUP_ID, to_char(GT_DATE,'dd/mm/yyyy hh24:mi:ss') GT_DATE, GT_DESC, GT_QUANTITY, GT_UNITPRICE, GT_SALETAX, GT_OTHERAMO, GT_CONFIRMFLAG, GT_TYPE, to_char(PLUCKINGDATE,'dd/mm/yyyy hh24:mi:ss') PLUCKINGDATE, GT_NETAMOUNT, GT_ENTRY_BY, to_char(GT_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') GT_ENTRY_DT, GT_FINE_LEAF, GT_REF_CHLNNO, GT_VOU_NO, to_char(GT_VOU_DT,'dd/mm/yyyy hh24:mi:ss') GT_VOU_DT, GT_PROD_IND  FROM fb_gltransaction where  GT_ROSEND_DT is null"
if wf_csv(ls_sql,'gltransaction') =-1 then
	return
end if

update fb_gltransaction set GT_ROSEND_DT = sysdate where  GT_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating gltransaction Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_5 from radiobutton within w_csvexport
integer x = 3653
integer y = 80
integer width = 530
integer height = 76
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Fine Leaf Count"
end type

event clicked;ls_sql =  "SELECT to_char(LA_DATE,'dd/mm/yyyy hh24:mi:ss') LA_DATE, LA_OWLLNB1, LA_OWLLNB2, LA_OWLLNB3, LA_OWLLNB4, LA_OWLBNJ1, LA_OWLBNJ2, LA_OWLBNJ3, LA_OWLBNJ4, LA_OWLKCL1, LA_OWLPERFINLF, LA_OWLPERCOALF, LA_OWLBMCFINPER, LA_OWLBMCCOAPER, LA_ENTRY_BY, to_char(LA_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') LA_ENTRY_DT, LA_TYPE, SUP_ID,LA_COUNTIND  FROM fb_leafanalysis where  LA_ROSEND_DT is null"
if wf_csv(ls_sql,'leafanalysis') =-1 then
	return
end if

update fb_leafanalysis set LA_ROSEND_DT = sysdate where  LA_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating leafanalysis Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		

end event

type rb_3 from radiobutton within w_csvexport
integer x = 2409
integer y = 80
integer width = 640
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "Grid && GenSet &Detail"
end type

event clicked;ls_sql =  "SELECT to_char(PEGD_DATE,'dd/mm/yyyy hh24:mi:ss') PEGD_DATE, EPC_ID, PEGD_ELECT, PEGD_HSD, PEGD_GENGRIDFLAG, PEGD_CONFIRMFLAG, to_char(PEGD_TIME,'dd/mm/yyyy hh24:mi:ss') PEGD_TIME  FROM fb_pegdetails where  PEGD_ROSEND_DT is null"
if wf_csv(ls_sql,'pegdetails') =-1 then
	return
end if
update fb_pegdetails set PEGD_ROSEND_DT = sysdate where  PEGD_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating pegdetails Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if		
	
end event

type rb_2 from radiobutton within w_csvexport
integer x = 1915
integer y = 80
integer width = 489
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 33554432
long backcolor = 67108864
string text = "&Grid && GenSet"
end type

event clicked;ls_sql =   "SELECT MACHINE_ID, PEG_DATE, PEG_ELECT, PEG_HSD, PEG_RUNHOURS, PEG_GAS, PEG_CONFIRMFLAG, PEG_ENTRY_BY, to_char(PEG_ENTRY_DT,'dd/mm/yyyy hh24:mi:ss') PEG_ENTRY_DT   FROM fb_pegeneration where  PEG_ROSEND_DT is null"
if wf_csv(ls_sql,'pegeneration') =-1 then
	return
end if	
	
update fb_pegeneration set PEG_ROSEND_DT = sysdate where  PEG_ROSEND_DT is null;

if sqlca.sqlcode = -1 then
	messagebox('Error : While updating pegeneration Detail',sqlca.sqlerrtext)
	rollback using sqlca;
	return 1
else
	commit using sqlca;
end if	
end event

type gb_2 from groupbox within w_csvexport
integer x = 14
integer y = 1812
integer width = 4229
integer height = 268
integer taborder = 10
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "HR"
end type

type gb_6 from groupbox within w_csvexport
integer x = 14
integer y = 1148
integer width = 4229
integer height = 236
integer taborder = 10
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Field"
end type

type gb_1 from groupbox within w_csvexport
integer x = 14
integer y = 452
integer width = 4229
integer height = 184
integer taborder = 20
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Purchase"
end type

type gb_3 from groupbox within w_csvexport
integer x = 14
integer y = 972
integer width = 4229
integer height = 180
integer taborder = 30
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Budget"
end type

type gb_5 from groupbox within w_csvexport
integer x = 14
integer y = 812
integer width = 4229
integer height = 164
integer taborder = 40
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Accounts"
end type

type gb_4 from groupbox within w_csvexport
integer x = 14
integer y = 628
integer width = 4229
integer height = 180
integer taborder = 30
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Inventory"
end type

type gb_9 from groupbox within w_csvexport
integer x = 14
integer y = 1376
integer width = 4229
integer height = 440
integer taborder = 20
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Labour"
end type

type gb_8 from groupbox within w_csvexport
integer x = 14
integer y = 24
integer width = 4229
integer height = 256
integer taborder = 10
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Production"
end type

type gb_7 from groupbox within w_csvexport
integer x = 14
integer y = 280
integer width = 4229
integer height = 176
integer taborder = 30
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = roman!
string facename = "Times New Roman"
long textcolor = 16711680
long backcolor = 67108864
string text = "Dispatch"
end type

